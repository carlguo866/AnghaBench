
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;
 int ecx_mixedcase_ascii_decoder ;
 scalar_t__ malloc (int) ;
 int rand () ;
 int sprintf (char*,char*,int,int) ;
 int strcat (char*,char*) ;
 int strcpy (char*,int ) ;
 int strlen (char*) ;

char* alphaEncodeShellcode(char *shellcode, int size)
{
 int i, input, A, B, C, D, E, F;
 char* valid_chars="0123456789BCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";

 char *encShellcode = (char *) malloc(sizeof((ecx_mixedcase_ascii_decoder) + (size * 2)));
 strcpy(encShellcode,ecx_mixedcase_ascii_decoder);
 char buff[4];
 int z=0;
 for(;z < size;z++)
 {

  A = (shellcode[z] & 0xf0) >> 4;
  B = (shellcode[z] & 0x0f);

  F = B;

  i = rand() % strlen(valid_chars);
  while ((valid_chars[i] & 0x0f) != F) { i = ++i % strlen(valid_chars); }
  E = valid_chars[i] >> 4;


  D = 0 ? (A-E) & 0x0f : (A^E);

  i = rand() % strlen(valid_chars);
  while ((valid_chars[i] & 0x0f) != D) { i = ++i % strlen(valid_chars); }
  C = valid_chars[i] >> 4;


  sprintf(buff,"%c%c",(C<<4)+D, (E<<4)+F);
  strcat(encShellcode,buff);
 }
 return encShellcode;
}
