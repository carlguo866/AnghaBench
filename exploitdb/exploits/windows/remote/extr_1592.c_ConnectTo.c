
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






struct in_addr {int dummy; } ;
struct sockaddr_in {struct in_addr sin_addr; int sin_family; int sin_port; } ;
struct sockaddr {int dummy; } ;
struct hostent {scalar_t__ h_addr; } ;
typedef int nTimeout ;
typedef int host ;
typedef int WSADATA ;
typedef int SOCKET ;


 int AF_INET ;
 int MAKEWORD (int,int) ;
 int SOCK_STREAM ;
 int SOL_SOCKET ;
 int SO_RCVTIMEO ;
 scalar_t__ WSAStartup (int ,int *) ;
 int closesocket (int ) ;
 int connect (int ,struct sockaddr*,int) ;
 int exit (int) ;
 struct hostent* gethostbyname (char*) ;
 int htons (int) ;
 int printf (char*,...) ;
 int setsockopt (int ,int ,int ,char*,int) ;
 int socket (int ,int ,int ) ;

SOCKET ConnectTo(char *ip, int port)
{
 WSADATA wsaData;
 SOCKET s;
 struct hostent *he;
 struct sockaddr_in host;
 int nTimeout=150000;

 if(WSAStartup(MAKEWORD(1,1),&wsaData)!=0)
 {
  printf("[-]WSAStartup failed.\n");
  exit(-1);
 }

 if((he=gethostbyname(ip))==0)
 {
  printf("[-]Failed to resolve '%s'.", ip);
  exit(-1);
 }

 host.sin_port=htons(port);
 host.sin_family=AF_INET;
 host.sin_addr=*((struct in_addr *)he->h_addr);

 if ((s=socket(AF_INET,SOCK_STREAM,0))<0)
 {
  printf("[-]Failed creating socket.");
   exit(-1);
  }

 if ((connect(s,(struct sockaddr *)&host,sizeof(host)))==-1)
 {
  closesocket(s);
  printf("[-]Failed connecting to host.\n");
  exit(-1);
 }
 setsockopt(s,SOL_SOCKET,SO_RCVTIMEO,(char*)&nTimeout,sizeof(nTimeout));
 return s;
}
