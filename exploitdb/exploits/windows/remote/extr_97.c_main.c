
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






struct in_addr {int dummy; } ;


 int AF_INET ;
 int atoi (int ) ;
 int d_dcom_scan_timeout ;
 int dcom2_scan (unsigned int) ;
 int dcom_scan_timeout ;
 int getopt (int,char**,char*) ;
 unsigned int htonl (unsigned int) ;
 int inet_pton (int ,char*,struct in_addr*) ;
 int optarg ;
 int optind ;
 char* program_name ;
 int sscanf (char*,char*,int*,int*,int*,int*,int*) ;
 int usage (int) ;
 int verbose ;

int
main( int argc, char **argv ) {
    int a, b, c, d, bits;
    unsigned int mask, low, high, ip, netip;
    int rc = 0, r;

    program_name = argv[0];

    verbose = 1;
    dcom_scan_timeout = d_dcom_scan_timeout;

    while ( ( c = getopt( argc, argv, "vqt:h" ) ) >= 0 ) {
 switch ( c ) {
     case 'v':
  verbose++;
  break;
     case 'q':
  verbose = 0;
  break;
     case 't':
  dcom_scan_timeout = atoi( optarg );
  break;
     case 'h':
  usage( 0 );
  break;
     default:
  usage( -1 );
  break;
     }
 }

    if ( optind >= argc || ! argv[ optind ] )
 usage( -1 );

    rc = sscanf( argv[ optind ], "%d.%d.%d.%d/%d", &a, &b, &c, &d, &bits );
    if ( rc == 5 ) {

 if ( bits < 0 || 32 < bits )
     usage( -1 );
 rc = 0;
 mask = 0xffffffff << ( 32 - bits );
 low = ( a << 24 | b << 16 | c << 8 | d ) & mask;
 high = low | ~ mask;
 for ( ip = low + 1; ip < high; ip++ ) {
     netip = htonl( ip );
     r = dcom2_scan( netip );
     if ( r == 3 || r == 4 )
  rc = 4;
     }
 }
    else if ( rc == 4 ) {

 inet_pton( AF_INET, argv[ optind ], (struct in_addr *) &netip );
 rc = dcom2_scan( netip );
 }
    else
 usage( -1 );

    return rc;
    }
