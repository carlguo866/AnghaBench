
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;
 int atoi (char*) ;
 int backip ;
 unsigned short bindport ;
 int exit (int ) ;
 int free (char*) ;
 int inet_addr (char*) ;
 int ntarget ;
 int printf (char*,char*) ;
 char* smb_get_name (char*) ;
 int usage (char*) ;

void
vargs(int argc, char **argv)
{
 int i, finger = 0;
 char *nname = ((void*)0);

 for (i = 2; i < argc; i++) {
  if (argv[i][0] == '-') {
   if (argv[i][1] == 'f')
    finger = 1;
  }
 }

 if (finger && argc > 2) {
  nname = smb_get_name(argv[1]);
  if (nname) {
   printf("[+] Remote netbios name: %s\n",
nname);
   free(nname);
  }
  exit(0);
 } else
 if (argc < 5) usage(argv[0]);
 if ((ntarget = atoi(argv[3])) > 1) usage(argv[0]);

 bindport = (unsigned short)atoi(argv[4]);
 if (argc > 5) backip = inet_addr(argv[5]);

return;
}
