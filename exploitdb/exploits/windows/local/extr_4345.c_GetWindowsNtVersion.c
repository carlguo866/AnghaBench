
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_3__ TYPE_1__ ;


struct TYPE_3__ {int dwMajorVersion; int dwOSVersionInfoSize; int wServicePackMajor; int dwMinorVersion; } ;
typedef int * PUINT ;
typedef TYPE_1__* POSVERSIONINFOEXA ;
typedef int OSVERSIONINFOEXA ;
typedef scalar_t__ DWORD ;


 scalar_t__ OS_VERSION_2K ;
 scalar_t__ OS_VERSION_2K3 ;
 scalar_t__ OS_VERSION_NT4 ;
 scalar_t__ OS_VERSION_UNKNOWN ;
 scalar_t__ OS_VERSION_VISTA ;
 scalar_t__ OS_VERSION_XP ;

DWORD
GetWindowsNtVersion(POSVERSIONINFOEXA posvi, PUINT pServicePack)
{
  DWORD dwVersion;

  switch(posvi->dwMajorVersion)
  {
  case 6:
    dwVersion = OS_VERSION_VISTA;
    break;
  case 5:
    switch(posvi->dwMinorVersion)
    {
    case 2:
      dwVersion = OS_VERSION_2K3;
      break;
    case 1:
      dwVersion = OS_VERSION_XP;
      break;
    case 0:
      dwVersion = OS_VERSION_2K;
      break;
    default:
      dwVersion = OS_VERSION_UNKNOWN;
    }
    break;
  case 4:
  case 3:
  case 2:
  case 1:
  case 0:
    dwVersion = OS_VERSION_NT4;
    break;
  default:
    dwVersion = OS_VERSION_UNKNOWN;
  }


  if((OS_VERSION_UNKNOWN != dwVersion) && (((void*)0) != pServicePack))
  {
    if(sizeof(OSVERSIONINFOEXA) == posvi->dwOSVersionInfoSize)
    {
      (*pServicePack) = posvi->wServicePackMajor;
    }
    else
    {

    }
  }
  return dwVersion;
}
