
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_5__ TYPE_2__ ;
typedef struct TYPE_4__ TYPE_1__ ;


struct TYPE_5__ {int PrivilegeCount; TYPE_1__* Privileges; } ;
struct TYPE_4__ {void* Luid; void* Attributes; } ;
typedef int TOKEN_PRIVILEGES ;
typedef TYPE_2__* PTOKEN_PRIVILEGES ;
typedef int LUID_AND_ATTRIBUTES ;
typedef void* LUID ;


 int LPTR ;
 scalar_t__ LocalAlloc (int ,int) ;
 int LookupPrivilegeValue (int *,int ,void**) ;
 int SE_ASSIGNPRIMARYTOKEN_NAME ;
 int SE_DEBUG_NAME ;
 int SE_IMPERSONATE_NAME ;
 void* SE_PRIVILEGE_ENABLED ;
 int SE_TAKE_OWNERSHIP_NAME ;
 int SE_TCB_NAME ;

PTOKEN_PRIVILEGES SetPrivileges()
{
    PTOKEN_PRIVILEGES privileges;
    LUID luid;
    int NumOfPrivileges = 5;
    int nBufferSize;


    nBufferSize = sizeof(TOKEN_PRIVILEGES) + sizeof(LUID_AND_ATTRIBUTES) * NumOfPrivileges;
    privileges = (PTOKEN_PRIVILEGES) LocalAlloc(LPTR, nBufferSize);

    privileges->PrivilegeCount = NumOfPrivileges;

    LookupPrivilegeValue(((void*)0), SE_TCB_NAME, &luid);
    privileges->Privileges[0].Attributes = SE_PRIVILEGE_ENABLED;
    privileges->Privileges[0].Luid = luid;

    LookupPrivilegeValue(((void*)0), SE_DEBUG_NAME, &luid);
    privileges->Privileges[1].Attributes = SE_PRIVILEGE_ENABLED;
    privileges->Privileges[1].Luid = luid;

    LookupPrivilegeValue(((void*)0), SE_ASSIGNPRIMARYTOKEN_NAME, &luid);
    privileges->Privileges[2].Attributes = SE_PRIVILEGE_ENABLED;
    privileges->Privileges[2].Luid = luid;

    LookupPrivilegeValue(((void*)0), SE_TAKE_OWNERSHIP_NAME, &luid);
    privileges->Privileges[3].Attributes = SE_PRIVILEGE_ENABLED;
    privileges->Privileges[3].Luid = luid;

    LookupPrivilegeValue(((void*)0), SE_IMPERSONATE_NAME, &luid);
    privileges->Privileges[4].Attributes = SE_PRIVILEGE_ENABLED;
    privileges->Privileges[4].Luid = luid;

    return privileges;
}
