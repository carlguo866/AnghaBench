
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






typedef int ULONG ;
typedef int PVOID ;
typedef int PBYTE ;


 int MEM_COMMIT ;
 int MEM_RESERVE ;
 int PAGE_NOACCESS ;
 int PAGE_READWRITE ;
 int PAGE_SIZE ;
 int VirtualAlloc (int *,int,int,int ) ;
 int VirtualProtect (int,int,int ,int*) ;

PVOID AllocBufferOnPageBoundary(ULONG Size)
{
    ULONG GuardBufSize;
    ULONG ProtBits;
    PBYTE GuardBuf;


    GuardBufSize = (Size + (PAGE_SIZE - 1)) & ~(PAGE_SIZE - 1);


    GuardBufSize = GuardBufSize + PAGE_SIZE;


    GuardBuf = VirtualAlloc(((void*)0),
                            GuardBufSize,
                            MEM_COMMIT | MEM_RESERVE,
                            PAGE_READWRITE);


    VirtualProtect(GuardBuf + GuardBufSize - PAGE_SIZE,
                   PAGE_SIZE,
                   PAGE_NOACCESS,
                   &ProtBits);


    return GuardBuf + GuardBufSize - PAGE_SIZE - Size;
}
