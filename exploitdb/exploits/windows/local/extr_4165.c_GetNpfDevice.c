
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






typedef int HKEY ;
typedef int DWORD ;
typedef int BOOL ;


 scalar_t__ ERROR_SUCCESS ;
 int FALSE ;
 int HKEY_LOCAL_MACHINE ;
 int KEY_READ ;
 scalar_t__ RegOpenKeyExA (int ,char*,int ,int ,int *) ;
 scalar_t__ RegQueryValueExA (int ,char*,int ,int*,char*,int*) ;
 int TRUE ;
 int free (char*) ;
 char* malloc (int) ;
 int memset (char*,int ,int) ;
 int printf (char*) ;
 int strcat (char*,char*) ;
 int strcpy (char*,char*) ;

BOOL GetNpfDevice (char *lpNpfDevice)
{
 DWORD cb,lpType;
 char *lpList,*tmp;
 HKEY hkey;
 BOOL bRes = FALSE;

 lpList = malloc(0x1000);
 memset(lpList,0,0x1000);
 cb = 0x1000;

 if ( RegOpenKeyExA(HKEY_LOCAL_MACHINE,"SOFTWARE\\Microsoft\\EAPOL\\Parameters\\General",0,KEY_READ,&hkey) == ERROR_SUCCESS )
 {
  printf("AQUI");
  if ( RegQueryValueExA( hkey,
       "InterfaceList",
       0,
       &lpType,
       lpList,
       &cb) == ERROR_SUCCESS )
  {
   strcpy(lpNpfDevice,"\\\\.\\NPF_");
   while(*lpList && *lpList !='{') lpList++;
   tmp = lpList;
   while(*lpList && *(lpList) != '}') lpList ++;
   *(++lpList) = '\0';
   strcat(lpNpfDevice,tmp);
   bRes = TRUE;
  }

 }

 free(lpList);

 if (!bRes)
 {
  printf("Cannot generate NPF Device Name :-( \n");
 }

 return bRes;

}
