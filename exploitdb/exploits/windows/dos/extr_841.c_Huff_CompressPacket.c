
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






typedef int tree_t ;


 int Huff_AddReference (int ,unsigned char) ;
 int Huff_EmitByteDynamic (int ,unsigned char,unsigned char*) ;
 int Huff_PrepareTree (int ) ;
 int MAX_MSGLEN ;
 int huffBitPos ;
 int memcpy (unsigned char*,unsigned char*,int) ;

int Huff_CompressPacket( unsigned char *msg, int offset, int cursize ) {
 tree_t tree;
 unsigned char buffer[MAX_MSGLEN];
 unsigned char *data;
 int outLen;
 int inLen;
 int i;

 data = msg + offset;
 inLen = cursize - offset;
 if( inLen <= 0 || inLen >= MAX_MSGLEN ) {
  return(cursize);
 }

 Huff_PrepareTree( tree );

 buffer[0] = inLen >> 8;
 buffer[1] = inLen & 0xFF;
 huffBitPos = 16;

 for( i=0 ; i<inLen ; i++ ) {
  Huff_EmitByteDynamic( tree, data[i], buffer );
  Huff_AddReference( tree, data[i] );
 }

 outLen = (huffBitPos >> 3) + 1;

 memcpy( data, buffer, outLen );
 return(offset + outLen);
}
