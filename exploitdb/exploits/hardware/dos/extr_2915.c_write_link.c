
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






typedef int u_int ;
typedef int u_char ;
struct sockaddr_ll {int sll_protocol; int sll_ifindex; int sll_family; } ;
struct sockaddr {int dummy; } ;
struct intf {int fd; int index; } ;
typedef int sa ;


 int AF_PACKET ;
 int ETH_P_ALL ;
 int exit (int) ;
 int htons (int ) ;
 int memset (struct sockaddr_ll*,int ,int) ;
 int printf (char*,int) ;
 int sendto (int ,int *,int,int ,struct sockaddr*,int) ;

int write_link(struct intf *iface,u_char *frame, u_int size){
   int c;
   struct sockaddr_ll sa;

 memset(&sa, 0, sizeof (sa));

 sa.sll_family = AF_PACKET;
 sa.sll_ifindex = iface->index;
 sa.sll_protocol = htons(ETH_P_ALL);

 c = sendto(iface->fd, frame, size, 0, (struct sockaddr *)&sa, sizeof (sa));

 if (c != size){
  printf("error writing to bpf,, written:%d bytes\n",c);
  exit(6);
 }
 return (c);
}
