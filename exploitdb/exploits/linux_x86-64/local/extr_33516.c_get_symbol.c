
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






typedef int FILE ;


 int EOF ;
 int fclose (int *) ;
 int * fopen (char*,char*) ;
 int fscanf (int *,char*,...) ;
 int printf (char*,char*,...) ;
 int strcmp (char*,char*) ;

unsigned long get_symbol(char *target_name) {
 FILE *f;
 unsigned long addr;
 char dummy;
 char name[256];
 int ret = 0;

 f = fopen("/proc/kallsyms", "r");
 if (f == ((void*)0))
  return 0;

 while (ret != EOF) {
  ret = fscanf(f, "%p %c %s\n", (void **)&addr, &dummy, name);
  if (ret == 0) {
   fscanf(f, "%s\n", name);
   continue;
  }

  if (!strcmp(name, target_name)) {
   printf("[+] Resolved %s: %p\n", target_name, (void *)addr);

   fclose(f);
   return addr;
  }
 }

 printf("[-] Couldn't resolve \"%s\"\n", name);

 fclose(f);
 return 0;
}
