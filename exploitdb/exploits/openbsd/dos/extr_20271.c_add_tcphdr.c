
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






typedef int uint8_t ;
typedef int u_short ;
typedef int tcp ;
struct tcphdr {int protocol; int th_off; int th_seq; int th_sum; void* th_win; int th_flags; void* tot_len; scalar_t__ zero; int daddr; int saddr; int th_sport; int th_dport; } ;
struct net_tuple {int dst; int src; int sport; int dport; } ;
struct _fakehead {int protocol; int th_off; int th_seq; int th_sum; void* th_win; int th_flags; void* tot_len; scalar_t__ zero; int daddr; int saddr; int th_sport; int th_dport; } ;
typedef int fakehead ;


 int CKSUM_CARRY (int) ;
 int TCP_SIZE ;
 void* htons (int) ;
 int in_cksum (int *,int) ;
 int memcpy (unsigned char*,struct tcphdr*,int) ;
 int memset (struct tcphdr*,int ,int) ;

void
add_tcphdr(unsigned char *pkt, struct net_tuple *nt, uint8_t flags)
{
   struct tcphdr tcp;
   struct _fakehead fakehead;
   int sum;

   memset(&tcp, 0, sizeof(tcp));
   memset(&fakehead, 0, sizeof(fakehead));

   tcp.th_dport = nt->dport;
   tcp.th_sport = nt->sport;
   fakehead.saddr = nt->src;
 fakehead.daddr = nt->dst;
   fakehead.zero = 0,
   fakehead.protocol = 6;
   fakehead.tot_len = htons(TCP_SIZE);
   sum = in_cksum((u_short *)&fakehead, sizeof(fakehead));
   tcp.th_off = TCP_SIZE >> 2;
   tcp.th_seq = 31337;
   tcp.th_flags |= flags;
   tcp.th_win = htons(0x3fff);
   sum += in_cksum((u_short *)&tcp, sizeof(tcp));
   tcp.th_sum = CKSUM_CARRY(sum);
   memcpy(pkt, &tcp, sizeof(tcp));
}
