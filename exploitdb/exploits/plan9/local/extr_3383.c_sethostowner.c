
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;
 int False ;
 int OWRITE ;
 int close (int) ;
 int err (char*,...) ;
 int free (char*) ;
 int msg (char*,char*) ;
 int open (char*,int ) ;
 scalar_t__ strcmp (char*,char*) ;
 int strlen (char*) ;
 int userfile (char*,char**) ;
 int write (int,char*,int) ;

__attribute__((used)) static int
sethostowner(char * new)
{
 char * test;
 int fd;
 int n;
 int e;

 fd = open("#c/hostowner", OWRITE);
 if(fd < 0)
 {
  err("can't open \"#c/hostowner\": %r");
  return False;
 }

 n = strlen(new);

 e = write(fd, new, n);
 if(e != n)
 {
  err("write to \"#c/hostowner\" failed: %r");
  close(fd);
  return False;
 }

 close(fd);
 msg("write of \"%s\" to \"#c/hostowner\" succeeded", new);

 if(!userfile("#c/hostowner", &test))
 {
  err("can't retrieve \"#c/hostowner\" for comparison?");
  return False;
 }

 e = strcmp(new, test) == 0;
 if(!e)
 {
  err(
   "write on \"#c/hostowner\" succeeded but stored"
   "value isn't as expected: \"%s\"",
   test);
 }

 free(test);

 return e;
}
