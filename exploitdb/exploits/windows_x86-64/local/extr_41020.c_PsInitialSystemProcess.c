
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






typedef scalar_t__ ULONG64 ;
typedef int HMODULE ;
typedef int BYTE ;


 int FreeLibrary (int ) ;
 scalar_t__ GetNTOsBase () ;
 int GetProcAddress (int ,char*) ;
 int LoadLibrary (char*) ;
 int ReadFromAddress (scalar_t__,int *,int) ;

ULONG64 PsInitialSystemProcess()
{


 ULONG64 ntos = (ULONG64)LoadLibrary("ntoskrnl.exe");

 ULONG64 addr = (ULONG64)GetProcAddress((HMODULE)ntos, "PsInitialSystemProcess");
 FreeLibrary((HMODULE)ntos);
 ULONG64 res = 0;
 ULONG64 ntOsBase = GetNTOsBase();

 if (ntOsBase) {
  ReadFromAddress(addr - ntos + ntOsBase, (BYTE *)&res, sizeof(ULONG64));
 }
 return res;
}
