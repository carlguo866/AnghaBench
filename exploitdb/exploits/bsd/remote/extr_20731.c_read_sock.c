
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






typedef int ibuf ;


 char* Realloc (char*,unsigned int) ;
 scalar_t__ debug_read ;
 int fflush (int ) ;
 int memcpy (char*,char*,int) ;
 int memset (char*,int,int) ;
 int printf (char*,char*) ;
 int sock_readline (int,char*,int) ;
 int stdout ;
 int strlen (char*) ;

char *read_sock(int sock)
{
    char ibuf[8192], *bigbuf = ((void*)0);
    int r;
    unsigned int total = 0;

    for(;;)
    {
 memset(ibuf, 0x0, sizeof(ibuf));
 r = sock_readline(sock, ibuf, sizeof(ibuf) - 1);

 bigbuf = Realloc(bigbuf, (total + strlen(ibuf) + 1) * sizeof(char));
 memcpy(bigbuf + total, ibuf, strlen(ibuf));
 bigbuf[total + strlen(ibuf)] = 0x0;
 total += strlen(ibuf);

 if(strlen(ibuf) < 4)
     break;


 if(ibuf[3] != '-')
     break;
    }

    if(debug_read)
    {
 printf(" < %s", bigbuf);
 fflush(stdout);
    }

    return bigbuf;

}
