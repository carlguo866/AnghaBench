
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;
 int EXIT_FAILURE ;
 scalar_t__ badstr (unsigned char*,int,unsigned char*,int) ;
 int exit (int ) ;
 int fprintf (int ,char*) ;
 size_t random_get (int ,int) ;
 int stderr ;
 unsigned char x86_nop_xfer (char*) ;

unsigned int
x86_nop (unsigned char *dest, unsigned int dest_len,
        unsigned char *bad, int bad_len)
{
        int walk;
        int bcount;
        char * xs;
        char * xferstr[] = {
                "0011.0111",
                "0011.1111",
                "1001.1000",
                "1001.1001",
                "1111.1000",
                "1111.1100",
                "1111.0101",
                "0010.0111",
                "0010.1111",
                "0100.1r",
                "0100.0r",
                "1001.1111",
                "1001.0000",
                "1111.1001",
                "1111.1101",
                "1001.0r",
                ((void*)0),
        };
        unsigned char tgt;


        for (walk = 0 ; dest_len > 0 ; dest_len -= 1 , walk += 1) {

                for (bcount = 0 ; bcount < 16384 ; ++bcount) {
                        xs = xferstr[random_get (0, 15)];
                        tgt = x86_nop_xfer (xs);

                        dest[walk] = tgt;
                        if (badstr (&dest[walk], 1, bad, bad_len) == 0)
                                break;
                }


                if (bcount >= 16384) {
                        fprintf (stderr, "too much blacklisting, giving up...\n");
                        exit (EXIT_FAILURE);
                }
        }

        return (walk);
}
