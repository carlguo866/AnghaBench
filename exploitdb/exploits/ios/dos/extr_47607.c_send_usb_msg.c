
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_7__ TYPE_2__ ;
typedef struct TYPE_6__ TYPE_1__ ;


struct TYPE_7__ {int bmRequestType; int bRequest; int wValue; int wIndex; char const* pData; scalar_t__ wLenDone; int wLength; } ;
struct TYPE_6__ {scalar_t__ (* DeviceRequest ) (TYPE_1__**,TYPE_2__*) ;} ;
typedef TYPE_1__ IOUSBDeviceInterface ;
typedef TYPE_2__ IOUSBDevRequest ;
typedef scalar_t__ IOReturn ;


 int KERN_FAILURE ;
 scalar_t__ KERN_SUCCESS ;
 char* defaultMsg ;
 int printf (char*) ;
 int strlen (char const*) ;
 scalar_t__ stub1 (TYPE_1__**,TYPE_2__*) ;

__attribute__((used)) static int send_usb_msg(IOUSBDeviceInterface** dev, int type, int reqno, int val, int idx, const char *msg)
{

    if(!dev){
        printf("No device handle given.\n");
        return KERN_FAILURE;
    }

    if(!msg)
        msg = defaultMsg;

    IOUSBDevRequest req;
    req.bmRequestType = type;
    req.bRequest = reqno;
    req.wValue = val;
    req.wIndex = idx;
    req.wLength = strlen(msg);
    req.pData = msg;
    req.wLenDone = 0;
    IOReturn rc = KERN_SUCCESS;

    rc = (*dev)->DeviceRequest(dev, &req);

    if(rc != KERN_SUCCESS)
    {
        return rc;
    }

    return KERN_SUCCESS;
}
