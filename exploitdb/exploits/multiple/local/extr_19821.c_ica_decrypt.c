
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






typedef int u_short ;
typedef char u_char ;


 int memmove (char*,char*,int) ;
 int ntohs (int) ;

int
ica_decrypt(u_char *pass, int len)
{
  u_short i;
  u_char *p, key;

  if (len < 4)
    return (0);

  i = ntohs(*(u_short *)pass);

  if (i != len - 2)
    return (0);

  key = pass[2];
  p = pass + 3;

  for (i -= 2; i > 0; i--)
    p[i] = p[i - 1] ^ p[i] ^ key;

  p[0] ^= (key | 'C');

  i = len - 3;
  memmove(pass, pass + 3, i);
  pass[i] = '\0';

  return (1);
}
