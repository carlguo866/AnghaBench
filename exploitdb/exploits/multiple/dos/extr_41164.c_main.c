
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






typedef int pthread_t ;
typedef int kern_return_t ;
typedef int boolean_t ;
typedef int CFMutableDictionaryRef ;


 int CFDictionaryCreateMutable (int ,int ,int *,int *) ;
 int CFDictionarySetValue (int ,int ,int ) ;
 int CFSTR (char*) ;
 scalar_t__ IOServiceGetMatchingService (int ,int ) ;
 int IOServiceMatchPropertyTable (scalar_t__,int ,int *) ;
 int IOServiceMatching (char*) ;
 scalar_t__ IO_OBJECT_NULL ;
 int KERN_SUCCESS ;
 int kCFAllocatorDefault ;
 int kCFTypeDictionaryKeyCallBacks ;
 int kCFTypeDictionaryValueCallBacks ;
 int kIOMasterPortDefault ;
 int printf (char*,...) ;
 int pthread_create (int *,int *,int ,int *) ;
 int pthread_join (int ,int *) ;
 scalar_t__ service ;
 int setter ;

int main(){
  kern_return_t err;

  service = IOServiceGetMatchingService(kIOMasterPortDefault, IOServiceMatching("IOBluetoothHCIController"));

  if (service == IO_OBJECT_NULL){
    printf("unable to find service\n");
    return 0;
  }
  printf("got service: %x\n", service);

  pthread_t thread;
  pthread_create(&thread, ((void*)0), setter, ((void*)0));

  CFMutableDictionaryRef dict2;
  dict2 = CFDictionaryCreateMutable(kCFAllocatorDefault, 0,
                                   &kCFTypeDictionaryKeyCallBacks,
                                   &kCFTypeDictionaryValueCallBacks);
  CFDictionarySetValue(dict2, CFSTR("key"), CFSTR("value"));

  CFMutableDictionaryRef dict;
  dict = CFDictionaryCreateMutable(kCFAllocatorDefault, 0,
                                   &kCFTypeDictionaryKeyCallBacks,
                                   &kCFTypeDictionaryValueCallBacks);
  CFDictionarySetValue(dict, CFSTR("IOProviderClass"), CFSTR("IOService"));
  CFDictionarySetValue(dict, CFSTR("IOResourceMatch"), CFSTR("IOBSD"));
  CFDictionarySetValue(dict, CFSTR("IOParentMatch"), dict2);

  while(1) {
    boolean_t match = 0;
    err = IOServiceMatchPropertyTable(service, dict, &match);
    if (err != KERN_SUCCESS){
      printf("no matches\n");
    }
  }

  pthread_join(thread, ((void*)0));

  return 0;
}
