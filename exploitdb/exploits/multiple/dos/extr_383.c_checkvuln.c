
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;
 int checked ;
 int exit (int) ;
 int force ;
 int printf (char*,...) ;
 int sprintf (char*,int ) ;
 scalar_t__ strcasecmp (char*,char*) ;
 int strlen (char*) ;
 char* strstr (char*,char*) ;

int checkvuln(char *rxbuf)
{
  int vuln_t;
  char *bnc;

  sprintf(&rxbuf[strlen(rxbuf)-2], 0);

  if (force == 1) {return 0;}
  if (checked == 1) { return 0;}
  printf("[?] Server returned: %s\n", rxbuf);
  if (bnc = strstr(rxbuf, "psyBNC2.")) {
    if (strcasecmp(&bnc[9], ".") > 0) {
      vuln_t = 1;
    }
    if ((int)(bnc[8] - '0') <= 3) {
      if ((int)(bnc[8] - '0') == 3 && vuln_t == 1) {
        printf("[!] Server is NOT VULN!\n");
        exit(1);
      }
      printf("[*] Server is VULN!!\n");
    } else {
      printf("[!] Server is NOT VULN!\n");
      exit(1);
    }
  } else {
    printf("[!] Server is NOT VULN!\n");
    exit(1);
  }

  checked = 1;

  return 0;
}
