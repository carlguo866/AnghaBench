
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






typedef int tv ;
struct timeval {int tv_usec; int tv_sec; } ;
typedef int fd_set ;


 int ERR_READSOCK ;
 int FD_SET (scalar_t__,int *) ;
 int FD_ZERO (int *) ;
 int QUIT (int ) ;
 int bzero (struct timeval*,int) ;
 int read (scalar_t__,void*,int) ;
 scalar_t__ select (scalar_t__,int *,int *,int *,struct timeval*) ;
 scalar_t__ sock ;
 int timeout ;

int read_sock(void * buf, int sz)
{
    fd_set rd;
    struct timeval tv;
    int ret;

    FD_ZERO(&rd);
    FD_SET(sock, &rd);
    bzero(&tv, sizeof (tv));
    tv.tv_sec = timeout;
    tv.tv_usec = ret = 0;
    if (select(sock + 1, &rd, ((void*)0), ((void*)0), &tv) <= 0)
        QUIT(ERR_READSOCK);
    if ((ret = read(sock, buf, sz)) <= 0)
    return (ret);
}
