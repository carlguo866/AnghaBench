
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_2__ TYPE_1__ ;


struct TYPE_2__ {int id; scalar_t__ name; } ;


 char* BAD_TRIP ;
 TYPE_1__* CVSROOTS ;
 int CVS_AUTH_FAILED ;
 int CVS_AUTH_SUCCESS ;
 int CVS_BAD_REP ;
 int CVS_NO_USER ;
 int CVS_VERIF ;
 int DUMMY ;
 char* GOOD_TRIP ;
 char* flush_sock () ;
 int free (char*) ;
 int host ;
 int info (char*,...) ;
 int nclose () ;
 int nopen (int ,int ) ;
 int nprintf (int ,scalar_t__,int ,int ) ;
 scalar_t__ pass ;
 int port ;
 int printf (char*) ;
 scalar_t__ root ;
 int scramble (int ) ;
 scalar_t__ strstr (char*,int ) ;
 scalar_t__ user ;

int brute_cvsroot(void)
{
    int i, ret = 0;
    char * rbuf;

    info("Bruteforcing cvsroot...\n");
    for (i = 0; CVSROOTS[i].name; i++)
        {
            nopen(host, port);
            nprintf(CVS_VERIF, CVSROOTS[i].name, DUMMY, scramble(DUMMY));
            info("Trying CVSROOT = %s\t", CVSROOTS[i].name);
            rbuf = flush_sock();
            nclose();
            if (!rbuf || strstr(rbuf, CVS_BAD_REP))
                info(BAD_TRIP);
            else if (strstr(rbuf, CVS_AUTH_FAILED) ||
                     strstr(rbuf, CVS_AUTH_SUCCESS) ||
                     strstr(rbuf, CVS_NO_USER))
                {
                    info(GOOD_TRIP);
                    CVSROOTS[i].id = i;
                    root = CVSROOTS[i].name;
                    if (user && pass)
                        {
                            free(rbuf);
                            return (1);
                        }
                    ret++;
                }
            else
                printf(BAD_TRIP);
            free(rbuf);
        }
    return (ret);
}
