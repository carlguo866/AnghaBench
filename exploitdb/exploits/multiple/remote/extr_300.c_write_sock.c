
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






typedef int tv ;
struct timeval {scalar_t__ tv_usec; void* tv_sec; } ;
typedef int fd_set ;


 int ERR_WRITESOCK ;
 int FD_SET (scalar_t__,int *) ;
 int FD_ZERO (int *) ;
 int QUIT (int ) ;
 int bzero (struct timeval*,int) ;
 scalar_t__ select (scalar_t__,int *,int *,int *,struct timeval*) ;
 scalar_t__ sock ;
 void* timeout ;
 int write (scalar_t__,void*,int) ;

int write_sock(void * buf, int sz)
{
    fd_set wfds;
    struct timeval tv;
    int ret;

    if (sz <= 0)
        return (sz);
    FD_ZERO(&wfds);
    FD_SET(sock, &wfds);
    bzero(&tv, sizeof (tv));
    tv.tv_sec = timeout;
    tv.tv_usec = 0;
    while (select(sock + 1, ((void*)0), &wfds, ((void*)0), &tv) <= 0)
        {
            FD_ZERO(&wfds);
            FD_SET(sock, &wfds);
            tv.tv_sec = timeout;
            tv.tv_usec = 0;
        }
    if ((ret = write(sock, buf, sz)) != sz)
        QUIT(ERR_WRITESOCK);
    return (ret);
}
