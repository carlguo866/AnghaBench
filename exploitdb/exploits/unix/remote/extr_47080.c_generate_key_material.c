
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_3__ TYPE_1__ ;


struct TYPE_3__ {unsigned char* key_material; unsigned char* master_key; unsigned char* challenge; unsigned char* conn_id; int conn_id_length; } ;
typedef TYPE_1__ ssl_conn ;
typedef int MD5_CTX ;


 int CHALLENGE_LENGTH ;
 scalar_t__ MD5_DIGEST_LENGTH ;
 int MD5_Final (unsigned char*,int *) ;
 int MD5_Init (int *) ;
 int MD5_Update (int *,unsigned char*,int) ;
 int RC4_KEY_LENGTH ;
 unsigned int RC4_KEY_MATERIAL_LENGTH ;

void generate_key_material(ssl_conn* ssl)
{
 unsigned int i;
 MD5_CTX ctx;
 unsigned char *km;
 unsigned char c='0';

 km=ssl->key_material;
 for (i=0; i<RC4_KEY_MATERIAL_LENGTH; i+=MD5_DIGEST_LENGTH) {
  MD5_Init(&ctx);

  MD5_Update(&ctx,ssl->master_key,RC4_KEY_LENGTH);
  MD5_Update(&ctx,&c,1);
  c++;
  MD5_Update(&ctx,ssl->challenge,CHALLENGE_LENGTH);
  MD5_Update(&ctx,ssl->conn_id, ssl->conn_id_length);
  MD5_Final(km,&ctx);
  km+=MD5_DIGEST_LENGTH;
 }
}
