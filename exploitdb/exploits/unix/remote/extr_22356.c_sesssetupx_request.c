
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






typedef char uint8 ;
struct smb_base_header {int dummy; } ;
struct sesssetupx_request_header {int dummy; } ;
struct nbt_session_header {int dummy; } ;
typedef int packet ;
typedef int data ;


 int SMB_SESSION ;
 int SMB_SESSSETUPX ;
 int close (int) ;
 int construct_nbt_session_header (char*,int ,int ,int) ;
 int construct_sesssetupx_header (char*) ;
 int construct_smb_base_header (char*,int ,int,int,int ,int ,int ,int) ;
 int errno ;
 int exit (int) ;
 int fprintf (int ,char*,...) ;
 int memcpy (char*,char**,int) ;
 int pid ;
 int stderr ;
 char* strerror (int) ;
 int write (int,char*,int) ;

void sesssetupx_request(int fd)
{ uint8 data[] = "\x12\x0\x0\x0\x55\x6e\x69\x78\x00\x53\x61\x6d\x62\x61";
 char packet[sizeof (struct nbt_session_header) + sizeof (struct
smb_base_header) +
 sizeof (struct sesssetupx_request_header) + sizeof (data)];
 int size;

 construct_nbt_session_header(packet, SMB_SESSION, 0, sizeof (packet) -
sizeof (struct nbt_session_header));
 construct_smb_base_header(packet + sizeof (struct nbt_session_header),
SMB_SESSSETUPX, 8, 1, 0, pid, 0, 1);
 construct_sesssetupx_header(packet + sizeof (struct nbt_session_header) +
sizeof (struct smb_base_header));
 memcpy(packet + sizeof (struct nbt_session_header) + sizeof (struct
smb_base_header) +
 sizeof (struct sesssetupx_request_header), &data, sizeof (data));

 if ((size = write(fd, packet, sizeof (packet))) == -1)
 { close(fd);
 fprintf(stderr, "write() failed, reason: '%s' (code %i)\n",
strerror(errno), errno);
 exit(-errno);
 }
 if (size != sizeof (packet))
 { close(fd);
 fprintf(stderr, "couldn't write entire packet, aborting!\n");
 exit(-1);
 }
}
