
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_4__ TYPE_2__ ;
typedef struct TYPE_3__ TYPE_1__ ;


struct TYPE_3__ {scalar_t__ name; } ;
struct TYPE_4__ {TYPE_1__ port; int header; int member_0; } ;
typedef TYPE_2__ port_msg_rcv_t ;
typedef int msg ;
typedef scalar_t__ mach_port_t ;
typedef int kern_return_t ;


 int FAIL (char*) ;
 int LOG (char*) ;
 int MACH_ERR (char*,int ) ;
 int MACH_MSG_TIMEOUT_NONE ;
 scalar_t__ MACH_PORT_NULL ;
 int MACH_RCV_MSG ;
 int mach_msg (int *,int ,int ,int,scalar_t__,int ,scalar_t__) ;

mach_port_t do_parent(mach_port_t shared_port) {
  kern_return_t err;


  port_msg_rcv_t msg = {0};
  err = mach_msg(&msg.header,
                 MACH_RCV_MSG,
                 0,
                 sizeof(msg),
                 shared_port,
                 MACH_MSG_TIMEOUT_NONE,
                 MACH_PORT_NULL);
  MACH_ERR("parent receiving child task port message", err);

  mach_port_t child_task_port = msg.port.name;
  if (child_task_port == MACH_PORT_NULL) {
    FAIL("invalid child task port");
  }

  LOG("parent received child's task port");

  return child_task_port;
}
