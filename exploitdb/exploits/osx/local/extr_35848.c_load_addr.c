
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






typedef int uint64_t ;
typedef int CFIndex ;
typedef int CFDictionaryRef ;


 int CFDictionaryGetCount (int ) ;
 int CFDictionaryGetKeysAndValues (int ,void const**,void const**) ;
 int CFDictionaryGetValue (void*,int ) ;
 int CFNumberGetValue (int ,int ,int *) ;
 int CFSTR (char*) ;
 char* CFStringGetCStringPtr (int ,int ) ;
 int OSKextCopyLoadedKextInfo (int *,int *) ;
 int kCFNumberSInt64Type ;
 int kCFStringEncodingMacRoman ;
 scalar_t__ malloc (int) ;
 int printf (char*,char const*,int ) ;
 scalar_t__ strcmp (char const*,char*) ;

uint64_t load_addr(){
  uint64_t addr = 0;
  CFDictionaryRef kd = OSKextCopyLoadedKextInfo(((void*)0), ((void*)0));
  CFIndex count = CFDictionaryGetCount(kd);

  void **keys;
  void **values;

  keys = (void **)malloc(sizeof(void *) * count);
  values = (void **)malloc(sizeof(void *) * count);

  CFDictionaryGetKeysAndValues(kd,
                               (const void **)keys,
                               (const void **)values);

  for(CFIndex i = 0; i < count; i++){
    const char *name = CFStringGetCStringPtr(CFDictionaryGetValue(values[i], CFSTR("CFBundleIdentifier")), kCFStringEncodingMacRoman);
    if (strcmp(name, "com.apple.iokit.IONDRVSupport") == 0){
      CFNumberGetValue(CFDictionaryGetValue(values[i],
                       CFSTR("OSBundleLoadAddress")),
                       kCFNumberSInt64Type,
                       &addr);
      printf("%s: 0x%016llx\n", name, addr);
      break;
    }
  }
  return addr;
}
