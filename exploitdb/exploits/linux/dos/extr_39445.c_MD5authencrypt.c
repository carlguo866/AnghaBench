
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






typedef int uint32_t ;
typedef int u_int ;
typedef int u_char ;
typedef int EVP_MD_CTX ;


 int EVP_DigestFinal (int *,int *,int*) ;
 int EVP_DigestInit (int *,int ) ;
 int EVP_DigestUpdate (int *,int *,int) ;
 int EVP_MAX_MD_SIZE ;
 int EVP_get_digestbynid (int) ;
 int INIT_SSL () ;
 scalar_t__ cache_keylen ;
 int memmove (int *,int *,int) ;

int
MD5authencrypt(
        int type,
        u_char *key,
        uint32_t *pkt,
        int length
        )
{
        u_char digest[EVP_MAX_MD_SIZE];
        u_int len;
        EVP_MD_CTX ctx;






        INIT_SSL();
        EVP_DigestInit(&ctx, EVP_get_digestbynid(type));
        EVP_DigestUpdate(&ctx, key, (u_int)cache_keylen);
        EVP_DigestUpdate(&ctx, (u_char *)pkt, (u_int)length);
        EVP_DigestFinal(&ctx, digest, &len);
        memmove((u_char *)pkt + length + 4, digest, len);
        return (len + 4);
}
