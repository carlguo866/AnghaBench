
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_4__ TYPE_1__ ;


typedef int gnutls_x509_crt_t ;
struct TYPE_4__ {char* member_0; int member_1; } ;
typedef TYPE_1__ gnutls_datum_t ;


 int GNUTLS_X509_FMT_PEM ;
 int dsa_cert_dat ;
 int gnutls_global_deinit () ;
 int gnutls_global_init () ;
 int gnutls_x509_crt_deinit (int ) ;
 int gnutls_x509_crt_import (int ,int *,int ) ;
 int gnutls_x509_crt_init (int *) ;
 int gnutls_x509_crt_verify_data (int ,int ,TYPE_1__*,TYPE_1__*) ;
 int printf (char*) ;

int
main (void)
{
  gnutls_x509_crt_t crt;
  gnutls_datum_t data = { "foo", 3 };
  gnutls_datum_t sig = { "bar", 3 };
  int ret;

  gnutls_global_init ();

  ret = gnutls_x509_crt_init (&crt);
  if (ret < 0)
    return 1;

  ret = gnutls_x509_crt_import (crt, &dsa_cert_dat, GNUTLS_X509_FMT_PEM);
  if (ret < 0)
    return 1;

  ret = gnutls_x509_crt_verify_data (crt, 0, &data, &sig);
  if (ret < 0)
    return 1;

  printf ("success!\n");

  gnutls_x509_crt_deinit (crt);
  gnutls_global_deinit ();

  return 0;
}
