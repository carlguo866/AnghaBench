
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






struct rlimit {int rlim_cur; } ;
typedef int TAR ;


 int O_CREAT ;
 int O_WRONLY ;
 int RLIMIT_STACK ;
 int TAR_GNU ;
 int errno ;
 int error (int,int ,char*,...) ;
 scalar_t__ getrlimit (int ,struct rlimit*) ;
 char* malloc (unsigned int) ;
 int memcpy (char*,char*,int) ;
 scalar_t__ tar_append_file (int *,char*,char*) ;
 scalar_t__ tar_close (int *) ;
 scalar_t__ tar_open (int **,char const*,int *,int,int,int ) ;

int main(int ac, const char *av[])
{
 struct rlimit r;
 unsigned count, i;
 char *s;
 TAR *t;

 if (ac != 2)
  error(1, 0, "exactly two arguments expected");

 if (getrlimit(RLIMIT_STACK, &r))
  error(1, errno, "getrlimit RLIMIT_STACK");

 count = r.rlim_cur / 3 + 1;
 if (!(s = malloc(count * 3 + 1)))
  error(1, errno, "malloc: %u", count * 3 + 1);

 for (i = 0; i < count; ++i)
  memcpy(s + i * 3, "../", 3);
 s[count * 3] = '\0';

 if (tar_open(&t, av[1], ((void*)0), O_WRONLY|O_CREAT, 0644, TAR_GNU))
  error(1, errno, "tar_open: %s", av[1]);

 if (tar_append_file(t, "/dev/null", s))
  error(1, errno, "tar_append_file: %s", av[1]);

 if (tar_close(t))
  error(1, errno, "tar_close");

 return 0;
}
