
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_2__ TYPE_1__ ;


struct TYPE_2__ {int MD5_key; } ;
struct savekey {scalar_t__ keyid; scalar_t__ type; int flags; int keylen; TYPE_1__ k; struct savekey* next; } ;
typedef scalar_t__ keyid_t ;


 size_t KEYHASH (scalar_t__) ;
 int KEY_TRUSTED ;
 int authkeylookups ;
 int authkeynotfound ;
 int authkeyuncached ;
 int authnokey ;
 int cache_flags ;
 int cache_key ;
 scalar_t__ cache_keyid ;
 int cache_keylen ;
 scalar_t__ cache_type ;
 struct savekey** key_hash ;

int
authhavekey(
 keyid_t keyno
 )
{
 struct savekey *sk;

 authkeylookups++;
 if (keyno == 0 || keyno == cache_keyid)
  return (1);






 authkeyuncached++;
 sk = key_hash[KEYHASH(keyno)];
 while (sk != ((void*)0)) {
  if (keyno == sk->keyid) {
   if (sk->type == 0) {
    authkeynotfound++;
    return (0);
   }
   break;
  }
  sk = sk->next;
 }





 if (sk == ((void*)0)) {
  authkeynotfound++;
  return (0);

 }
 if (!(sk->flags & KEY_TRUSTED)) {
  authnokey++;
  return (0);
 }




 cache_keyid = sk->keyid;
 cache_type = sk->type;
 cache_flags = sk->flags;
 cache_key = sk->k.MD5_key;
 cache_keylen = sk->keylen;
 return (1);
}
