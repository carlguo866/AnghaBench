
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






typedef int STREAM ;


 int SEC_TAG_CLI_CRYPT ;
 int SEC_TAG_CLI_INFO ;
 scalar_t__ encryption ;
 int height ;
 int hostname ;
 int keylayout ;
 int out_uint16 (int ,int ) ;
 int out_uint16_be (int ,int) ;
 int out_uint16_le (int ,int) ;
 int out_uint32 (int ,int ) ;
 int out_uint32_le (int ,int) ;
 int out_uint8 (int ,int) ;
 int out_uint8s (int ,int) ;
 int rdp_out_unistr (int ,int ,int) ;
 int s_mark_end (int ) ;
 int strlen (int ) ;
 int width ;

__attribute__((used)) static void
sec_out_mcs_data(STREAM s)
{
 int hostlen = 2 * strlen(hostname);

 if (hostlen > 30)
  hostlen = 30;

 out_uint16_be(s, 5);
 out_uint16_be(s, 0x14);
 out_uint8(s, 0x7c);
 out_uint16_be(s, 1);

 out_uint16_be(s, (158 | 0x8000));

 out_uint16_be(s, 8);
 out_uint16_be(s, 16);
 out_uint8(s, 0);
 out_uint16_le(s, 0xc001);
 out_uint8(s, 0);

 out_uint32_le(s, 0x61637544);
 out_uint16_be(s, (144 | 0x8000));


 out_uint16_le(s, SEC_TAG_CLI_INFO);
 out_uint16_le(s, 136);
 out_uint16_le(s, 1);
 out_uint16_le(s, 8);
 out_uint16_le(s, width);
 out_uint16_le(s, height);
 out_uint16_le(s, 0xca01);
 out_uint16_le(s, 0xaa03);
 out_uint32_le(s, keylayout);
 out_uint32_le(s, 419);


 rdp_out_unistr(s, hostname, hostlen);
 out_uint8s(s, 30 - hostlen);

 out_uint32_le(s, 4);
 out_uint32(s, 0);
 out_uint32_le(s, 12);
 out_uint8s(s, 64);

 out_uint16_le(s, 0xca01);
 out_uint16(s, 0);


 out_uint16_le(s, SEC_TAG_CLI_CRYPT);
 out_uint16_le(s, 8);
 out_uint32_le(s, encryption ? 0x3 : 0);
 s_mark_end(s);
}
