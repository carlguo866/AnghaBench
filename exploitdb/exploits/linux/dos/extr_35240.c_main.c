
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;
 int exit (int) ;
 int fflush (int ) ;
 int fprintf (int ,char*) ;
 int printf (char*,int) ;
 int read (int,char*,int) ;
 int stderr ;
 int stdout ;
 int ud_connect (char*) ;

int main(int argc, char *argv[])
{
 int fd;
 char c;

 if (argc != 2) {
  fprintf(stderr, "Usage: prog fname\n");
  exit(1);
 }

 fd = ud_connect(argv[1]);
 if (fd < 0)
  exit(1);
 printf("\"Hanging\" socket opened, fd = %d\n", fd);

 fd = ud_connect(argv[1]);
 if (fd < 0)
  exit(1);
 printf("Normal socket opened, fd = %d\n", fd);

 while (1) {
  static int n;
  read(fd, &c, 1);
  fflush(stdout);
  if (c == '\n') {
   printf("%d messages in queue\n", ++n);
  }
 }
}
