
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_5__ TYPE_3__ ;
typedef struct TYPE_4__ TYPE_1__ ;


typedef int pthread_t ;
struct TYPE_5__ {int sll_protocol; int sll_ifindex; int sll_family; } ;
struct TYPE_4__ {int ifr_ifindex; short ifr_flags; int ifr_name; } ;


 int AF_PACKET ;
 scalar_t__ IFF_UP ;
 int IS_ERR (int,char*) ;
 int PF_PACKET ;
 int SIOCGIFFLAGS ;
 int SIOCGIFINDEX ;
 int SIOCSIFFLAGS ;
 int SOCK_RAW ;
 TYPE_3__ addr ;
 int close (int) ;
 int fd ;
 TYPE_1__ ifr ;
 int ioctl (int,int ,TYPE_1__*) ;
 int pthread_create (int *,int *,int ,int *) ;
 int pthread_join (int ,int *) ;
 int socket (int ,int ,int ) ;
 int strcpy (char*,char*) ;
 int task1 ;
 int task2 ;

void loop_race()
{
int err, index;

while(1) {
fd = socket(AF_PACKET, SOCK_RAW, PF_PACKET);
IS_ERR(fd == -1, "socket");

strcpy((char *)&ifr.ifr_name, "lo");
err = ioctl(fd, SIOCGIFINDEX, &ifr);
IS_ERR(err == -1, "ioctl SIOCGIFINDEX");
index = ifr.ifr_ifindex;

err = ioctl(fd, SIOCGIFFLAGS, &ifr);
IS_ERR(err == -1, "ioctl SIOCGIFFLAGS");

ifr.ifr_flags &= ~(short)IFF_UP;
err = ioctl(fd, SIOCSIFFLAGS, &ifr);
IS_ERR(err == -1, "ioctl SIOCSIFFLAGS");

addr.sll_family = AF_PACKET;
addr.sll_protocol = 0x0;
addr.sll_ifindex = index;

pthread_t thread1, thread2;
    pthread_create (&thread1, ((void*)0), task1, ((void*)0));
    pthread_create (&thread2, ((void*)0), task2, ((void*)0));

    pthread_join(thread1, ((void*)0));
    pthread_join(thread2, ((void*)0));


close(fd);
}
}
