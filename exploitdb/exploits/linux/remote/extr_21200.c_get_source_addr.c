
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_2__ TYPE_1__ ;


struct TYPE_2__ {scalar_t__ s_addr; } ;
struct sockaddr_in {TYPE_1__ sin_addr; } ;
struct sockaddr {int dummy; } ;
typedef int me ;


 int AF_INET ;
 int IPPROTO_UDP ;
 int SOCK_DGRAM ;
 int close (int) ;
 scalar_t__ connect (int,struct sockaddr*,int) ;
 int errno ;
 int fatal (char*,int ) ;
 scalar_t__ getsockname (int,struct sockaddr*,int*) ;
 int socket (int ,int ,int ) ;
 int strerror (int ) ;

__attribute__((used)) static unsigned long
get_source_addr (struct sockaddr_in *s_in)
{
 int sd, slen;
 struct sockaddr_in me;

 if ((sd = socket (AF_INET, SOCK_DGRAM, IPPROTO_UDP)) < 0)
  fatal ("socket(): %s\n", strerror (errno));

 if (connect (sd, (struct sockaddr *) s_in, sizeof (struct sockaddr_in)) < 0)
  fatal ("connect(): %s\n", strerror (errno));

 slen = sizeof (me);
 if (getsockname (sd, (struct sockaddr *) &me, &slen) < 0)
  fatal ("getsockname(): %s\n", strerror (errno));

 close (sd);

 return ((unsigned long) me.sin_addr.s_addr);
}
