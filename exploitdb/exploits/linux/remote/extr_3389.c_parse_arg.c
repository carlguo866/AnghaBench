
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






struct in_addr {int s_addr; } ;


 int EOF ;
 int FIX_DWORD (int ,int ,int ) ;
 int FIX_WORD (int ,int ,void*) ;
 int IP_OFFSET ;
 int PORT_OFFSET ;
 void* atoi (int ) ;
 void* driver ;
 int exit (int) ;
 int getopt (int,char**,char*) ;
 void* iface ;
 int inet_aton (void*,struct in_addr*) ;
 void* ip ;
 int jmp_address ;
 int optarg ;
 void* pad_space ;
 void* port ;
 void* strdup (int ) ;
 int strtoll (int ,int *,int) ;
 int u_code ;
 int usage (char*) ;

void parse_arg(int argc, char **argv)
{
  int opt;
  struct in_addr in;
  while( (opt=getopt(argc, argv, "j:i:a:p:d:g:")) != EOF)
  {
    switch(opt)
    {
      case 'j':
        jmp_address = strtoll(optarg, ((void*)0), 16);
        break;
      case 'a':
        ip = strdup(optarg);
        inet_aton(ip, &in);
        FIX_DWORD(u_code, IP_OFFSET, ~(in.s_addr));
        break;
      case 'p':
        port = atoi(optarg);
        FIX_WORD(u_code, PORT_OFFSET, port);
        break;
      case 'd':
        driver = strdup(optarg);
        break;
      case 'i':
        iface = strdup(optarg);
        break;
      case 'g':
        pad_space = atoi(optarg);
        break;
      default:
        usage(argv[0]);
        exit(1);
    }
  }
}
