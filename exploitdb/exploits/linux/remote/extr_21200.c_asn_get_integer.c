
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






typedef int u_char ;


 int ASN_INTEGER ;
 int fatal (char*) ;

__attribute__((used)) static u_char *
asn_get_integer (u_char *pkt, int *pdst)
{
 int len, nbits, dst;

 if (*pkt++ != ASN_INTEGER)
  fatal ("error: error while talking to client\n");

 len = *pkt++;
 if (len != 1 && len != 2 && len != 4)
  fatal ("error: incorrent integer len received from client\n");

 switch (len)
 {
 case 4:
  nbits = 24; break;
 case 2:
  nbits = 8; break;
 case 1:
  nbits = 0; break;
 }

 dst = 0;
 while (len--)
 {
  dst |= ((*pkt++) << nbits);
  nbits -= 8;
 }

 *pdst = dst;

 return (pkt);
}
