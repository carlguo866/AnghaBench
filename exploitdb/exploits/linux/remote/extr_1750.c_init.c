
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_2__ TYPE_1__ ;


struct TYPE_2__ {char* name; int hooklen; scalar_t__ directconnect; scalar_t__ sendservercommand; int fn; } ;


 int EXIT_FAILURE ;
 void* _directconnect ;
 void* _sendservercommand ;
 size_t c ;
 int directconnect ;
 int exit (int ) ;
 TYPE_1__* games ;
 void* hook (void*,int ,int *) ;
 size_t ngames ;
 int perror (char*) ;
 int printf (char*,...) ;
 int readlink (char*,char*,int) ;
 int sendservercommand ;
 scalar_t__ strstr (char*,int ) ;
 int writebuf () ;

void __attribute__ ((constructor)) init (void) {
 char buf[256];
 int ret;

 printf("remap_this.c by landser - landser at hotmail.co.il\n\n");

 ret = readlink("/proc/self/exe", buf, sizeof buf);
 if (ret < 0) {
  perror("readlink()");
  exit(EXIT_FAILURE);
 }
 buf[ret] = '\0';

 for (c=0;c<ngames;c++)
  if (strstr(buf, games[c].fn)) break;

 if (c == ngames) {
  printf("binary doesnt match any of the targets.\n");
  exit(EXIT_FAILURE);
 }

 printf("game: %s.\n\n", games[c].name);

 writebuf();

 _sendservercommand = hook((void *)games[c].sendservercommand, games[c].hooklen, &sendservercommand);
 _directconnect = hook((void *)games[c].directconnect, games[c].hooklen, &directconnect);
}
