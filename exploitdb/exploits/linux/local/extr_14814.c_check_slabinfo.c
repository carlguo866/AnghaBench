
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






typedef int slab ;
typedef int name ;
typedef int FILE ;


 int exit (int) ;
 int fclose (int *) ;
 int fgets (char*,int,int *) ;
 int * fopen (char*,char*) ;
 int memset (char*,int ,int) ;
 int printf (char*) ;
 int sscanf (char*,char*,char*,int*,int*) ;
 scalar_t__ strcmp (char*,char*) ;

int
check_slabinfo(char *cache, int *active_out, int *total_out)
{
 FILE *fp;
 char name[64], slab[256];
 int active, total, diff;

 memset(slab, 0, sizeof(slab));
 memset(name, 0, sizeof(name));

 fp = fopen("/proc/slabinfo", "r");
 if (!fp) {
  printf("[-] sorry, /proc/slabinfo is not available!");
  exit(1);
 }

 fgets(slab, sizeof(slab) - 1, fp);
 while (1) {
  fgets(slab, sizeof(slab) - 1, fp);
  sscanf(slab, "%s %u %u", name, &active, &total);
  diff = total - active;
  if (strcmp(name, cache) == 0) {
   break;
  }
 }
 fclose(fp);

 if (active_out) {
  *active_out = active;
 }
 if (total_out) {
  *total_out = total;
 }
 return diff;
}
