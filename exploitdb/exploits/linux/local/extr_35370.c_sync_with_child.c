
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






struct sigaction {int * sa_restorer; scalar_t__ sa_flags; int sa_mask; int sa_handler; } ;
typedef int pid_t ;


 int SIGALRM ;
 int alarm (int) ;
 scalar_t__ int_sync_time_out ;
 int read_voluntary_ctxt_switches (int ) ;
 int sigaction (int ,struct sigaction*,int *) ;
 int sigemptyset (int *) ;
 int sync_timeout_task ;
 int usleep (int) ;

__attribute__((used)) static int sync_with_child(pid_t pid, int volatile *do_request, int volatile *did_request)
{
 struct sigaction act;
 int vcscnt;
 int_sync_time_out = 0;

 act.sa_handler = sync_timeout_task;
 sigemptyset(&act.sa_mask);
 act.sa_flags = 0;
 act.sa_restorer = ((void*)0);
 sigaction(SIGALRM, &act, ((void*)0));

 alarm(3);
 while (*do_request == 0) {
  if (int_sync_time_out)
   return -1;
 }

 alarm(0);
 vcscnt = read_voluntary_ctxt_switches(pid);
 *did_request = 1;
 while (read_voluntary_ctxt_switches(pid) != vcscnt + 1) {
     usleep(10);
 }

 return 0;
}
