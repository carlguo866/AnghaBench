
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






struct utsname {char* release; } ;


 int _exit (int ) ;
 int fflush (int ) ;
 int printf (char*,...) ;
 int sscanf (char*,char*,int*,int*,int*) ;
 int stdout ;
 int uname (struct utsname*) ;

__attribute__((used)) static inline void check_kver(void)
{
static struct utsname un;
int a=0, b=0, c=0, v=0, e=0, n;

 uname(&un);
 n=sscanf(un.release, "%d.%d.%d", &a, &b, &c);
 if(n!=3 || a!=2) {
  printf("\n[-] invalid kernel version string\n");
  _exit(0);
 }

 if(b==2) {
  if(c<=25)
   v=1;
 }
 else if(b==3) {
  if(c<=99)
   v=1;
 }
 else if(b==4) {
  if(c>18 && c<=24)
   v=1, e=1;
  else if(c>24)
   v=0, e=0;
  else
   v=1, e=0;
 }
 else if(b==5 && c<=75)
  v=1, e=1;
 else if(b==6 && c<=2)
  v=1, e=1;

 printf("\n[+] kernel %s  vulnerable: %s  exploitable %s",
  un.release, v? "YES" : "NO", e? "YES" : "NO" );
 fflush(stdout);

 if(v && e)
  return;
 _exit(0);
}
