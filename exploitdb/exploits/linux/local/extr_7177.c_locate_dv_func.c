
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






typedef int bfd ;
typedef int asymbol ;


 char* bfd_asymbol_name (int *) ;
 void* bfd_asymbol_value (int *) ;
 int bfd_canonicalize_symtab (int *,int **) ;
 int bfd_check_format (int *,int ) ;
 long bfd_get_symtab_upper_bound (int *) ;
 int bfd_object ;
 int * bfd_openr (int ,int *) ;
 int exit (int) ;
 int fprintf (int ,char*,...) ;
 int getpid () ;
 scalar_t__ malloc (long) ;
 int oracle ;
 int perror (char*) ;
 int stderr ;
 int strcmp (char*,char*) ;

long locate_dv_func(void)
{
 asymbol **symbol_table;
 bfd *b = bfd_openr(oracle, ((void*)0));
 if (b == ((void*)0)) {
  perror("bfd_openr");
  exit(-1);
 }

 bfd_check_format(b, bfd_object);
 long storage_needed = bfd_get_symtab_upper_bound(b);
 if(storage_needed < 0) {
  fprintf(stderr, "wtf?!\n");
  exit(-1);
 }

 if((symbol_table = (asymbol**)malloc(storage_needed)) == 0) {
  perror("malloc");
  exit(-1);
 }

 int num_symbols;
 if((num_symbols = bfd_canonicalize_symtab(b, symbol_table)) <= 0) {
  fprintf(stderr, "no symbols info\n");
  exit(-1);
 }

 int i;
 for(i = 0; i < num_symbols; i++) {
  char *symname = bfd_asymbol_name(symbol_table[i]);
  void *symaddr = bfd_asymbol_value(symbol_table[i]);

  if(!strcmp(symname, "kzvtins")) {
   fprintf(stderr, "[%d] symbol \"kzvtins\" at 0x%lx\n", getpid(),
    (long) symaddr);
   return (long) symaddr;
  }
 }

 return 0;
}
