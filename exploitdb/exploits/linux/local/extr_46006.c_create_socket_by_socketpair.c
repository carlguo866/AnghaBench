
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;
 int AF_UNIX ;
 int SOCK_SEQPACKET ;
 int SOL_SOCKET ;
 int SO_ATTACH_BPF ;
 int exit (int) ;
 int printf (char*) ;
 scalar_t__ setsockopt (int,int ,int ,int*,int) ;
 scalar_t__ socketpair (int ,int ,int ,int*) ;

int create_socket_by_socketpair(int *progfd)
{
 int socks[2];
    if (socketpair(AF_UNIX, SOCK_SEQPACKET, 0, socks)) {
        printf("socketpair error\n");
        exit(-1);
    }
    if (setsockopt(socks[0], SOL_SOCKET, SO_ATTACH_BPF, progfd, sizeof(int))) {
        printf("setsockopt error\n");
        exit(-1);
    }
    return socks[1];
}
