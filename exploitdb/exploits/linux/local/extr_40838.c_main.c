
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_3__ TYPE_1__ ;


struct TYPE_3__ {scalar_t__ st_size; } ;


 int MAP_PRIVATE ;
 int O_RDONLY ;
 int PROT_READ ;
 int PTRACE_POKETEXT ;
 int PTRACE_TRACEME ;
 int SIGSTOP ;
 int f ;
 scalar_t__ fork () ;
 int fstat (int ,TYPE_1__*) ;
 int getpid () ;
 int kill (int ,int ) ;
 int madviseThread ;
 scalar_t__ map ;
 scalar_t__ mmap (int *,scalar_t__,int ,int ,int ,int ) ;
 int open (char*,int ) ;
 scalar_t__ pid ;
 int printf (char*,...) ;
 int pth ;
 int pthread_create (int *,int *,int ,int *) ;
 int pthread_join (int ,int *) ;
 scalar_t__ ptrace (int ,...) ;
 TYPE_1__ st ;
 int strlen (char*) ;
 int waitpid (scalar_t__,int *,int ) ;

int main(int argc,char *argv[]) {
  if(argc<3)return 1 ;
  printf("%s                               \n   (___)                                   \n   (o o)_____/                             \n    @@ `     \\                            \n     \\ ____, /%s                          \n     //    //                              \n    ^^    ^^                               \n", argv[1], argv[2]) ;







  f=open(argv[1],O_RDONLY) ;
  fstat(f,&st) ;
  map=mmap(((void*)0) ,
           st.st_size+sizeof(long) ,
           PROT_READ ,
           MAP_PRIVATE ,
           f ,
           0) ;
  printf("mmap %lx\n\n",(unsigned long)map);
  pid=fork() ;
  if(pid) {
    waitpid(pid,((void*)0),0) ;
    int u,i,o,c=0,l=strlen(argv[2]) ;
    for(i=0;i<10000/l;i++)
      for(o=0;o<l;o++)
        for(u=0;u<10000;u++)
          c+=ptrace(PTRACE_POKETEXT ,
                    pid ,
                    map+o ,
                    *((long*)(argv[2]+o))) ;
    printf("ptrace %d\n\n",c) ;
                                           }
  else {
    pthread_create(&pth ,
                   ((void*)0) ,
                   madviseThread ,
                   ((void*)0)) ;
    ptrace(PTRACE_TRACEME) ;
    kill(getpid(),SIGSTOP) ;
    pthread_join(pth,((void*)0)) ;
                                           }
  return 0 ;
                                           }
