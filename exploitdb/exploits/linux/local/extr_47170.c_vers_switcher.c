
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






typedef int val ;


 int PACKET_VERSION ;
 int SOL_PACKET ;
 int TPACKET_V1 ;
 int TPACKET_V3 ;
 scalar_t__ barrier ;
 int dprintf (char*,int,int,int) ;
 int setsockopt (int ,int ,int ,int*,int) ;
 int sfd ;
 int vers_switcher_done ;

void *vers_switcher(void *arg)
{
    int val,x,y;

    while (barrier) {}

    while (1) {
        val = TPACKET_V1;
        x = setsockopt(sfd, SOL_PACKET, PACKET_VERSION, &val, sizeof(val));

        y++;

        if (x != 0) break;

        val = TPACKET_V3;
        x = setsockopt(sfd, SOL_PACKET, PACKET_VERSION, &val, sizeof(val));

        if (x != 0) break;

        y++;
    }

    dprintf("[.] version switcher stopping, x = %d (y = %d, last val = %d)\n",x,y,val);
    vers_switcher_done = 1;

    return ((void*)0);
}
