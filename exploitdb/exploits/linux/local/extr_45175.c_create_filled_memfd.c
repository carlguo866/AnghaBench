
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






typedef int value ;
typedef int buffer ;


 int EXIT_FAILURE ;
 int MEMFD_CHUNK_SIZE ;
 int SYS_memfd_create ;
 int assert (int) ;
 int exit (int ) ;
 int perror (char*) ;
 int syscall (int ,char const*,int ) ;
 int write (int,char*,int) ;

__attribute__((used)) static int create_filled_memfd(const char *name, unsigned long size,
    unsigned long value) {
 int i;
 char buffer[MEMFD_CHUNK_SIZE];

 assert(size % MEMFD_CHUNK_SIZE == 0);

 int fd = syscall(SYS_memfd_create, name, 0);
 if (fd < 0) {
  perror("[-] memfd_create()");
  exit(EXIT_FAILURE);
 }

 for (i = 0; i < sizeof(buffer) / sizeof(value); i++)
  *(unsigned long *)&buffer[i * sizeof(value)] = value;

 for (i = 0; i < size / sizeof(buffer); i++) {
  int bytes_written = write(fd, &buffer[0], sizeof(buffer));
  if (bytes_written != sizeof(buffer)) {
   perror("[-] write(memfd)");
   exit(EXIT_FAILURE);
  }
 }

 return fd;
}
