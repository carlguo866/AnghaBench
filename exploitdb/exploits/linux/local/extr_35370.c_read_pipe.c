
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






typedef size_t ssize_t ;


 int close (int) ;
 int errno ;
 int gettid () ;
 int pipe (int*) ;
 int printf (char*,int,void*,int,int) ;
 int read (int,void*,size_t) ;
 int sleep (int) ;
 size_t write (int,void*,size_t) ;

ssize_t read_pipe(void *kbuf, void *ubuf, size_t count) {
 int pipefd[2];
 ssize_t len;

 pipe(pipefd);

 len = write(pipefd[1], kbuf, count);

 if (len != count) {
  printf("Thread %d failed in reading @ %p : %d %d\n", gettid(), kbuf, (int)len, errno);
  while(1) { sleep(10); }
 }

 read(pipefd[0], ubuf, count);

 close(pipefd[0]);
 close(pipefd[1]);

 return len;
}
